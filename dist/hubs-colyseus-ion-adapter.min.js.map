{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../colyseus/schema/lib/types/ArraySchema.js","webpack:///../colyseus/schema/lib/types/MapSchema.js","webpack:///./node_modules/ion-sdk-js/lib/index.js","webpack:///../colyseus/schema/lib/Schema.js","webpack:///./node_modules/protoo-client/lib/Logger.js","webpack:///./node_modules/loglevel/lib/loglevel.js","webpack:///../colyseus/colyseus.js/node_modules/@colyseus/http/dist/index.esm.js","webpack:///../colyseus/colyseus.js/lib/Room.js","webpack:///../colyseus/colyseus.js/lib/msgpack.js","webpack:///../colyseus/colyseus.js/lib/serializer/Serializer.js","webpack:///../colyseus/colyseus.js/lib/Protocol.js","webpack:///../colyseus/schema/lib/encoding/encode.js","webpack:///../colyseus/schema/lib/encoding/decode.js","webpack:///../colyseus/schema/lib/spec.js","webpack:///../colyseus/colyseus.js/lib/Auth.js","webpack:///../colyseus/schema/lib/index.js","webpack:///../colyseus/schema/lib/ChangeTree.js","webpack:///../colyseus/schema/lib/annotations.js","webpack:///./node_modules/events/events.js","webpack:///./node_modules/protoo-client/lib/EnhancedEventEmitter.js","webpack:///./node_modules/protoo-client/lib/Message.js","webpack:///./node_modules/ion-sdk-js/lib/stream.js","webpack:///./node_modules/ion-sdk-js/lib/transport.js","webpack:///./node_modules/sdp-transform/lib/grammar.js","webpack:///../colyseus/colyseus.js/lib/index.js","webpack:///./src/index.js","webpack:///../colyseus/colyseus.js/lib/legacy.js","webpack:///../colyseus/colyseus.js/lib/Client.js","webpack:///../colyseus/colyseus.js/lib/errors/ServerError.js","webpack:///../colyseus/colyseus.js/lib/msgpack/decode.js","webpack:///../colyseus/colyseus.js/lib/msgpack/encode.js","webpack:///../colyseus/colyseus.js/node_modules/strong-events/lib/index.js","webpack:///../colyseus/colyseus.js/node_modules/nanoevents/index.js","webpack:///../colyseus/colyseus.js/lib/Connection.js","webpack:///../colyseus/colyseus.js/node_modules/@gamestdio/websocket/lib/index.js","webpack:///../colyseus/colyseus.js/node_modules/@gamestdio/websocket/lib/backoff.js","webpack:///../colyseus/colyseus.js/lib/Storage.js","webpack:///../colyseus/colyseus.js/lib/Push.js","webpack:///../colyseus/colyseus.js/lib/serializer/FossilDeltaSerializer.js","webpack:///../colyseus/colyseus.js/node_modules/@gamestdio/state-listener/lib/index.js","webpack:///../colyseus/colyseus.js/node_modules/@gamestdio/state-listener/lib/StateContainer.js","webpack:///../colyseus/colyseus.js/node_modules/@gamestdio/state-listener/lib/compare.js","webpack:///../colyseus/colyseus.js/node_modules/fossil-delta/fossil-delta.js","webpack:///../colyseus/colyseus.js/lib/serializer/SchemaSerializer.js","webpack:///../colyseus/schema/lib/events/EventEmitter.js","webpack:///../colyseus/schema/lib/utils.js","webpack:///../colyseus/schema/lib/Reflection.js","webpack:///./node_modules/ion-sdk-js/lib/client.js","webpack:///./node_modules/protoo-client/lib/index.js","webpack:///./node_modules/protoo-client/lib/Peer.js","webpack:///./node_modules/debug/src/browser.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/debug/src/common.js","webpack:///./node_modules/ms/index.js","webpack:///./node_modules/protoo-client/lib/utils.js","webpack:///./node_modules/protoo-client/lib/transports/WebSocketTransport.js","webpack:///./node_modules/websocket/lib/browser.js","webpack:///./node_modules/es5-ext/global.js","webpack:///./node_modules/websocket/lib/version.js","webpack:///./node_modules/retry/index.js","webpack:///./node_modules/retry/lib/retry.js","webpack:///./node_modules/retry/lib/retry_operation.js","webpack:///./node_modules/sdp-transform/lib/index.js","webpack:///./node_modules/sdp-transform/lib/parser.js","webpack:///./node_modules/sdp-transform/lib/writer.js","webpack:///./node_modules/uuid/dist/esm-browser/rng.js","webpack:///./node_modules/uuid/dist/esm-browser/bytesToUuid.js","webpack:///./node_modules/uuid/dist/esm-browser/v1.js","webpack:///./node_modules/uuid/dist/esm-browser/v35.js","webpack:///./node_modules/uuid/dist/esm-browser/md5.js","webpack:///./node_modules/uuid/dist/esm-browser/v3.js","webpack:///./node_modules/uuid/dist/esm-browser/v4.js","webpack:///./node_modules/uuid/dist/esm-browser/sha1.js","webpack:///./node_modules/uuid/dist/esm-browser/v5.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","extendStatics","__extends","this","b","setPrototypeOf","__proto__","Array","__","constructor","__spreadArrays","il","arguments","length","k","a","j","jl","ArraySchema","_super","items","_i","_this","apply","defineProperties","$sorting","undefined","writable","$changes","onAdd","onRemove","onChange","triggerAll","toJSON","arr","objAt","push","clone","isDecoding","cloned","of","map","item","species","configurable","sort","compareFn","changes_1","from","changes","previousIndex","getIndex","mapIndexChange","mapIndex","filter","callbackfn","thisArg","filtered","splice","start","deleteCount","insert","removedItems","movedItems","idx","removedItem","parent","deleteIndex","forEach","movedItem","parentField","MapSchema","obj","assign","cloned_1","_indexes","Map","_updateIndexes","allKeys","index","indexes","allKeys_1","set","Stream","LocalStream","Client","client_1","default","stream_1","Schema","spec_1","encode","decode","ArraySchema_1","MapSchema_1","ChangeTree_1","EventEmitter_1","EncodeSchemaError","Error","assertInstanceType","type","klass","field","encodePrimitiveType","bytes","typeofTarget","allowNull","isNaN","console","log","foundValue","JSON","stringify","assertType","encodeFunc","decodePrimitiveType","it","args","ChangeTree","$listeners","descriptors","_descriptors","onError","e","error","_schema","_fieldsByIndex","_filters","_deprecated","changed","listen","attr","callback","EventEmitter","register","remove","offset","schema","fieldsByIndex","totalBytes","TYPE_ID","_loop_1","isNil","nilCheck","END_OF_STRUCTURE","_field","previousValue","this_1","hasChange","createTypeInstance","isArray","valueRef_1","newLength_1","number","numChanges","Math","min","hasRemoval","hasIndexChange","itemRemoved","newIndex","indexChangedFrom","indexChangeCheck","uint8","isNew","valueRef","previousKeys","keys","isNilItem","previousKey","hasMapIndex","numberCheck","isSchemaType","newKey","string","_triggerChanges","root","encodeAll","client","_encodeEndOfStructure","filters","allChanges","_loop_2","this_2","fieldIndex","NIL","tryEncodeTypeId","arrayChanges","isChildSchema","indexChange","getIndexChange","INDEX_CHANGE","discard","i_1","mapItemIndex","isDeleted","encodeFiltered","encodeAllFiltered","deprecated","discardAllChanges","index_1","mapKeys","instance","targetType","_typeid","_context","change","listener","invoke","debug","APP_NAME","prefix","_debug","_warn","_error","info","warn","definition","noop","isIE","window","navigator","test","userAgent","logMethods","bindMethod","methodName","method","Function","traceForIE","trace","realMethod","replaceLoggingMethods","level","loggerName","methodFactory","enableLoggingWhenConsoleArrives","defaultMethodFactory","Logger","defaultLevel","factory","currentLevel","self","storageKey","getPersistedLevel","storedLevel","localStorage","ignore","cookie","document","location","indexOf","encodeURIComponent","exec","slice","levels","getLevel","setLevel","persist","toUpperCase","SILENT","levelNum","levelName","persistLevelIfPossible","setDefaultLevel","enableAll","TRACE","disableAll","initialLevel","defaultLogger","_loggersByName","getLogger","TypeError","logger","_log","noConflict","getLoggers","src","tar","headers","statusMessage","statusText","statusCode","status","data","response","send","uri","opts","Promise","res","rej","str","tmp","req","XMLHttpRequest","timeout","ontimeout","onerror","err","open","href","onload","getAllResponseHeaders","trim","split","shift","toLowerCase","join","parse","reviver","body","withCredentials","setRequestHeader","post","patch","del","put","__createBinding","k2","__setModuleDefault","v","__importStar","mod","result","Room","msgpack","strong_events_1","nanoevents_1","Connection_1","Serializer_1","Protocol_1","rootSchema","onJoin","createSignal","onStateChange","onLeave","hasJoined","onMessageHandlers","createNanoEvents","id","serializer","getSerializer","state","code","message","removeAllListeners","connect","endpoint","connection","Connection","reconnectEnabled","onmessage","onMessageCallback","onclose","reason","leave","consented","Protocol","LEAVE_ROOM","close","onMessage","on","getMessageHandlerKey","initialBytes","ROOM_DATA","encoded","Uint8Array","byteLength","buffer","getState","segments","immediate","serializerId","api","removeListener","teardown","clear","event","JOIN_ROOM","utf8Read","utf8Length","handshake","ERROR","it_1","code_1","ROOM_DATA_SCHEMA","dispatchMessage","ROOM_STATE","setState","ROOM_STATE_PATCH","it_2","stringCheck","encodedState","binaryPatch","messageType","events","emit","__importDefault","decode_1","encode_1","registerSerializer","serializers","ErrorCode","view","chr","end","byte","toString","String","fromCharCode","charCodeAt","utf8Write","int8","int16","uint16","int32","uint32","b4","b3","b2","b1","int64","high","floor","pow","uint64","boolean","writeFloat64","writeFloat32","float64","float32","_int32","Int32Array","_float32","Float32Array","_float64","Float64Array","size","isFinite","Number","MAX_SAFE_INTEGER","arrayCheck","readFloat64","readFloat32","low","__awaiter","_arguments","P","generator","resolve","reject","fulfilled","step","next","rejected","done","then","__generator","f","y","g","_","label","sent","trys","ops","verb","iterator","op","pop","Auth","Platform","http","Storage_1","_id","username","displayName","avatarUrl","isAnonymous","email","lang","timezone","metadata","devices","facebookId","twitterId","googleId","gameCenterId","steamId","friendIds","blockedUserIds","createdAt","updatedAt","token","replace","getItem","login","options","queryParams","_a","hasToken","request","setItem","registerPingService","save","getFriends","getOnlineFriends","getFriendRequests","sendFriendRequest","friendId","userId","acceptFriendRequest","declineFriendRequest","blockUser","unblockUser","query","name_1","queryString","logout","removeItem","unregisterPingService","keepOnlineInterval","setInterval","clearInterval","Schema_1","utils_1","dumpChanges","Reflection_1","Reflection","ReflectionType","ReflectionField","annotations_1","defineTypes","Context","Set","deletedKeys","fieldIndexes","fieldName","isDelete","add","delete","indexMap","has","deleteIndexChange","changeAll","keys_1","globalContext","types","schemas","typeid","context","target","isMap","isSchema","fieldCached","Proxy","prop","setValue","deleteProperty","deletedValue","cb","throws","fields","ReflectOwnKeys","R","Reflect","ReflectApply","receiver","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","init","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","_getMaxListeners","that","_addListener","prepend","existing","warning","newListener","unshift","warned","w","emitter","count","onceWrapper","fired","wrapFn","_onceWrap","wrapped","_listeners","unwrap","evlistener","ret","unwrapListeners","arrayClone","listenerCount","copy","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","er","handler","len","listeners","addListener","prependListener","once","prependOnceListener","list","position","originalListener","spliceOne","off","rawListeners","eventNames","super","Infinity","_logger","safeEmit","generateRandomNumber","raw","ok","errorCode","errorReason","notification","RemoteStream","VideoResolutions","transport_1","qvga","width","ideal","height","vga","shd","hd","fhd","MediaStream","dispatch","stream","codec","resolution","audio","video","mediaDevices","getUserMedia","getDisplayMedia","kind","deviceId","track","getVideoConstraints","getTracks","prev","getAudioTracks","getVideoTracks","addTrack","removeTrack","stop","transport","getSenders","sender","_b","replaceTrack","enabled","rid","bandwidth","sendOffer","offer","createOffer","offerToReceiveVideo","offerToReceiveAudio","setLocalDescription","onicecandidate","jsep","localDescription","mid","setRemoteDescription","onnegotiationneeded","tracks","allTracks","values","flat","includes","addTransceiver","desc","ontrack","streams","onunmute","remote","sdp_transform_1","PayloadType","WebRTCTransport","config","pc","RTCPeerConnection","rtp","payload","H264","rate","VP8","VP9","direction","session","sdp","videoIdx","media","findIndex","ssrcGroups","payloads","fmtp","rtcpFB","subtype","rtcpFb","ssrcs","ssrc","parseInt","write","iceServers","urls","grammar","reg","names","format","u","z","address","sessionConfig","raddr","tcptype","generation","attribute","maxMessageSize","RegExp","dir2","clksrcExt","mediaClockValue","rateNumerator","rateDenominator","SchemaSerializer","FossilDeltaSerializer","Client_1","Room_1","Auth_1","FossilDeltaSerializer_1","SchemaSerializer_1","IonState","ColyseusIonAdapter","app","roomName","room","roomData","userData","players","pendingStreamRequests","timeOffsets","serverTimeRequests","avgTimeOffset","blockedClients","frozenUpdates","createRoom","useIon","startLocalStream","mediaOptions","selectedAudioDevice","selectedVideoDevice","setServerUrl","serverUrls","colyseusUrl","ionUrl","setApp","appName","setRoom","roomId","setOptions","setWebRtcOptions","setServerConnectListeners","successListener","failureListener","connectSuccess","connectFailure","setRoomOccupantListener","occupantListener","setDataChannelListeners","openListener","closedListener","messageListener","protocol","host","NAF","colyseusConnection","colyseus","ColyseusClient","joinRoom","catch","url","loglevel","ion","IonClient","onIonOpen","onIonClosed","all","updateTimeOffset","joinOrCreate","onJoinError","onRoomData","onUserData","onNaf","onChat","onInitialState","sessionId","onAddPlayer","onRemovePlayer","ionState","joinIon","dispatchEvent","CustomEvent","detail","scene","scene_id","getAvatar","avatarId","avatars","entries","getAvatarSrc","avatar","gltfs","getScene","sceneId","scenes","checkSameScene","presence","updateScene","model_url","objects_url","canEnterRoom","hub","reduce","acc","entering","room_size","onData","frozen","storeMessage","sendChatMsg","player","onChangeProfile","onChangePresence","profile","APP","store","update","prevProfile","previous","prevPresence","sid","signIn","sendEntering","sendEnteringCancelled","sendEntered","sendObjectSpawned","pin","networkId","gltfNode","fileId","fileAccessToken","promotionToken","unpin","onPeerJoin","onPeerLeave","onStreamAdd","onStreamRemove","onBroadcast","localStream","publish","uid","subscribe","setMediaStream","unsubscribe","shouldStartConnectionTo","getConnectStatus","adapters","IS_CONNECTED","NOT_CONNECTED","sendData","to","sendDataGuaranteed","broadcastData","broadcastDataGuaranteed","getMediaStream","audioPromise","videoPromise","promise","audioStream","videoStream","setLocalMediaStream","unpublish","enableMicrophone","unmute","mute","toggleFreeze","unfreeze","freeze","flushPendingUpdates","getPendingData","dataType","source","dataForUpdateMultiMessage","owner","storeSingleMessage","storedMessage","storedData","isOutdatedMessage","lastOwnerTime","isContemporaneousMessage","isFirstSync","components","block","whom","clientId","unblock","disconnect","isDisconnected","setReconnectionListeners","reconnectingListener","reconnectedListener","reconnectionErrorListener","onReconnecting","onReconnected","onReconnectionError","clientSentTime","Date","now","fetch","cache","serverReceivedTime","getTime","precision","clientReceivedTime","timeOffset","setTimeout","getServerTime","ArrayBuffer","isView","MatchMakeError","http_1","ServerError_1","Push_1","hostname","port","auth","Push","createMatchMakeRequest","joinById","reconnect","getAvailableRooms","consumeSeatReservation","buildEndpoint","ServerError","params","processId","Decoder","_offset","_buffer","_view","DataView","byteOffset","_array","_parse","_map","_str","getUint8","_bin","hi","lo","getUint16","getUint32","getInt8","getFloat32","getFloat64","getInt16","getInt32","decoder","setUint8","defers","_encode","_length","_float","time","buf","deferIndex","deferWritten","nextOffset","defer","deferLength","bin","setFloat64","handlers","invokeAsync","websocket_1","autoConnect","_enqueuedCalls","onOpenCallback","binaryType","ws","readyState","OPEN","_createClass","props","descriptor","Constructor","protoProps","staticProps","_classCallCheck","createBackoff","WebSocketImpl","WebSocket","WebSocketClient","protocols","backoff","onReady","onBackoffReady","isReconnect","onCloseCallback","onErrorCallback","onopen","delay","bufferedAmount","extensions","CONNECTING","CLOSING","CLOSED","Backoff","exponential","attempt","random","fibonacci","current","func","attempts","initialDelay","storage","getStorage","cc","sys","check","registerServiceWorker","requestNotificationPermission","serviceWorker","requestPermission","state_listener_1","fossilDelta","StateContainer","previousState","StateContainer_1","compare_1","matcherPlaceholders","reset","newState","patches","compare","checkPatches","defaultListener","registerPlaceholder","placeholder","matcher","rules","rawRules","segment","pathVariables","getPathVariables","path","rawPath","operation","matched","matches","match","substr","newArr","objectKeys","tree1","tree2","generate","mirror","newKeys","oldKeys","deleted","oldVal","newVal","addPath","RollingHash","pos","x","old","zDigits","zValue","Reader","array","Writer","digitCount","checksum","sum0","sum1","sum2","sum3","N","haveBytes","getByte","getChar","getInt","toArray","putByte","putChar","putInt","zBuf","putArray","out","zDelta","lenOut","lenSrc","lastRead","nHash","ceil","collide","landmark","hv","h","iSrc","iBlock","bestCnt","bestOfst","bestLitsz","base","limit","cnt","ofst","litsz","outputSize","delta","total","lenDelta","zOut","verifyChecksum","schema_1","rawState","_1","dump","__decorate","decorators","getOwnPropertyDescriptor","decorate","reflectionContext","rootSchemaType","reflection","rootType","buildType","currentType","fieldType","childTypeSchema","referencedType","type_1","schemaTypes","reflectionType","schemaType","refType","rootInstance","events_1","protoo_client_1","uuid_1","onRequest","onNotification","trackMap","strMap","objToStrMap","knownStreams","v4","URL","searchParams","append","WebSocketTransport","WARN","Peer","rtc","setRTCConfiguration","setDispatch","local","getRemoteMedia","version","EnhancedEventEmitter","Message","_closed","_transport","_connected","_data","_sents","_handleTransport","createRequest","pResolve","pReject","data2","clearTimeout","timer","createNotification","closed","currentAttempt","_handleRequest","_handleResponse","_handleNotification","createSuccessResponse","createErrorResponse","formatArgs","useColors","namespace","humanize","diff","color","lastC","namespaces","load","process","env","DEBUG","__nwjs","documentElement","style","WebkitAppearance","firebug","exception","table","$1","localstorage","colors","formatters","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","run","marker","runClearTimeout","Item","nextTick","title","browser","argv","versions","binding","cwd","chdir","dir","umask","selectColor","hash","createDebug","abs","prevTime","curr","ms","coerce","formatter","val","destroy","extend","instances","delimiter","newDebug","toNamespace","regexp","substring","stack","disable","skips","enable","plural","msAbs","isPlural","round","parseFloat","long","fmtLong","fmtShort","W3CWebSocket","w3cwebsocket","retry","DEFAULT_RETRY_OPTIONS","retries","factor","minTimeout","maxTimeout","_url","_options","_ws","_runWebSocket","wasConnected","origin","requestOptions","clientConfig","wasClean","_globalThis","NativeWebSocket","MozWebSocket","websocket_version","naiveFallback","globalThis","__global__","RetryOperation","timeouts","forever","unref","maxRetryTime","randomize","createTimeout","wrap","methods","original","mainError","_originalTimeouts","_timeouts","_maxRetryTime","_fn","_errors","_attempts","_operationTimeout","_operationTimeoutCb","_timeout","_operationStart","_cachedTimeouts","currentTime","fn","timeoutOps","try","errors","counts","mainErrorCount","parser","writer","parseParams","parseFmtpConfig","parsePayloads","parseRemoteCandidates","parseImageAttributes","parseSimulcastStreamList","toIntIfInt","parseReg","content","needsBlank","keyLocation","rawName","attachProperties","validLine","paramReducer","expr","candidates","parts","component","ip","scid","paused","formatRegExp","formatStr","makeLine","defaultOuterOrder","defaultInnerOrder","mLine","outerOrder","innerOrder","el","getRandomValues","crypto","msCrypto","rnds8","rng","byteToHex","_nodeId","_clockseq","offset_","_lastMSecs","_lastNSecs","node","clockseq","seedBytes","msecs","nsecs","dt","tl","tmh","generateUUID","unescape","stringToBytes","uuid","hex","uuidToBytes","hashfunc","DNS","getOutputLength","inputLength8","safeAdd","lsw","md5cmn","q","num","md5ff","md5gg","md5hh","md5ii","v35","msg","input","output","length32","charAt","md5ToHexEncodedArray","olda","oldb","oldc","oldd","wordsToMd5","length8","Uint32Array","bytesToWords","rnds","ROTL","K","H","M","_i2","W","_t","_t2","T"],"mappings":"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","file":"hubs-colyseus-ion-adapter.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ArraySchema = void 0;\nvar ArraySchema = /** @class */ (function (_super) {\n    __extends(ArraySchema, _super);\n    function ArraySchema() {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n        var _this = _super.apply(this, items) || this;\n        Object.setPrototypeOf(_this, Object.create(ArraySchema.prototype));\n        Object.defineProperties(_this, {\n            $sorting: { value: undefined, enumerable: false, writable: true },\n            $changes: { value: undefined, enumerable: false, writable: true },\n            onAdd: { value: undefined, enumerable: false, writable: true },\n            onRemove: { value: undefined, enumerable: false, writable: true },\n            onChange: { value: undefined, enumerable: false, writable: true },\n            triggerAll: {\n                value: function () {\n                    if (!_this.onAdd) {\n                        return;\n                    }\n                    for (var i = 0; i < _this.length; i++) {\n                        _this.onAdd(_this[i], i);\n                    }\n                }\n            },\n            toJSON: {\n                value: function () {\n                    var arr = [];\n                    for (var i = 0; i < _this.length; i++) {\n                        var objAt = _this[i];\n                        arr.push((typeof (objAt.toJSON) === \"function\")\n                            ? objAt.toJSON()\n                            : objAt);\n                    }\n                    return arr;\n                }\n            },\n            clone: {\n                value: function (isDecoding) {\n                    var cloned;\n                    if (isDecoding) {\n                        cloned = ArraySchema.of.apply(ArraySchema, _this);\n                        cloned.onAdd = _this.onAdd;\n                        cloned.onRemove = _this.onRemove;\n                        cloned.onChange = _this.onChange;\n                    }\n                    else {\n                        cloned = new (ArraySchema.bind.apply(ArraySchema, __spreadArrays([void 0], _this.map(function (item) {\n                            if (typeof (item) === \"object\") {\n                                return item.clone();\n                            }\n                            else {\n                                return item;\n                            }\n                        }))))();\n                    }\n                    return cloned;\n                }\n            }\n        });\n        return _this;\n    }\n    Object.defineProperty(ArraySchema, Symbol.species, {\n        get: function () { return ArraySchema; },\n        enumerable: false,\n        configurable: true\n    });\n    ArraySchema.prototype.sort = function (compareFn) {\n        this.$sorting = true;\n        _super.prototype.sort.call(this, compareFn);\n        if (this.$changes) { // allow to .slice() + .sort()\n            var changes = Array.from(this.$changes.changes);\n            for (var _i = 0, changes_1 = changes; _i < changes_1.length; _i++) {\n                var key = changes_1[_i];\n                // track index change\n                var previousIndex = this.$changes.getIndex(this[key]);\n                if (previousIndex !== undefined) {\n                    this.$changes.mapIndexChange(this[key], previousIndex);\n                }\n                this.$changes.mapIndex(this[key], key);\n            }\n        }\n        this.$sorting = false;\n        return this;\n    };\n    ArraySchema.prototype.filter = function (callbackfn, thisArg) {\n        var filtered = _super.prototype.filter.call(this, callbackfn);\n        filtered.$changes = this.$changes.clone();\n        return filtered;\n    };\n    ArraySchema.prototype.splice = function (start, deleteCount) {\n        var insert = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            insert[_i - 2] = arguments[_i];\n        }\n        var removedItems = Array.prototype.splice.apply(this, arguments);\n        var movedItems = Array.prototype.filter.call(this, function (item, idx) {\n            return idx >= start + deleteCount - 1;\n        });\n        removedItems.map(function (removedItem) {\n            var $changes = removedItem && removedItem.$changes;\n            // If the removed item is a schema we need to update it.\n            if ($changes) {\n                $changes.parent.deleteIndex(removedItem);\n                delete $changes.parent;\n            }\n        });\n        movedItems.forEach(function (movedItem) {\n            // If the moved item is a schema we need to update it.\n            var $changes = movedItem && movedItem.$changes;\n            if ($changes) {\n                // Update current index in parent, so subsequent changes in\n                // this item's properties are correctly reflected.\n                $changes.parentField--;\n            }\n        });\n        return removedItems;\n    };\n    return ArraySchema;\n}(Array));\nexports.ArraySchema = ArraySchema;\n//# sourceMappingURL=ArraySchema.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MapSchema = void 0;\nvar MapSchema = /** @class */ (function () {\n    function MapSchema(obj) {\n        var _this = this;\n        if (obj === void 0) { obj = {}; }\n        for (var key in obj) {\n            this[key] = obj[key];\n        }\n        Object.defineProperties(this, {\n            $changes: { value: undefined, enumerable: false, writable: true },\n            onAdd: { value: undefined, enumerable: false, writable: true },\n            onRemove: { value: undefined, enumerable: false, writable: true },\n            onChange: { value: undefined, enumerable: false, writable: true },\n            clone: {\n                value: function (isDecoding) {\n                    var cloned;\n                    if (isDecoding) {\n                        // client-side\n                        cloned = Object.assign(new MapSchema(), _this);\n                        cloned.onAdd = _this.onAdd;\n                        cloned.onRemove = _this.onRemove;\n                        cloned.onChange = _this.onChange;\n                    }\n                    else {\n                        // server-side\n                        var cloned_1 = new MapSchema();\n                        for (var key in _this) {\n                            if (typeof (_this[key]) === \"object\") {\n                                cloned_1[key] = _this[key].clone();\n                            }\n                            else {\n                                cloned_1[key] = _this[key];\n                            }\n                        }\n                    }\n                    return cloned;\n                }\n            },\n            triggerAll: {\n                value: function () {\n                    if (!_this.onAdd) {\n                        return;\n                    }\n                    for (var key in _this) {\n                        _this.onAdd(_this[key], key);\n                    }\n                }\n            },\n            toJSON: {\n                value: function () {\n                    var map = {};\n                    for (var key in _this) {\n                        map[key] = (typeof (_this[key].toJSON) === \"function\")\n                            ? _this[key].toJSON()\n                            : _this[key];\n                    }\n                    return map;\n                }\n            },\n            _indexes: { value: new Map(), enumerable: false, writable: true },\n            _updateIndexes: {\n                value: function (allKeys) {\n                    var index = 0;\n                    var indexes = new Map();\n                    for (var _i = 0, allKeys_1 = allKeys; _i < allKeys_1.length; _i++) {\n                        var key = allKeys_1[_i];\n                        indexes.set(key, index++);\n                    }\n                    _this._indexes = indexes;\n                }\n            },\n        });\n    }\n    return MapSchema;\n}());\nexports.MapSchema = MapSchema;\n//# sourceMappingURL=MapSchema.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Stream = exports.LocalStream = exports.Client = void 0;\nconst client_1 = require(\"./client\");\nexports.Client = client_1.default;\nconst stream_1 = require(\"./stream\");\nObject.defineProperty(exports, \"LocalStream\", { enumerable: true, get: function () { return stream_1.LocalStream; } });\nObject.defineProperty(exports, \"Stream\", { enumerable: true, get: function () { return stream_1.Stream; } });\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Schema = void 0;\nvar spec_1 = require(\"./spec\");\nvar encode = require(\"./encoding/encode\");\nvar decode = require(\"./encoding/decode\");\nvar ArraySchema_1 = require(\"./types/ArraySchema\");\nvar MapSchema_1 = require(\"./types/MapSchema\");\nvar ChangeTree_1 = require(\"./ChangeTree\");\nvar EventEmitter_1 = require(\"./events/EventEmitter\");\nvar EncodeSchemaError = /** @class */ (function (_super) {\n    __extends(EncodeSchemaError, _super);\n    function EncodeSchemaError() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return EncodeSchemaError;\n}(Error));\nfunction assertType(value, type, klass, field) {\n    var typeofTarget;\n    var allowNull = false;\n    switch (type) {\n        case \"number\":\n        case \"int8\":\n        case \"uint8\":\n        case \"int16\":\n        case \"uint16\":\n        case \"int32\":\n        case \"uint32\":\n        case \"int64\":\n        case \"uint64\":\n        case \"float32\":\n        case \"float64\":\n            typeofTarget = \"number\";\n            if (isNaN(value)) {\n                console.log(\"trying to encode \\\"NaN\\\" in \" + klass.constructor.name + \"#\" + field);\n            }\n            break;\n        case \"string\":\n            typeofTarget = \"string\";\n            allowNull = true;\n            break;\n        case \"boolean\":\n            // boolean is always encoded as true/false based on truthiness\n            return;\n    }\n    if (typeof (value) !== typeofTarget && (!allowNull || (allowNull && value !== null))) {\n        var foundValue = \"'\" + JSON.stringify(value) + \"'\" + (value && value.constructor && \" (\" + value.constructor.name + \")\");\n        throw new EncodeSchemaError(\"a '\" + typeofTarget + \"' was expected, but \" + foundValue + \" was provided in \" + klass.constructor.name + \"#\" + field);\n    }\n}\nfunction assertInstanceType(value, type, klass, field) {\n    if (!(value instanceof type)) {\n        throw new EncodeSchemaError(\"a '\" + type.name + \"' was expected, but '\" + value.constructor.name + \"' was provided in \" + klass.constructor.name + \"#\" + field);\n    }\n}\nfunction encodePrimitiveType(type, bytes, value, klass, field) {\n    assertType(value, type, klass, field);\n    var encodeFunc = encode[type];\n    if (encodeFunc) {\n        encodeFunc(bytes, value);\n    }\n    else {\n        throw new EncodeSchemaError(\"a '\" + type + \"' was expected, but \" + value + \" was provided in \" + klass.constructor.name + \"#\" + field);\n    }\n}\nfunction decodePrimitiveType(type, bytes, it) {\n    return decode[type](bytes, it);\n}\n/**\n * Schema encoder / decoder\n */\nvar Schema = /** @class */ (function () {\n    // allow inherited classes to have a constructor\n    function Schema() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        // fix enumerability of fields for end-user\n        Object.defineProperties(this, {\n            $changes: {\n                value: new ChangeTree_1.ChangeTree(this._indexes),\n                enumerable: false,\n                writable: true\n            },\n            $listeners: {\n                value: {},\n                enumerable: false,\n                writable: true\n            },\n        });\n        var descriptors = this._descriptors;\n        if (descriptors) {\n            Object.defineProperties(this, descriptors);\n        }\n    }\n    Schema.onError = function (e) {\n        console.error(e);\n    };\n    Object.defineProperty(Schema.prototype, \"_schema\", {\n        get: function () { return this.constructor._schema; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Schema.prototype, \"_descriptors\", {\n        get: function () { return this.constructor._descriptors; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Schema.prototype, \"_indexes\", {\n        get: function () { return this.constructor._indexes; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Schema.prototype, \"_fieldsByIndex\", {\n        get: function () { return this.constructor._fieldsByIndex; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Schema.prototype, \"_filters\", {\n        get: function () { return this.constructor._filters; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Schema.prototype, \"_deprecated\", {\n        get: function () { return this.constructor._deprecated; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Schema.prototype, \"$changed\", {\n        get: function () { return this.$changes.changed; },\n        enumerable: false,\n        configurable: true\n    });\n    Schema.prototype.listen = function (attr, callback) {\n        var _this = this;\n        if (!this.$listeners[attr]) {\n            this.$listeners[attr] = new EventEmitter_1.EventEmitter();\n        }\n        this.$listeners[attr].register(callback);\n        // return un-register callback.\n        return function () {\n            return _this.$listeners[attr].remove(callback);\n        };\n    };\n    Schema.prototype.decode = function (bytes, it) {\n        if (it === void 0) { it = { offset: 0 }; }\n        var changes = [];\n        var schema = this._schema;\n        var fieldsByIndex = this._fieldsByIndex;\n        var totalBytes = bytes.length;\n        // skip TYPE_ID of existing instances\n        if (bytes[it.offset] === spec_1.TYPE_ID) {\n            it.offset += 2;\n        }\n        var _loop_1 = function () {\n            var isNil = decode.nilCheck(bytes, it) && ++it.offset;\n            var index = bytes[it.offset++];\n            if (index === spec_1.END_OF_STRUCTURE) {\n                return \"break\";\n            }\n            var field = fieldsByIndex[index];\n            var _field = \"_\" + field;\n            var type = schema[field];\n            var value = void 0;\n            var previousValue = this_1[_field];\n            var hasChange = false;\n            if (!field) {\n                return \"continue\";\n            }\n            else if (isNil) {\n                value = null;\n                hasChange = true;\n            }\n            else if (type._schema) {\n                previousValue = previousValue && this_1[_field].clone();\n                value = this_1[_field] || this_1.createTypeInstance(bytes, it, type);\n                value.decode(bytes, it);\n                hasChange = true;\n            }\n            else if (Array.isArray(type)) {\n                type = type[0];\n                var valueRef_1 = this_1[_field] || new ArraySchema_1.ArraySchema();\n                value = valueRef_1.clone(true);\n                var newLength_1 = decode.number(bytes, it);\n                var numChanges = Math.min(decode.number(bytes, it), newLength_1);\n                var hasRemoval = (value.length > newLength_1);\n                hasChange = (numChanges > 0) || hasRemoval;\n                // FIXME: this may not be reliable. possibly need to encode this variable during serialization\n                var hasIndexChange = false;\n                // ensure current array has the same length as encoded one\n                if (hasRemoval) {\n                    // decrease removed items from number of changes.\n                    // no need to iterate through them, as they're going to be removed.\n                    Array.prototype.splice.call(value, newLength_1).forEach(function (itemRemoved, i) {\n                        if (itemRemoved && itemRemoved.onRemove) {\n                            try {\n                                itemRemoved.onRemove();\n                            }\n                            catch (e) {\n                                Schema.onError(e);\n                            }\n                        }\n                        if (valueRef_1.onRemove) {\n                            try {\n                                valueRef_1.onRemove(itemRemoved, newLength_1 + i);\n                            }\n                            catch (e) {\n                                Schema.onError(e);\n                            }\n                        }\n                    });\n                }\n                for (var i = 0; i < numChanges; i++) {\n                    var newIndex = decode.number(bytes, it);\n                    var indexChangedFrom = void 0; // index change check\n                    if (decode.indexChangeCheck(bytes, it)) {\n                        decode.uint8(bytes, it);\n                        indexChangedFrom = decode.number(bytes, it);\n                        hasIndexChange = true;\n                    }\n                    var isNew = (!hasIndexChange && value[newIndex] === undefined) || (hasIndexChange && indexChangedFrom === undefined);\n                    if (type.prototype instanceof Schema) {\n                        var item = void 0;\n                        if (isNew) {\n                            item = this_1.createTypeInstance(bytes, it, type);\n                        }\n                        else if (indexChangedFrom !== undefined) {\n                            item = valueRef_1[indexChangedFrom];\n                        }\n                        else {\n                            item = valueRef_1[newIndex];\n                        }\n                        if (!item) {\n                            item = this_1.createTypeInstance(bytes, it, type);\n                            isNew = true;\n                        }\n                        item.decode(bytes, it);\n                        value[newIndex] = item;\n                    }\n                    else {\n                        value[newIndex] = decodePrimitiveType(type, bytes, it);\n                    }\n                    if (isNew) {\n                        if (valueRef_1.onAdd) {\n                            try {\n                                valueRef_1.onAdd(value[newIndex], newIndex);\n                            }\n                            catch (e) {\n                                Schema.onError(e);\n                            }\n                        }\n                    }\n                    else if (valueRef_1.onChange) {\n                        try {\n                            valueRef_1.onChange(value[newIndex], newIndex);\n                        }\n                        catch (e) {\n                            Schema.onError(e);\n                        }\n                    }\n                }\n            }\n            else if (type.map) {\n                type = type.map;\n                var valueRef = this_1[_field] || new MapSchema_1.MapSchema();\n                value = valueRef.clone(true);\n                var length = decode.number(bytes, it);\n                hasChange = (length > 0);\n                // FIXME: this may not be reliable. possibly need to encode this variable during\n                // serializagion\n                var hasIndexChange = false;\n                var previousKeys = Object.keys(valueRef);\n                for (var i = 0; i < length; i++) {\n                    // `encodeAll` may indicate a higher number of indexes it actually encodes\n                    // TODO: do not encode a higher number than actual encoded entries\n                    if (bytes[it.offset] === undefined ||\n                        bytes[it.offset] === spec_1.END_OF_STRUCTURE) {\n                        break;\n                    }\n                    var isNilItem = decode.nilCheck(bytes, it) && ++it.offset;\n                    // index change check\n                    var previousKey = void 0;\n                    if (decode.indexChangeCheck(bytes, it)) {\n                        decode.uint8(bytes, it);\n                        previousKey = previousKeys[decode.number(bytes, it)];\n                        hasIndexChange = true;\n                    }\n                    var hasMapIndex = decode.numberCheck(bytes, it);\n                    var isSchemaType = typeof (type) !== \"string\";\n                    var newKey = (hasMapIndex)\n                        ? previousKeys[decode.number(bytes, it)]\n                        : decode.string(bytes, it);\n                    var item = void 0;\n                    var isNew = (!hasIndexChange && valueRef[newKey] === undefined) || (hasIndexChange && previousKey === undefined && hasMapIndex);\n                    if (isNew && isSchemaType) {\n                        item = this_1.createTypeInstance(bytes, it, type);\n                    }\n                    else if (previousKey !== undefined) {\n                        item = valueRef[previousKey];\n                    }\n                    else {\n                        item = valueRef[newKey];\n                    }\n                    if (isNilItem) {\n                        if (item && item.onRemove) {\n                            try {\n                                item.onRemove();\n                            }\n                            catch (e) {\n                                Schema.onError(e);\n                            }\n                        }\n                        if (valueRef.onRemove) {\n                            try {\n                                valueRef.onRemove(item, newKey);\n                            }\n                            catch (e) {\n                                Schema.onError(e);\n                            }\n                        }\n                        delete value[newKey];\n                        continue;\n                    }\n                    else if (!isSchemaType) {\n                        value[newKey] = decodePrimitiveType(type, bytes, it);\n                    }\n                    else {\n                        item.decode(bytes, it);\n                        value[newKey] = item;\n                    }\n                    if (isNew) {\n                        if (valueRef.onAdd) {\n                            try {\n                                valueRef.onAdd(value[newKey], newKey);\n                            }\n                            catch (e) {\n                                Schema.onError(e);\n                            }\n                        }\n                    }\n                    else if (valueRef.onChange) {\n                        try {\n                            valueRef.onChange(value[newKey], newKey);\n                        }\n                        catch (e) {\n                            Schema.onError(e);\n                        }\n                    }\n                }\n            }\n            else {\n                value = decodePrimitiveType(type, bytes, it);\n                // FIXME: should not even have encoded if value haven't changed in the first place!\n                // check FilterTest.ts: \"should not trigger `onChange` if field haven't changed\"\n                hasChange = (value !== this_1[_field]);\n            }\n            if (hasChange && (this_1.onChange || this_1.$listeners[field])) {\n                changes.push({\n                    field: field,\n                    value: value,\n                    previousValue: previousValue\n                });\n            }\n            this_1[_field] = value;\n        };\n        var this_1 = this;\n        while (it.offset < totalBytes) {\n            var state_1 = _loop_1();\n            if (state_1 === \"break\")\n                break;\n        }\n        this._triggerChanges(changes);\n        return this;\n    };\n    Schema.prototype.encode = function (root, encodeAll, client, bytes) {\n        var _this = this;\n        if (root === void 0) { root = this; }\n        if (encodeAll === void 0) { encodeAll = false; }\n        if (bytes === void 0) { bytes = []; }\n        // skip if nothing has changed\n        if (!this.$changes.changed && !encodeAll) {\n            this._encodeEndOfStructure(this, root, bytes);\n            return bytes;\n        }\n        var schema = this._schema;\n        var indexes = this._indexes;\n        var fieldsByIndex = this._fieldsByIndex;\n        var filters = this._filters;\n        var changes = Array.from((encodeAll) //  || client\n            ? this.$changes.allChanges\n            : this.$changes.changes).sort();\n        var _loop_2 = function (i, l) {\n            var field = fieldsByIndex[changes[i]] || changes[i];\n            var _field = \"_\" + field;\n            var type = schema[field];\n            var filter = (filters && filters[field]);\n            // const value = (filter && this.$allChanges[field]) || changes[field];\n            var value = this_2[_field];\n            var fieldIndex = indexes[field];\n            if (value === undefined) {\n                encode.uint8(bytes, spec_1.NIL);\n                encode.number(bytes, fieldIndex);\n            }\n            else if (type._schema) {\n                if (client && filter) {\n                    // skip if not allowed by custom filter\n                    if (!filter.call(this_2, client, value, root)) {\n                        return \"continue\";\n                    }\n                }\n                if (!value) {\n                    // value has been removed\n                    encode.uint8(bytes, spec_1.NIL);\n                    encode.number(bytes, fieldIndex);\n                }\n                else {\n                    // encode child object\n                    encode.number(bytes, fieldIndex);\n                    assertInstanceType(value, type, this_2, field);\n                    this_2.tryEncodeTypeId(bytes, type, value.constructor);\n                    value.encode(root, encodeAll, client, bytes);\n                }\n            }\n            else if (Array.isArray(type)) {\n                var $changes = value.$changes;\n                if (client && filter) {\n                    // skip if not allowed by custom filter\n                    if (!filter.call(this_2, client, value, root)) {\n                        return \"continue\";\n                    }\n                }\n                encode.number(bytes, fieldIndex);\n                // total number of items in the array\n                encode.number(bytes, value.length);\n                var arrayChanges = Array.from((encodeAll) //  || client\n                    ? $changes.allChanges\n                    : $changes.changes)\n                    .filter(function (index) { return _this[_field][index] !== undefined; })\n                    .sort(function (a, b) { return a - b; });\n                // ensure number of changes doesn't exceed array length\n                var numChanges = arrayChanges.length;\n                // number of changed items\n                encode.number(bytes, numChanges);\n                var isChildSchema = typeof (type[0]) !== \"string\";\n                // assert ArraySchema was provided\n                assertInstanceType(this_2[_field], ArraySchema_1.ArraySchema, this_2, field);\n                // encode Array of type\n                for (var j = 0; j < numChanges; j++) {\n                    var index = arrayChanges[j];\n                    var item = this_2[_field][index];\n                    /**\n                     * TODO: filter array by items instead of the whole object\n                     */\n                    // if (client && filter) {\n                    //     // skip if not allowed by custom filter\n                    //     if (!filter.call(this, client, item, root)) {\n                    //         continue;\n                    //     }\n                    // }\n                    if (isChildSchema) { // is array of Schema\n                        encode.number(bytes, index);\n                        if (!encodeAll) {\n                            var indexChange = $changes.getIndexChange(item);\n                            if (indexChange !== undefined) {\n                                encode.uint8(bytes, spec_1.INDEX_CHANGE);\n                                encode.number(bytes, indexChange);\n                            }\n                        }\n                        assertInstanceType(item, type[0], this_2, field);\n                        this_2.tryEncodeTypeId(bytes, type[0], item.constructor);\n                        item.encode(root, encodeAll, client, bytes);\n                    }\n                    else if (item !== undefined) { // is array of primitives\n                        encode.number(bytes, index);\n                        encodePrimitiveType(type[0], bytes, item, this_2, field);\n                    }\n                }\n                if (!encodeAll && !client) {\n                    $changes.discard();\n                }\n            }\n            else if (type.map) {\n                var $changes = value.$changes;\n                if (client && filter) {\n                    // skip if not allowed by custom filter\n                    if (!filter.call(this_2, client, value, root)) {\n                        return \"continue\";\n                    }\n                }\n                // encode Map of type\n                encode.number(bytes, fieldIndex);\n                // TODO: during `encodeAll`, removed entries are not going to be encoded\n                var keys = Array.from((encodeAll) //  || client\n                    ? $changes.allChanges\n                    : $changes.changes);\n                encode.number(bytes, keys.length);\n                // const previousKeys = Object.keys(this[_field]); // this is costly!\n                var previousKeys = Array.from($changes.allChanges);\n                var isChildSchema = typeof (type.map) !== \"string\";\n                var numChanges = keys.length;\n                // assert MapSchema was provided\n                assertInstanceType(this_2[_field], MapSchema_1.MapSchema, this_2, field);\n                for (var i_1 = 0; i_1 < numChanges; i_1++) {\n                    var key = keys[i_1];\n                    var item = this_2[_field][key];\n                    var mapItemIndex = undefined;\n                    /**\n                     * TODO: filter map by items instead of the whole object\n                     */\n                    // if (client && filter) {\n                    //     // skip if not allowed by custom filter\n                    //     if (!filter.call(this, client, item, root)) {\n                    //         continue;\n                    //     }\n                    // }\n                    if (encodeAll) {\n                        if (item === undefined) {\n                            // previously deleted items are skipped during `encodeAll`\n                            continue;\n                        }\n                    }\n                    else {\n                        // encode index change\n                        var indexChange = $changes.getIndexChange(item);\n                        if (item && indexChange !== undefined) {\n                            encode.uint8(bytes, spec_1.INDEX_CHANGE);\n                            encode.number(bytes, this_2[_field]._indexes.get(indexChange));\n                        }\n                        /**\n                         * - Allow item replacement\n                         * - Allow to use the index of a deleted item to encode as NIL\n                         */\n                        mapItemIndex = (!$changes.isDeleted(key) || !item)\n                            ? this_2[_field]._indexes.get(key)\n                            : undefined;\n                    }\n                    var isNil = (item === undefined);\n                    /**\n                     * Invert NIL to prevent collision with data starting with NIL byte\n                     */\n                    if (isNil) {\n                        // TODO: remove item\n                        // console.log(\"REMOVE KEY INDEX\", { key });\n                        // this[_field]._indexes.delete(key);\n                        encode.uint8(bytes, spec_1.NIL);\n                    }\n                    if (mapItemIndex !== undefined) {\n                        encode.number(bytes, mapItemIndex);\n                    }\n                    else {\n                        encode.string(bytes, key);\n                    }\n                    if (item && isChildSchema) {\n                        assertInstanceType(item, type.map, this_2, field);\n                        this_2.tryEncodeTypeId(bytes, type.map, item.constructor);\n                        item.encode(root, encodeAll, client, bytes);\n                    }\n                    else if (!isNil) {\n                        encodePrimitiveType(type.map, bytes, item, this_2, field);\n                    }\n                }\n                if (!encodeAll && !client) {\n                    $changes.discard();\n                    // TODO: track array/map indexes per client (for filtering)?\n                    // TODO: do not iterate though all MapSchema indexes here.\n                    this_2[_field]._updateIndexes(previousKeys);\n                }\n            }\n            else {\n                if (client && filter) {\n                    // skip if not allowed by custom filter\n                    if (!filter.call(this_2, client, value, root)) {\n                        return \"continue\";\n                    }\n                }\n                encode.number(bytes, fieldIndex);\n                encodePrimitiveType(type, bytes, value, this_2, field);\n            }\n        };\n        var this_2 = this;\n        for (var i = 0, l = changes.length; i < l; i++) {\n            _loop_2(i, l);\n        }\n        // flag end of Schema object structure\n        this._encodeEndOfStructure(this, root, bytes);\n        if (!encodeAll && !client) {\n            this.$changes.discard();\n        }\n        return bytes;\n    };\n    Schema.prototype.encodeFiltered = function (client, bytes) {\n        return this.encode(this, false, client, bytes);\n    };\n    Schema.prototype.encodeAll = function (bytes) {\n        return this.encode(this, true, undefined, bytes);\n    };\n    Schema.prototype.encodeAllFiltered = function (client, bytes) {\n        return this.encode(this, true, client, bytes);\n    };\n    Schema.prototype.clone = function () {\n        var cloned = new (this.constructor);\n        var schema = this._schema;\n        for (var field in schema) {\n            if (typeof (this[field]) === \"object\" &&\n                typeof (this[field].clone) === \"function\") {\n                // deep clone\n                cloned[field] = this[field].clone();\n            }\n            else {\n                // primitive values\n                cloned[field] = this[field];\n            }\n        }\n        return cloned;\n    };\n    Schema.prototype.triggerAll = function () {\n        var changes = [];\n        var schema = this._schema;\n        for (var field in schema) {\n            if (this[field] !== undefined) {\n                changes.push({\n                    field: field,\n                    value: this[field],\n                    previousValue: undefined\n                });\n            }\n        }\n        try {\n            this._triggerChanges(changes);\n        }\n        catch (e) {\n            Schema.onError(e);\n        }\n    };\n    Schema.prototype.toJSON = function () {\n        var schema = this._schema;\n        var deprecated = this._deprecated;\n        var obj = {};\n        for (var field in schema) {\n            if (!deprecated[field] && this[field] !== null && typeof (this[field]) !== \"undefined\") {\n                obj[field] = (typeof (this[field].toJSON) === \"function\")\n                    ? this[field].toJSON()\n                    : this[\"_\" + field];\n            }\n        }\n        return obj;\n    };\n    Schema.prototype.discardAllChanges = function () {\n        var schema = this._schema;\n        var changes = Array.from(this.$changes.changes);\n        var fieldsByIndex = this._fieldsByIndex;\n        for (var index in changes) {\n            var field = fieldsByIndex[index];\n            var type = schema[field];\n            var value = this[field];\n            // skip unchagned fields\n            if (value === undefined) {\n                continue;\n            }\n            if (type._schema) {\n                value.discardAllChanges();\n            }\n            else if (Array.isArray(type)) {\n                for (var i = 0, l = value.length; i < l; i++) {\n                    var index_1 = value[i];\n                    var item = this[\"_\" + field][index_1];\n                    if (typeof (type[0]) !== \"string\" && item) { // is array of Schema\n                        item.discardAllChanges();\n                    }\n                }\n                value.$changes.discard();\n            }\n            else if (type.map) {\n                var keys = value;\n                var mapKeys = Object.keys(this[\"_\" + field]);\n                for (var i = 0; i < keys.length; i++) {\n                    var key = mapKeys[keys[i]] || keys[i];\n                    var item = this[\"_\" + field][key];\n                    if (item instanceof Schema && item) {\n                        item.discardAllChanges();\n                    }\n                }\n                value.$changes.discard();\n            }\n        }\n        this.$changes.discard();\n    };\n    Schema.prototype._encodeEndOfStructure = function (instance, root, bytes) {\n        if (instance !== root) {\n            bytes.push(spec_1.END_OF_STRUCTURE);\n        }\n    };\n    Schema.prototype.tryEncodeTypeId = function (bytes, type, targetType) {\n        if (type._typeid !== targetType._typeid) {\n            encode.uint8(bytes, spec_1.TYPE_ID);\n            encode.uint8(bytes, targetType._typeid);\n        }\n    };\n    Schema.prototype.createTypeInstance = function (bytes, it, type) {\n        if (bytes[it.offset] === spec_1.TYPE_ID) {\n            it.offset++;\n            var anotherType = this.constructor._context.get(decode.uint8(bytes, it));\n            return new anotherType();\n        }\n        else {\n            return new type();\n        }\n    };\n    Schema.prototype._triggerChanges = function (changes) {\n        if (changes.length > 0) {\n            for (var i = 0; i < changes.length; i++) {\n                var change = changes[i];\n                var listener = this.$listeners[change.field];\n                if (listener) {\n                    try {\n                        listener.invoke(change.value, change.previousValue);\n                    }\n                    catch (e) {\n                        Schema.onError(e);\n                    }\n                }\n            }\n            if (this.onChange) {\n                try {\n                    this.onChange(changes);\n                }\n                catch (e) {\n                    Schema.onError(e);\n                }\n            }\n        }\n    };\n    return Schema;\n}());\nexports.Schema = Schema;\n//# sourceMappingURL=Schema.js.map","const debug = require('debug');\n\nconst APP_NAME = 'protoo-client';\n\nclass Logger\n{\n\tconstructor(prefix)\n\t{\n\t\tif (prefix)\n\t\t{\n\t\t\tthis._debug = debug(`${APP_NAME}:${prefix}`);\n\t\t\tthis._warn = debug(`${APP_NAME}:WARN:${prefix}`);\n\t\t\tthis._error = debug(`${APP_NAME}:ERROR:${prefix}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._debug = debug(APP_NAME);\n\t\t\tthis._warn = debug(`${APP_NAME}:WARN`);\n\t\t\tthis._error = debug(`${APP_NAME}:ERROR`);\n\t\t}\n\n\t\t/* eslint-disable no-console */\n\t\tthis._debug.log = console.info.bind(console);\n\t\tthis._warn.log = console.warn.bind(console);\n\t\tthis._error.log = console.error.bind(console);\n\t\t/* eslint-enable no-console */\n\t}\n\n\tget debug()\n\t{\n\t\treturn this._debug;\n\t}\n\n\tget warn()\n\t{\n\t\treturn this._warn;\n\t}\n\n\tget error()\n\t{\n\t\treturn this._error;\n\t}\n}\n\nmodule.exports = Logger;\n","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      var storageKey = \"loglevel\";\n      if (name) {\n        storageKey += \":\" + name;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if (typeof name !== \"string\" || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    return defaultLogger;\n}));\n","function apply(src, tar) {\n\ttar.headers = src.headers || {};\n\ttar.statusMessage = src.statusText;\n\ttar.statusCode = src.status;\n\ttar.data = src.response;\n}\n\nexports.send = function (method, uri, opts) {\n\treturn new Promise(function (res, rej) {\n\t\topts = opts || {};\n\t\tvar k, str, tmp, arr;\n\t\tvar req = new XMLHttpRequest;\n\t\tvar headers = opts.headers || {};\n\n\t\t// IE compatible\n\t\tif (opts.timeout) req.timeout = opts.timeout;\n\t\treq.ontimeout = req.onerror = function (err) {\n\t\t\terr.timeout = err.type == 'timeout';\n\t\t\trej(err);\n\t\t}\n\n\t\treq.open(method, uri.href || uri);\n\n\t\treq.onload = function () {\n\t\t\tarr = req.getAllResponseHeaders().trim().split(/[\\r\\n]+/);\n\t\t\tapply(req, req); //=> req.headers\n\n\t\t\twhile (tmp = arr.shift()) {\n\t\t\t\ttmp = tmp.split(': ');\n\t\t\t\treq.headers[tmp.shift().toLowerCase()] = tmp.join(': ');\n\t\t\t}\n\n\t\t\ttmp = req.headers['content-type'];\n\t\t\tif (tmp && !!~tmp.indexOf('application/json')) {\n\t\t\t\ttry {\n\t\t\t\t\treq.data = JSON.parse(req.data, opts.reviver);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tapply(req, err);\n\t\t\t\t\treturn rej(err);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t(req.status >= 400 ? rej : res)(req);\n\t\t};\n\n\t\tif ((str = opts.body) && typeof str == 'object') {\n\t\t\theaders['content-type'] = 'application/json';\n\t\t\tstr = JSON.stringify(str);\n\t\t}\n\n\t\treq.withCredentials = !!opts.withCredentials;\n\n\t\tfor (k in headers) {\n\t\t\treq.setRequestHeader(k, headers[k]);\n\t\t}\n\n\t\treq.send(str);\n\t});\n}\n\nexports.get = exports.send.bind(exports.send, 'GET');\nexports.post = exports.send.bind(exports.send, 'POST');\nexports.patch = exports.send.bind(exports.send, 'PATCH');\nexports.del = exports.send.bind(exports.send, 'DELETE');\nexports.put = exports.send.bind(exports.send, 'PUT');\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Room = void 0;\nvar msgpack = __importStar(require(\"./msgpack\"));\nvar strong_events_1 = require(\"strong-events\");\nvar nanoevents_1 = require(\"nanoevents\");\nvar Connection_1 = require(\"./Connection\");\nvar Serializer_1 = require(\"./serializer/Serializer\");\nvar Protocol_1 = require(\"./Protocol\");\nvar encode = __importStar(require(\"@colyseus/schema/lib/encoding/encode\"));\nvar decode = __importStar(require(\"@colyseus/schema/lib/encoding/decode\"));\nvar Room = /** @class */ (function () {\n    function Room(name, rootSchema) {\n        var _this = this;\n        // Public signals\n        this.onJoin = strong_events_1.createSignal();\n        this.onStateChange = strong_events_1.createSignal();\n        this.onError = strong_events_1.createSignal();\n        this.onLeave = strong_events_1.createSignal();\n        this.hasJoined = false;\n        this.onMessageHandlers = nanoevents_1.createNanoEvents();\n        this.id = null;\n        this.name = name;\n        if (rootSchema) {\n            this.serializer = new (Serializer_1.getSerializer(\"schema\"));\n            this.rootSchema = rootSchema;\n            this.serializer.state = new rootSchema();\n        }\n        else {\n            // TODO: remove default serializer. it should arrive only after JOIN_ROOM.\n            this.serializer = new (Serializer_1.getSerializer(\"fossil-delta\"));\n        }\n        this.onError(function (code, message) { return console.error(\"colyseus.js - onError => (\" + code + \") \" + message); });\n        this.onLeave(function () { return _this.removeAllListeners(); });\n    }\n    Room.prototype.connect = function (endpoint) {\n        var _this = this;\n        this.connection = new Connection_1.Connection(endpoint, false);\n        this.connection.reconnectEnabled = false;\n        this.connection.onmessage = this.onMessageCallback.bind(this);\n        this.connection.onclose = function (e) {\n            if (!_this.hasJoined) {\n                console.error(\"Room connection was closed unexpectedly (\" + e.code + \"): \" + e.reason);\n                _this.onError.invoke(e.code, e.reason);\n                return;\n            }\n            _this.onLeave.invoke(e.code);\n        };\n        this.connection.onerror = function (e) {\n            console.warn(\"Room, onError (\" + e.code + \"): \" + e.reason);\n            _this.onError.invoke(e.code, e.reason);\n        };\n        this.connection.open();\n    };\n    Room.prototype.leave = function (consented) {\n        if (consented === void 0) { consented = true; }\n        if (this.connection) {\n            if (consented) {\n                this.connection.send([Protocol_1.Protocol.LEAVE_ROOM]);\n            }\n            else {\n                this.connection.close();\n            }\n        }\n        else {\n            this.onLeave.invoke(4000); // \"consented\" code\n        }\n    };\n    Room.prototype.onMessage = function (type, callback) {\n        return this.onMessageHandlers.on(this.getMessageHandlerKey(type), callback);\n    };\n    Room.prototype.send = function (type, message) {\n        var initialBytes = [Protocol_1.Protocol.ROOM_DATA];\n        if (typeof (type) === \"string\") {\n            encode.string(initialBytes, type);\n        }\n        else {\n            encode.number(initialBytes, type);\n        }\n        var arr;\n        if (message !== undefined) {\n            var encoded = msgpack.encode(message);\n            arr = new Uint8Array(initialBytes.length + encoded.byteLength);\n            arr.set(new Uint8Array(initialBytes), 0);\n            arr.set(new Uint8Array(encoded), initialBytes.length);\n        }\n        else {\n            arr = new Uint8Array(initialBytes);\n        }\n        this.connection.send(arr.buffer);\n    };\n    Object.defineProperty(Room.prototype, \"state\", {\n        get: function () {\n            return this.serializer.getState();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    // TODO: deprecate / move somewhere else\n    // this method is useful only for FossilDeltaSerializer\n    Room.prototype.listen = function (segments, callback, immediate) {\n        if (this.serializerId === \"schema\") {\n            console.error(\"'\" + this.serializerId + \"' serializer doesn't support .listen() method here.\");\n            return;\n        }\n        else if (!this.serializerId) {\n            console.warn(\"room.Listen() should be called after room.onJoin has been called (DEPRECATION WARNING)\");\n        }\n        return this.serializer.api.listen(segments, callback, immediate);\n    };\n    // TODO: deprecate / move somewhere else\n    // this method is useful only for FossilDeltaSerializer\n    Room.prototype.removeListener = function (listener) {\n        return this.serializer.api.removeListener(listener);\n    };\n    Room.prototype.removeAllListeners = function () {\n        if (this.serializer) {\n            this.serializer.teardown();\n        }\n        this.onJoin.clear();\n        this.onStateChange.clear();\n        this.onError.clear();\n        this.onLeave.clear();\n    };\n    Room.prototype.onMessageCallback = function (event) {\n        var bytes = Array.from(new Uint8Array(event.data));\n        var code = bytes[0];\n        if (code === Protocol_1.Protocol.JOIN_ROOM) {\n            var offset = 1;\n            this.serializerId = Protocol_1.utf8Read(bytes, offset);\n            offset += Protocol_1.utf8Length(this.serializerId);\n            // get serializer implementation\n            var serializer = Serializer_1.getSerializer(this.serializerId);\n            if (!serializer) {\n                throw new Error(\"missing serializer: \" + this.serializerId);\n            }\n            // TODO: remove this check\n            if (this.serializerId !== \"fossil-delta\" && !this.rootSchema) {\n                this.serializer = new serializer();\n            }\n            if (bytes.length > offset && this.serializer.handshake) {\n                this.serializer.handshake(bytes, { offset: 1 });\n            }\n            this.hasJoined = true;\n            this.onJoin.invoke();\n            // acknowledge successfull JOIN_ROOM\n            this.connection.send([Protocol_1.Protocol.JOIN_ROOM]);\n        }\n        else if (code === Protocol_1.Protocol.ERROR) {\n            var it_1 = { offset: 1 };\n            var code_1 = decode.number(bytes, it_1);\n            var message = decode.string(bytes, it_1);\n            this.onError.invoke(code_1, message);\n        }\n        else if (code === Protocol_1.Protocol.LEAVE_ROOM) {\n            this.leave();\n        }\n        else if (code === Protocol_1.Protocol.ROOM_DATA_SCHEMA) {\n            var context_1 = this.serializer.getState().constructor._context;\n            var type = context_1.get(bytes[1]);\n            var message = new type();\n            message.decode(bytes, { offset: 2 });\n            this.dispatchMessage(type, message);\n        }\n        else if (code === Protocol_1.Protocol.ROOM_STATE) {\n            bytes.shift(); // drop `code` byte\n            this.setState(bytes);\n        }\n        else if (code === Protocol_1.Protocol.ROOM_STATE_PATCH) {\n            bytes.shift(); // drop `code` byte\n            this.patch(bytes);\n        }\n        else if (code === Protocol_1.Protocol.ROOM_DATA) {\n            var it_2 = { offset: 1 };\n            var type = (decode.stringCheck(bytes, it_2))\n                ? decode.string(bytes, it_2)\n                : decode.number(bytes, it_2);\n            var message = (bytes.length > it_2.offset)\n                ? msgpack.decode(event.data, it_2.offset)\n                : undefined;\n            this.dispatchMessage(type, message);\n        }\n    };\n    Room.prototype.setState = function (encodedState) {\n        this.serializer.setState(encodedState);\n        this.onStateChange.invoke(this.serializer.getState());\n    };\n    Room.prototype.patch = function (binaryPatch) {\n        this.serializer.patch(binaryPatch);\n        this.onStateChange.invoke(this.serializer.getState());\n    };\n    Room.prototype.dispatchMessage = function (type, message) {\n        var messageType = this.getMessageHandlerKey(type);\n        if (this.onMessageHandlers.events[messageType]) {\n            this.onMessageHandlers.emit(messageType, message);\n        }\n        else if (this.onMessageHandlers.events['*']) {\n            this.onMessageHandlers.emit('*', type, message);\n        }\n        else {\n            console.warn(\"onMessage not registered for type '\" + type + \"'.\");\n        }\n    };\n    Room.prototype.getMessageHandlerKey = function (type) {\n        switch (typeof (type)) {\n            // typeof Schema\n            case \"function\": return \"$\" + type._typeid;\n            // string\n            case \"string\": return type;\n            // number\n            case \"number\": return \"i\" + type;\n            default: throw new Error(\"invalid message type.\");\n        }\n    };\n    return Room;\n}());\nexports.Room = Room;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.encode = exports.decode = void 0;\nvar decode_1 = __importDefault(require(\"./msgpack/decode\"));\nvar encode_1 = __importDefault(require(\"./msgpack/encode\"));\nexports.decode = decode_1.default;\nexports.encode = encode_1.default;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getSerializer = exports.registerSerializer = void 0;\nvar serializers = {};\nfunction registerSerializer(id, serializer) {\n    serializers[id] = serializer;\n}\nexports.registerSerializer = registerSerializer;\nfunction getSerializer(id) {\n    return serializers[id];\n}\nexports.getSerializer = getSerializer;\n","\"use strict\";\n// Use codes between 0~127 for lesser throughput (1 byte)\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.utf8Length = exports.utf8Read = exports.ErrorCode = exports.Protocol = void 0;\nvar Protocol;\n(function (Protocol) {\n    // Room-related (10~19)\n    Protocol[Protocol[\"HANDSHAKE\"] = 9] = \"HANDSHAKE\";\n    Protocol[Protocol[\"JOIN_ROOM\"] = 10] = \"JOIN_ROOM\";\n    Protocol[Protocol[\"ERROR\"] = 11] = \"ERROR\";\n    Protocol[Protocol[\"LEAVE_ROOM\"] = 12] = \"LEAVE_ROOM\";\n    Protocol[Protocol[\"ROOM_DATA\"] = 13] = \"ROOM_DATA\";\n    Protocol[Protocol[\"ROOM_STATE\"] = 14] = \"ROOM_STATE\";\n    Protocol[Protocol[\"ROOM_STATE_PATCH\"] = 15] = \"ROOM_STATE_PATCH\";\n    Protocol[Protocol[\"ROOM_DATA_SCHEMA\"] = 16] = \"ROOM_DATA_SCHEMA\";\n})(Protocol = exports.Protocol || (exports.Protocol = {}));\nvar ErrorCode;\n(function (ErrorCode) {\n    ErrorCode[ErrorCode[\"MATCHMAKE_NO_HANDLER\"] = 4210] = \"MATCHMAKE_NO_HANDLER\";\n    ErrorCode[ErrorCode[\"MATCHMAKE_INVALID_CRITERIA\"] = 4211] = \"MATCHMAKE_INVALID_CRITERIA\";\n    ErrorCode[ErrorCode[\"MATCHMAKE_INVALID_ROOM_ID\"] = 4212] = \"MATCHMAKE_INVALID_ROOM_ID\";\n    ErrorCode[ErrorCode[\"MATCHMAKE_UNHANDLED\"] = 4213] = \"MATCHMAKE_UNHANDLED\";\n    ErrorCode[ErrorCode[\"MATCHMAKE_EXPIRED\"] = 4214] = \"MATCHMAKE_EXPIRED\";\n    ErrorCode[ErrorCode[\"AUTH_FAILED\"] = 4215] = \"AUTH_FAILED\";\n    ErrorCode[ErrorCode[\"APPLICATION_ERROR\"] = 4216] = \"APPLICATION_ERROR\";\n})(ErrorCode = exports.ErrorCode || (exports.ErrorCode = {}));\nfunction utf8Read(view, offset) {\n    var length = view[offset++];\n    var string = '', chr = 0;\n    for (var i = offset, end = offset + length; i < end; i++) {\n        var byte = view[i];\n        if ((byte & 0x80) === 0x00) {\n            string += String.fromCharCode(byte);\n            continue;\n        }\n        if ((byte & 0xe0) === 0xc0) {\n            string += String.fromCharCode(((byte & 0x1f) << 6) |\n                (view[++i] & 0x3f));\n            continue;\n        }\n        if ((byte & 0xf0) === 0xe0) {\n            string += String.fromCharCode(((byte & 0x0f) << 12) |\n                ((view[++i] & 0x3f) << 6) |\n                ((view[++i] & 0x3f) << 0));\n            continue;\n        }\n        if ((byte & 0xf8) === 0xf0) {\n            chr = ((byte & 0x07) << 18) |\n                ((view[++i] & 0x3f) << 12) |\n                ((view[++i] & 0x3f) << 6) |\n                ((view[++i] & 0x3f) << 0);\n            if (chr >= 0x010000) { // surrogate pair\n                chr -= 0x010000;\n                string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n            }\n            else {\n                string += String.fromCharCode(chr);\n            }\n            continue;\n        }\n        throw new Error('Invalid byte ' + byte.toString(16));\n    }\n    return string;\n}\nexports.utf8Read = utf8Read;\n// Faster for short strings than Buffer.byteLength\nfunction utf8Length(str) {\n    if (str === void 0) { str = ''; }\n    var c = 0;\n    var length = 0;\n    for (var i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length + 1;\n}\nexports.utf8Length = utf8Length;\n","\"use strict\";\n/**\n * Copyright (c) 2018 Endel Dreyer\n * Copyright (c) 2014 Ion Drive Software Ltd.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.number = exports.string = exports.boolean = exports.writeFloat64 = exports.writeFloat32 = exports.float64 = exports.float32 = exports.uint64 = exports.int64 = exports.uint32 = exports.int32 = exports.uint16 = exports.int16 = exports.uint8 = exports.int8 = exports.utf8Write = void 0;\n/**\n * msgpack implementation highly based on notepack.io\n * https://github.com/darrachequesne/notepack\n */\nfunction utf8Length(str) {\n    var c = 0, length = 0;\n    for (var i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\nfunction utf8Write(view, offset, str) {\n    var c = 0;\n    for (var i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            view[offset++] = c;\n        }\n        else if (c < 0x800) {\n            view[offset++] = 0xc0 | (c >> 6);\n            view[offset++] = 0x80 | (c & 0x3f);\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            view[offset++] = 0xe0 | (c >> 12);\n            view[offset++] = 0x80 | (c >> 6 & 0x3f);\n            view[offset++] = 0x80 | (c & 0x3f);\n        }\n        else {\n            i++;\n            c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\n            view[offset++] = 0xf0 | (c >> 18);\n            view[offset++] = 0x80 | (c >> 12 & 0x3f);\n            view[offset++] = 0x80 | (c >> 6 & 0x3f);\n            view[offset++] = 0x80 | (c & 0x3f);\n        }\n    }\n}\nexports.utf8Write = utf8Write;\nfunction int8(bytes, value) {\n    bytes.push(value & 255);\n}\nexports.int8 = int8;\n;\nfunction uint8(bytes, value) {\n    bytes.push(value & 255);\n}\nexports.uint8 = uint8;\n;\nfunction int16(bytes, value) {\n    bytes.push(value & 255);\n    bytes.push((value >> 8) & 255);\n}\nexports.int16 = int16;\n;\nfunction uint16(bytes, value) {\n    bytes.push(value & 255);\n    bytes.push((value >> 8) & 255);\n}\nexports.uint16 = uint16;\n;\nfunction int32(bytes, value) {\n    bytes.push(value & 255);\n    bytes.push((value >> 8) & 255);\n    bytes.push((value >> 16) & 255);\n    bytes.push((value >> 24) & 255);\n}\nexports.int32 = int32;\n;\nfunction uint32(bytes, value) {\n    var b4 = value >> 24;\n    var b3 = value >> 16;\n    var b2 = value >> 8;\n    var b1 = value;\n    bytes.push(b1 & 255);\n    bytes.push(b2 & 255);\n    bytes.push(b3 & 255);\n    bytes.push(b4 & 255);\n}\nexports.uint32 = uint32;\n;\nfunction int64(bytes, value) {\n    var high = Math.floor(value / Math.pow(2, 32));\n    var low = value >>> 0;\n    uint32(bytes, low);\n    uint32(bytes, high);\n}\nexports.int64 = int64;\n;\nfunction uint64(bytes, value) {\n    var high = (value / Math.pow(2, 32)) >> 0;\n    var low = value >>> 0;\n    uint32(bytes, low);\n    uint32(bytes, high);\n}\nexports.uint64 = uint64;\n;\nfunction float32(bytes, value) {\n    writeFloat32(bytes, value);\n}\nexports.float32 = float32;\nfunction float64(bytes, value) {\n    writeFloat64(bytes, value);\n}\nexports.float64 = float64;\n// force little endian to facilitate decoding on multiple implementations\nvar _isLittleEndian = true; // new Uint16Array(new Uint8Array([1, 0]).buffer)[0] === 1;\nvar _int32 = new Int32Array(2);\nvar _float32 = new Float32Array(_int32.buffer);\nvar _float64 = new Float64Array(_int32.buffer);\nfunction writeFloat32(bytes, value) {\n    _float32[0] = value;\n    int32(bytes, _int32[0]);\n}\nexports.writeFloat32 = writeFloat32;\n;\nfunction writeFloat64(bytes, value) {\n    _float64[0] = value;\n    int32(bytes, _int32[_isLittleEndian ? 0 : 1]);\n    int32(bytes, _int32[_isLittleEndian ? 1 : 0]);\n}\nexports.writeFloat64 = writeFloat64;\n;\nfunction boolean(bytes, value) {\n    return uint8(bytes, value ? 1 : 0);\n}\nexports.boolean = boolean;\n;\nfunction string(bytes, value) {\n    // encode `null` strings as empty.\n    if (!value) {\n        value = \"\";\n    }\n    var length = utf8Length(value);\n    var size = 0;\n    // fixstr\n    if (length < 0x20) {\n        bytes.push(length | 0xa0);\n        size = 1;\n    }\n    // str 8\n    else if (length < 0x100) {\n        bytes.push(0xd9);\n        uint8(bytes, length);\n        size = 2;\n    }\n    // str 16\n    else if (length < 0x10000) {\n        bytes.push(0xda);\n        uint16(bytes, length);\n        size = 3;\n    }\n    // str 32\n    else if (length < 0x100000000) {\n        bytes.push(0xdb);\n        uint32(bytes, length);\n        size = 5;\n    }\n    else {\n        throw new Error('String too long');\n    }\n    utf8Write(bytes, bytes.length, value);\n    return size + length;\n}\nexports.string = string;\nfunction number(bytes, value) {\n    if (isNaN(value)) {\n        return number(bytes, 0);\n    }\n    else if (!isFinite(value)) {\n        return number(bytes, (value > 0) ? Number.MAX_SAFE_INTEGER : -Number.MAX_SAFE_INTEGER);\n    }\n    else if (value !== (value | 0)) {\n        bytes.push(0xcb);\n        writeFloat64(bytes, value);\n        return 9;\n        // TODO: encode float 32?\n        // is it possible to differentiate between float32 / float64 here?\n        // // float 32\n        // bytes.push(0xca);\n        // writeFloat32(bytes, value);\n        // return 5;\n    }\n    if (value >= 0) {\n        // positive fixnum\n        if (value < 0x80) {\n            uint8(bytes, value);\n            return 1;\n        }\n        // uint 8\n        if (value < 0x100) {\n            bytes.push(0xcc);\n            uint8(bytes, value);\n            return 2;\n        }\n        // uint 16\n        if (value < 0x10000) {\n            bytes.push(0xcd);\n            uint16(bytes, value);\n            return 3;\n        }\n        // uint 32\n        if (value < 0x100000000) {\n            bytes.push(0xce);\n            uint32(bytes, value);\n            return 5;\n        }\n        // uint 64\n        bytes.push(0xcf);\n        uint64(bytes, value);\n        return 9;\n    }\n    else {\n        // negative fixnum\n        if (value >= -0x20) {\n            bytes.push(value);\n            return 1;\n        }\n        // int 8\n        if (value >= -0x80) {\n            bytes.push(0xd0);\n            int8(bytes, value);\n            return 2;\n        }\n        // int 16\n        if (value >= -0x8000) {\n            bytes.push(0xd1);\n            int16(bytes, value);\n            return 3;\n        }\n        // int 32\n        if (value >= -0x80000000) {\n            bytes.push(0xd2);\n            int32(bytes, value);\n            return 5;\n        }\n        // int 64\n        bytes.push(0xd3);\n        int64(bytes, value);\n        return 9;\n    }\n}\nexports.number = number;\n//# sourceMappingURL=encode.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.indexChangeCheck = exports.nilCheck = exports.arrayCheck = exports.numberCheck = exports.number = exports.stringCheck = exports.string = exports.boolean = exports.readFloat64 = exports.readFloat32 = exports.uint64 = exports.int64 = exports.float64 = exports.float32 = exports.uint32 = exports.int32 = exports.uint16 = exports.int16 = exports.uint8 = exports.int8 = void 0;\nvar spec_1 = require(\"../spec\");\nfunction utf8Read(bytes, offset, length) {\n    var string = '', chr = 0;\n    for (var i = offset, end = offset + length; i < end; i++) {\n        var byte = bytes[i];\n        if ((byte & 0x80) === 0x00) {\n            string += String.fromCharCode(byte);\n            continue;\n        }\n        if ((byte & 0xe0) === 0xc0) {\n            string += String.fromCharCode(((byte & 0x1f) << 6) |\n                (bytes[++i] & 0x3f));\n            continue;\n        }\n        if ((byte & 0xf0) === 0xe0) {\n            string += String.fromCharCode(((byte & 0x0f) << 12) |\n                ((bytes[++i] & 0x3f) << 6) |\n                ((bytes[++i] & 0x3f) << 0));\n            continue;\n        }\n        if ((byte & 0xf8) === 0xf0) {\n            chr = ((byte & 0x07) << 18) |\n                ((bytes[++i] & 0x3f) << 12) |\n                ((bytes[++i] & 0x3f) << 6) |\n                ((bytes[++i] & 0x3f) << 0);\n            if (chr >= 0x010000) { // surrogate pair\n                chr -= 0x010000;\n                string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n            }\n            else {\n                string += String.fromCharCode(chr);\n            }\n            continue;\n        }\n        throw new Error('Invalid byte ' + byte.toString(16));\n    }\n    return string;\n}\nfunction int8(bytes, it) {\n    return uint8(bytes, it) << 24 >> 24;\n}\nexports.int8 = int8;\n;\nfunction uint8(bytes, it) {\n    return bytes[it.offset++];\n}\nexports.uint8 = uint8;\n;\nfunction int16(bytes, it) {\n    return uint16(bytes, it) << 16 >> 16;\n}\nexports.int16 = int16;\n;\nfunction uint16(bytes, it) {\n    return bytes[it.offset++] | bytes[it.offset++] << 8;\n}\nexports.uint16 = uint16;\n;\nfunction int32(bytes, it) {\n    return bytes[it.offset++] | bytes[it.offset++] << 8 | bytes[it.offset++] << 16 | bytes[it.offset++] << 24;\n}\nexports.int32 = int32;\n;\nfunction uint32(bytes, it) {\n    return int32(bytes, it) >>> 0;\n}\nexports.uint32 = uint32;\n;\nfunction float32(bytes, it) {\n    return readFloat32(bytes, it);\n}\nexports.float32 = float32;\nfunction float64(bytes, it) {\n    return readFloat64(bytes, it);\n}\nexports.float64 = float64;\nfunction int64(bytes, it) {\n    var low = uint32(bytes, it);\n    var high = int32(bytes, it) * Math.pow(2, 32);\n    return high + low;\n}\nexports.int64 = int64;\n;\nfunction uint64(bytes, it) {\n    var low = uint32(bytes, it);\n    var high = uint32(bytes, it) * Math.pow(2, 32);\n    return high + low;\n}\nexports.uint64 = uint64;\n;\n// force little endian to facilitate decoding on multiple implementations\nvar _isLittleEndian = true; // new Uint16Array(new Uint8Array([1, 0]).buffer)[0] === 1;\nvar _int32 = new Int32Array(2);\nvar _float32 = new Float32Array(_int32.buffer);\nvar _float64 = new Float64Array(_int32.buffer);\nfunction readFloat32(bytes, it) {\n    _int32[0] = int32(bytes, it);\n    return _float32[0];\n}\nexports.readFloat32 = readFloat32;\n;\nfunction readFloat64(bytes, it) {\n    _int32[_isLittleEndian ? 0 : 1] = int32(bytes, it);\n    _int32[_isLittleEndian ? 1 : 0] = int32(bytes, it);\n    return _float64[0];\n}\nexports.readFloat64 = readFloat64;\n;\nfunction boolean(bytes, it) {\n    return uint8(bytes, it) > 0;\n}\nexports.boolean = boolean;\n;\nfunction string(bytes, it) {\n    var prefix = bytes[it.offset++];\n    var length;\n    if (prefix < 0xc0) {\n        // fixstr\n        length = prefix & 0x1f;\n    }\n    else if (prefix === 0xd9) {\n        length = uint8(bytes, it);\n    }\n    else if (prefix === 0xda) {\n        length = uint16(bytes, it);\n    }\n    else if (prefix === 0xdb) {\n        length = uint32(bytes, it);\n    }\n    var value = utf8Read(bytes, it.offset, length);\n    it.offset += length;\n    return value;\n}\nexports.string = string;\nfunction stringCheck(bytes, it) {\n    var prefix = bytes[it.offset];\n    return (\n    // fixstr\n    (prefix < 0xc0 && prefix > 0xa0) ||\n        // str 8\n        prefix === 0xd9 ||\n        // str 16\n        prefix === 0xda ||\n        // str 32\n        prefix === 0xdb);\n}\nexports.stringCheck = stringCheck;\nfunction number(bytes, it) {\n    var prefix = bytes[it.offset++];\n    if (prefix < 0x80) {\n        // positive fixint\n        return prefix;\n    }\n    else if (prefix === 0xca) {\n        // float 32\n        return readFloat32(bytes, it);\n    }\n    else if (prefix === 0xcb) {\n        // float 64\n        return readFloat64(bytes, it);\n    }\n    else if (prefix === 0xcc) {\n        // uint 8\n        return uint8(bytes, it);\n    }\n    else if (prefix === 0xcd) {\n        // uint 16\n        return uint16(bytes, it);\n    }\n    else if (prefix === 0xce) {\n        // uint 32\n        return uint32(bytes, it);\n    }\n    else if (prefix === 0xcf) {\n        // uint 64\n        return uint64(bytes, it);\n    }\n    else if (prefix === 0xd0) {\n        // int 8\n        return int8(bytes, it);\n    }\n    else if (prefix === 0xd1) {\n        // int 16\n        return int16(bytes, it);\n    }\n    else if (prefix === 0xd2) {\n        // int 32\n        return int32(bytes, it);\n    }\n    else if (prefix === 0xd3) {\n        // int 64\n        return int64(bytes, it);\n    }\n    else if (prefix > 0xdf) {\n        // negative fixint\n        return (0xff - prefix + 1) * -1;\n    }\n}\nexports.number = number;\n;\nfunction numberCheck(bytes, it) {\n    var prefix = bytes[it.offset];\n    // positive fixint - 0x00 - 0x7f\n    // float 32        - 0xca\n    // float 64        - 0xcb\n    // uint 8          - 0xcc\n    // uint 16         - 0xcd\n    // uint 32         - 0xce\n    // uint 64         - 0xcf\n    // int 8           - 0xd0\n    // int 16          - 0xd1\n    // int 32          - 0xd2\n    // int 64          - 0xd3\n    return (prefix < 0x80 ||\n        (prefix >= 0xca && prefix <= 0xd3));\n}\nexports.numberCheck = numberCheck;\nfunction arrayCheck(bytes, it) {\n    return bytes[it.offset] < 0xa0;\n    // const prefix = bytes[it.offset] ;\n    // if (prefix < 0xa0) {\n    //   return prefix;\n    // // array\n    // } else if (prefix === 0xdc) {\n    //   it.offset += 2;\n    // } else if (0xdd) {\n    //   it.offset += 4;\n    // }\n    // return prefix;\n}\nexports.arrayCheck = arrayCheck;\nfunction nilCheck(bytes, it) {\n    return bytes[it.offset] === spec_1.NIL;\n}\nexports.nilCheck = nilCheck;\nfunction indexChangeCheck(bytes, it) {\n    return bytes[it.offset] === spec_1.INDEX_CHANGE;\n}\nexports.indexChangeCheck = indexChangeCheck;\n//# sourceMappingURL=decode.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TYPE_ID = exports.INDEX_CHANGE = exports.NIL = exports.END_OF_STRUCTURE = void 0;\nexports.END_OF_STRUCTURE = 0xc1; // (msgpack spec: never used)\nexports.NIL = 0xc0;\nexports.INDEX_CHANGE = 0xd4;\nexports.TYPE_ID = 0xd5;\n//# sourceMappingURL=spec.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Auth = exports.Platform = void 0;\nvar http = __importStar(require(\"@colyseus/http\"));\nvar Storage_1 = require(\"./Storage\");\nvar TOKEN_STORAGE = \"colyseus-auth-token\";\nvar Platform;\n(function (Platform) {\n    Platform[\"ios\"] = \"ios\";\n    Platform[\"android\"] = \"android\";\n})(Platform = exports.Platform || (exports.Platform = {}));\nvar Auth = /** @class */ (function () {\n    function Auth(endpoint) {\n        var _this = this;\n        this._id = undefined;\n        this.username = undefined;\n        this.displayName = undefined;\n        this.avatarUrl = undefined;\n        this.isAnonymous = undefined;\n        this.email = undefined;\n        this.lang = undefined;\n        this.location = undefined;\n        this.timezone = undefined;\n        this.metadata = undefined;\n        this.devices = undefined;\n        this.facebookId = undefined;\n        this.twitterId = undefined;\n        this.googleId = undefined;\n        this.gameCenterId = undefined;\n        this.steamId = undefined;\n        this.friendIds = undefined;\n        this.blockedUserIds = undefined;\n        this.createdAt = undefined;\n        this.updatedAt = undefined;\n        // auth token\n        this.token = undefined;\n        this.endpoint = endpoint.replace(\"ws\", \"http\");\n        Storage_1.getItem(TOKEN_STORAGE, function (token) { return _this.token = token; });\n    }\n    Object.defineProperty(Auth.prototype, \"hasToken\", {\n        get: function () {\n            return !!this.token;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Auth.prototype.login = function (options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var queryParams, data, attr;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        queryParams = Object.assign({}, options);\n                        if (this.hasToken) {\n                            queryParams.token = this.token;\n                        }\n                        return [4 /*yield*/, this.request('post', '/auth', queryParams)];\n                    case 1:\n                        data = _a.sent();\n                        // set & cache token\n                        this.token = data.token;\n                        Storage_1.setItem(TOKEN_STORAGE, this.token);\n                        for (attr in data) {\n                            if (this.hasOwnProperty(attr)) {\n                                this[attr] = data[attr];\n                            }\n                        }\n                        this.registerPingService();\n                        return [2 /*return*/, this];\n                }\n            });\n        });\n    };\n    Auth.prototype.save = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('put', '/auth', {}, {\n                            username: this.username,\n                            displayName: this.displayName,\n                            avatarUrl: this.avatarUrl,\n                            lang: this.lang,\n                            location: this.location,\n                            timezone: this.timezone,\n                        })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, this];\n                }\n            });\n        });\n    };\n    Auth.prototype.getFriends = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('get', '/friends/all')];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.getOnlineFriends = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('get', '/friends/online')];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.getFriendRequests = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('get', '/friends/requests')];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.sendFriendRequest = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('post', '/friends/requests', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.acceptFriendRequest = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('put', '/friends/requests', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.declineFriendRequest = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('del', '/friends/requests', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.blockUser = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('post', '/friends/block', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.unblockUser = function (friendId) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.request('put', '/friends/block', { userId: friendId })];\n                    case 1: return [2 /*return*/, (_a.sent())];\n                }\n            });\n        });\n    };\n    Auth.prototype.request = function (method, segments, query, body, headers) {\n        if (query === void 0) { query = {}; }\n        if (headers === void 0) { headers = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var queryParams, name_1, queryString, opts;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        headers['Accept'] = 'application/json';\n                        if (this.hasToken) {\n                            headers['Authorization'] = 'Bearer ' + this.token;\n                        }\n                        queryParams = [];\n                        for (name_1 in query) {\n                            queryParams.push(name_1 + \"=\" + query[name_1]);\n                        }\n                        queryString = (queryParams.length > 0)\n                            ? \"?\" + queryParams.join(\"&\")\n                            : '';\n                        opts = { headers: headers };\n                        if (body) {\n                            opts.body = body;\n                        }\n                        return [4 /*yield*/, http[method](\"\" + this.endpoint + segments + queryString, opts)];\n                    case 1: return [2 /*return*/, (_a.sent()).data];\n                }\n            });\n        });\n    };\n    Auth.prototype.logout = function () {\n        this.token = undefined;\n        Storage_1.removeItem(TOKEN_STORAGE);\n        this.unregisterPingService();\n    };\n    Auth.prototype.registerPingService = function (timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = 15000; }\n        this.unregisterPingService();\n        this.keepOnlineInterval = setInterval(function () { return _this.request('get', '/auth'); }, timeout);\n    };\n    Auth.prototype.unregisterPingService = function () {\n        clearInterval(this.keepOnlineInterval);\n    };\n    return Auth;\n}());\nexports.Auth = Auth;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Schema_1 = require(\"./Schema\");\nObject.defineProperty(exports, \"Schema\", { enumerable: true, get: function () { return Schema_1.Schema; } });\nvar MapSchema_1 = require(\"./types/MapSchema\");\nObject.defineProperty(exports, \"MapSchema\", { enumerable: true, get: function () { return MapSchema_1.MapSchema; } });\nvar ArraySchema_1 = require(\"./types/ArraySchema\");\nObject.defineProperty(exports, \"ArraySchema\", { enumerable: true, get: function () { return ArraySchema_1.ArraySchema; } });\n// Utils\nvar utils_1 = require(\"./utils\");\nObject.defineProperty(exports, \"dumpChanges\", { enumerable: true, get: function () { return utils_1.dumpChanges; } });\n// Reflection\nvar Reflection_1 = require(\"./Reflection\");\nObject.defineProperty(exports, \"Reflection\", { enumerable: true, get: function () { return Reflection_1.Reflection; } });\nObject.defineProperty(exports, \"ReflectionType\", { enumerable: true, get: function () { return Reflection_1.ReflectionType; } });\nObject.defineProperty(exports, \"ReflectionField\", { enumerable: true, get: function () { return Reflection_1.ReflectionField; } });\nvar annotations_1 = require(\"./annotations\");\n// Annotations\nObject.defineProperty(exports, \"type\", { enumerable: true, get: function () { return annotations_1.type; } });\nObject.defineProperty(exports, \"deprecated\", { enumerable: true, get: function () { return annotations_1.deprecated; } });\nObject.defineProperty(exports, \"filter\", { enumerable: true, get: function () { return annotations_1.filter; } });\nObject.defineProperty(exports, \"defineTypes\", { enumerable: true, get: function () { return annotations_1.defineTypes; } });\n// Types\nObject.defineProperty(exports, \"Context\", { enumerable: true, get: function () { return annotations_1.Context; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ChangeTree = void 0;\nvar Schema_1 = require(\"./Schema\");\nvar ArraySchema_1 = require(\"./types/ArraySchema\");\nvar MapSchema_1 = require(\"./types/MapSchema\");\nvar ChangeTree = /** @class */ (function () {\n    function ChangeTree(indexes, parentField, parent) {\n        if (indexes === void 0) { indexes = {}; }\n        if (parentField === void 0) { parentField = null; }\n        this.changed = false;\n        this.changes = new Set();\n        this.allChanges = new Set();\n        this.deletedKeys = {};\n        this.fieldIndexes = indexes;\n        this.parent = parent;\n        this.parentField = parentField;\n    }\n    ChangeTree.prototype.change = function (fieldName, isDelete) {\n        if (isDelete === void 0) { isDelete = false; }\n        var fieldIndex = this.fieldIndexes[fieldName];\n        var field = (typeof (fieldIndex) === \"number\") ? fieldIndex : fieldName;\n        if (!isDelete) {\n            this.changed = true;\n            this.changes.add(field);\n            this.allChanges.add(field);\n        }\n        else if (isDelete) {\n            // if (this.changes.has(field))  {\n            //     /**\n            //      * un-flag a change if item has been added AND removed in the same patch.\n            //      * (https://github.com/colyseus/colyseus-unity3d/issues/103)\n            //      */\n            //     this.changes.delete(field);\n            // } else {\n            this.changed = true;\n            this.changes.add(field);\n            // }\n            // discard all-changes for removed items.\n            this.allChanges.delete(field);\n        }\n        if (this.parent) {\n            this.parent.change(this.parentField);\n        }\n    };\n    ChangeTree.prototype.mapIndex = function (instance, key) {\n        if (typeof instance === \"object\") {\n            if (!this.indexMap) {\n                this.indexMap = new Map();\n                this.indexChange = new Map();\n            }\n            this.indexMap.set(instance, key);\n        }\n    };\n    ChangeTree.prototype.getIndex = function (instance) {\n        return this.indexMap && this.indexMap.get(instance);\n    };\n    ChangeTree.prototype.deleteIndex = function (instance) {\n        if (typeof instance === \"object\") {\n            this.deletedKeys[this.indexMap.get(instance)] = true;\n            this.indexMap.delete(instance);\n        }\n    };\n    ChangeTree.prototype.isDeleted = function (key) {\n        return this.deletedKeys[key] !== undefined;\n    };\n    ChangeTree.prototype.mapIndexChange = function (instance, previousKey) {\n        if (typeof instance === \"object\" && !this.indexChange.has(instance)) {\n            this.indexChange.set(instance, previousKey);\n        }\n    };\n    ChangeTree.prototype.getIndexChange = function (instance) {\n        return this.indexChange && this.indexChange.get(instance);\n    };\n    ChangeTree.prototype.deleteIndexChange = function (instance) {\n        if (typeof instance === \"object\") {\n            this.indexChange.delete(instance);\n        }\n    };\n    ChangeTree.prototype.changeAll = function (obj) {\n        if (obj instanceof Schema_1.Schema) {\n            var schema = obj['_schema'];\n            for (var field in schema) {\n                // ensure ArraySchema and MapSchema already initialized\n                // on its structure have a valid parent.\n                if ((obj[field] instanceof Schema_1.Schema ||\n                    obj[field] instanceof ArraySchema_1.ArraySchema ||\n                    obj[field] instanceof MapSchema_1.MapSchema) &&\n                    !obj[field].$changes.parent.parent) {\n                    obj[field].$changes.parent = this;\n                }\n                if (obj[field] !== undefined) {\n                    this.change(field);\n                }\n            }\n        }\n        else {\n            var keys = Object.keys(obj);\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n                var key = keys_1[_i];\n                if (obj[key] !== undefined) {\n                    this.change(key);\n                }\n            }\n        }\n    };\n    ChangeTree.prototype.discard = function () {\n        this.changed = false;\n        this.changes.clear();\n        this.deletedKeys = {};\n        if (this.indexChange) {\n            this.indexChange.clear();\n        }\n    };\n    ChangeTree.prototype.clone = function () {\n        return new ChangeTree(this.fieldIndexes, this.parentField, undefined);\n    };\n    return ChangeTree;\n}());\nexports.ChangeTree = ChangeTree;\n//# sourceMappingURL=ChangeTree.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.defineTypes = exports.deprecated = exports.filter = exports.type = exports.globalContext = exports.Context = void 0;\nvar ChangeTree_1 = require(\"./ChangeTree\");\nvar Schema_1 = require(\"./Schema\");\nvar Context = /** @class */ (function () {\n    function Context() {\n        this.types = {};\n        this.schemas = new Map();\n    }\n    Context.prototype.has = function (schema) {\n        return this.schemas.has(schema);\n    };\n    Context.prototype.get = function (typeid) {\n        return this.types[typeid];\n    };\n    Context.prototype.add = function (schema) {\n        schema._typeid = this.schemas.size;\n        this.types[schema._typeid] = schema;\n        this.schemas.set(schema, schema._typeid);\n    };\n    return Context;\n}());\nexports.Context = Context;\nexports.globalContext = new Context();\n/**\n * `@type()` decorator for proxies\n */\nfunction type(type, context) {\n    if (context === void 0) { context = exports.globalContext; }\n    return function (target, field) {\n        var constructor = target.constructor;\n        constructor._context = context;\n        /*\n         * static schema\n         */\n        if (!context.has(constructor)) {\n            context.add(constructor);\n            // support inheritance\n            constructor._schema = Object.assign({}, constructor._schema || {});\n            constructor._indexes = Object.assign({}, constructor._indexes || {});\n            constructor._fieldsByIndex = Object.assign({}, constructor._fieldsByIndex || {});\n            constructor._descriptors = Object.assign({}, constructor._descriptors || {});\n            constructor._deprecated = Object.assign({}, constructor._deprecated || {});\n        }\n        var index = Object.keys(constructor._schema).length;\n        constructor._fieldsByIndex[index] = field;\n        constructor._indexes[field] = index;\n        constructor._schema[field] = type;\n        /**\n         * skip if descriptor already exists for this field (`@deprecated()`)\n         */\n        if (constructor._descriptors[field]) {\n            return;\n        }\n        /**\n         * TODO: `isSchema` / `isArray` / `isMap` is repeated on many places!\n         * need to refactor all of them.\n         */\n        var isArray = Array.isArray(type);\n        var isMap = !isArray && type.map;\n        var isSchema = (typeof (constructor._schema[field]) === \"function\");\n        var fieldCached = \"_\" + field;\n        constructor._descriptors[fieldCached] = {\n            enumerable: false,\n            configurable: false,\n            writable: true,\n        };\n        constructor._descriptors[field] = {\n            get: function () {\n                return this[fieldCached];\n            },\n            set: function (value) {\n                /**\n                 * Create Proxy for array or map items\n                 */\n                if (isArray || isMap) {\n                    value = new Proxy(value, {\n                        get: function (obj, prop) { return obj[prop]; },\n                        set: function (obj, prop, setValue) {\n                            if (prop !== \"length\" && prop.indexOf(\"$\") !== 0) {\n                                // ensure new value has a parent\n                                var key = (isArray) ? Number(prop) : String(prop);\n                                if (!obj.$sorting) {\n                                    // track index change\n                                    var previousIndex = obj.$changes.getIndex(setValue);\n                                    if (previousIndex !== undefined) {\n                                        obj.$changes.mapIndexChange(setValue, previousIndex);\n                                    }\n                                    obj.$changes.mapIndex(setValue, key);\n                                }\n                                // if (isMap) {\n                                //     obj._indexes.delete(prop);\n                                // }\n                                if (setValue instanceof Schema_1.Schema) {\n                                    // new items are flagged with all changes\n                                    if (!setValue.$changes.parent) {\n                                        setValue.$changes = new ChangeTree_1.ChangeTree(setValue._indexes, key, obj.$changes);\n                                        setValue.$changes.changeAll(setValue);\n                                    }\n                                }\n                                else {\n                                    obj[prop] = setValue;\n                                }\n                                // apply change on ArraySchema / MapSchema\n                                obj.$changes.change(key);\n                            }\n                            else if (setValue !== obj[prop]) {\n                                // console.log(\"SET NEW LENGTH:\", setValue);\n                                // console.log(\"PREVIOUS LENGTH: \", obj[prop]);\n                            }\n                            obj[prop] = setValue;\n                            return true;\n                        },\n                        deleteProperty: function (obj, prop) {\n                            var deletedValue = obj[prop];\n                            if (isMap && deletedValue !== undefined) {\n                                obj.$changes.deleteIndex(deletedValue);\n                                obj.$changes.deleteIndexChange(deletedValue);\n                                if (deletedValue.$changes) { // deletedValue may be a primitive value\n                                    delete deletedValue.$changes.parent;\n                                }\n                                // obj._indexes.delete(prop);\n                            }\n                            delete obj[prop];\n                            var key = (isArray) ? Number(prop) : String(prop);\n                            obj.$changes.change(key, true);\n                            return true;\n                        },\n                    });\n                }\n                // skip if value is the same as cached.\n                if (value === this[fieldCached]) {\n                    return;\n                }\n                this[fieldCached] = value;\n                if (isArray) {\n                    // directly assigning an array of items as value.\n                    this.$changes.change(field);\n                    value.$changes = new ChangeTree_1.ChangeTree({}, field, this.$changes);\n                    for (var i = 0; i < value.length; i++) {\n                        if (value[i] instanceof Schema_1.Schema) {\n                            value[i].$changes = new ChangeTree_1.ChangeTree(value[i]._indexes, i, value.$changes);\n                            value[i].$changes.changeAll(value[i]);\n                        }\n                        value.$changes.mapIndex(value[i], i);\n                        value.$changes.change(i);\n                    }\n                }\n                else if (isMap) {\n                    // directly assigning a map\n                    value.$changes = new ChangeTree_1.ChangeTree({}, field, this.$changes);\n                    this.$changes.change(field);\n                    for (var key in value) {\n                        if (value[key] instanceof Schema_1.Schema) {\n                            value[key].$changes = new ChangeTree_1.ChangeTree(value[key]._indexes, key, value.$changes);\n                            value[key].$changes.changeAll(value[key]);\n                        }\n                        value.$changes.mapIndex(value[key], key);\n                        value.$changes.change(key);\n                    }\n                }\n                else if (isSchema) {\n                    // directly assigning a `Schema` object\n                    // value may be set to null\n                    this.$changes.change(field);\n                    if (value) {\n                        value.$changes = new ChangeTree_1.ChangeTree(value._indexes, field, this.$changes);\n                        value.$changes.changeAll(value);\n                    }\n                }\n                else {\n                    // directly assigning a primitive type\n                    this.$changes.change(field);\n                }\n            },\n            enumerable: true,\n            configurable: true\n        };\n    };\n}\nexports.type = type;\n/**\n * `@filter()` decorator for defining data filters per client\n */\nfunction filter(cb) {\n    return function (target, field) {\n        var constructor = target.constructor;\n        /*\n         * static filters\n         */\n        if (!constructor._filters) {\n            constructor._filters = {};\n        }\n        constructor._filters[field] = cb;\n    };\n}\nexports.filter = filter;\n/**\n * `@deprecated()` flag a field as deprecated.\n * The previous `@type()` annotation should remain along with this one.\n */\nfunction deprecated(throws, context) {\n    if (throws === void 0) { throws = true; }\n    if (context === void 0) { context = exports.globalContext; }\n    return function (target, field) {\n        var constructor = target.constructor;\n        constructor._deprecated[field] = true;\n        if (throws) {\n            constructor._descriptors[field] = {\n                get: function () { throw new Error(field + \" is deprecated.\"); },\n                set: function (value) { },\n                enumerable: false,\n                configurable: true\n            };\n        }\n    };\n}\nexports.deprecated = deprecated;\nfunction defineTypes(target, fields, context) {\n    if (context === void 0) { context = exports.globalContext; }\n    for (var field in fields) {\n        type(fields[field], context)(target.prototype, field);\n    }\n    return target;\n}\nexports.defineTypes = defineTypes;\n//# sourceMappingURL=annotations.js.map","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","const { EventEmitter } = require('events');\nconst Logger = require('./Logger');\n\nclass EnhancedEventEmitter extends EventEmitter\n{\n\tconstructor(logger)\n\t{\n\t\tsuper();\n\t\tthis.setMaxListeners(Infinity);\n\n\t\tthis._logger = logger || new Logger('EnhancedEventEmitter');\n\t}\n\n\tsafeEmit(event, ...args)\n\t{\n\t\ttry\n\t\t{\n\t\t\tthis.emit(event, ...args);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis._logger.error(\n\t\t\t\t'safeEmit() | event listener threw an error [event:%s]:%o',\n\t\t\t\tevent, error);\n\t\t}\n\t}\n\n\tasync safeEmitAsPromise(event, ...args)\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tthis.safeEmit(event, ...args, resolve, reject);\n\t\t});\n\t}\n}\n\nmodule.exports = EnhancedEventEmitter;\n","const Logger = require('./Logger');\nconst { generateRandomNumber } = require('./utils');\n\nconst logger = new Logger('Message');\n\nclass Message\n{\n\tstatic parse(raw)\n\t{\n\t\tlet object;\n\t\tconst message = {};\n\n\t\ttry\n\t\t{\n\t\t\tobject = JSON.parse(raw);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tlogger.error('parse() | invalid JSON: %s', error);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof object !== 'object' || Array.isArray(object))\n\t\t{\n\t\t\tlogger.error('parse() | not an object');\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Request.\n\t\tif (object.request)\n\t\t{\n\t\t\tmessage.request = true;\n\n\t\t\tif (typeof object.method !== 'string')\n\t\t\t{\n\t\t\t\tlogger.error('parse() | missing/invalid method field');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (typeof object.id !== 'number')\n\t\t\t{\n\t\t\t\tlogger.error('parse() | missing/invalid id field');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmessage.id = object.id;\n\t\t\tmessage.method = object.method;\n\t\t\tmessage.data = object.data || {};\n\t\t}\n\t\t// Response.\n\t\telse if (object.response)\n\t\t{\n\t\t\tmessage.response = true;\n\n\t\t\tif (typeof object.id !== 'number')\n\t\t\t{\n\t\t\t\tlogger.error('parse() | missing/invalid id field');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmessage.id = object.id;\n\n\t\t\t// Success.\n\t\t\tif (object.ok)\n\t\t\t{\n\t\t\t\tmessage.ok = true;\n\t\t\t\tmessage.data = object.data || {};\n\t\t\t}\n\t\t\t// Error.\n\t\t\telse\n\t\t\t{\n\t\t\t\tmessage.ok = false;\n\t\t\t\tmessage.errorCode = object.errorCode;\n\t\t\t\tmessage.errorReason = object.errorReason;\n\t\t\t}\n\t\t}\n\t\t// Notification.\n\t\telse if (object.notification)\n\t\t{\n\t\t\tmessage.notification = true;\n\n\t\t\tif (typeof object.method !== 'string')\n\t\t\t{\n\t\t\t\tlogger.error('parse() | missing/invalid method field');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmessage.method = object.method;\n\t\t\tmessage.data = object.data || {};\n\t\t}\n\t\t// Invalid.\n\t\telse\n\t\t{\n\t\t\tlogger.error('parse() | missing request/response field');\n\n\t\t\treturn;\n\t\t}\n\n\t\treturn message;\n\t}\n\n\tstatic createRequest(method, data)\n\t{\n\t\tconst request =\n\t\t{\n\t\t\trequest : true,\n\t\t\tid      : generateRandomNumber(),\n\t\t\tmethod  : method,\n\t\t\tdata    : data || {}\n\t\t};\n\n\t\treturn request;\n\t}\n\n\tstatic createSuccessResponse(request, data)\n\t{\n\t\tconst response =\n\t\t{\n\t\t\tresponse : true,\n\t\t\tid       : request.id,\n\t\t\tok       : true,\n\t\t\tdata     : data || {}\n\t\t};\n\n\t\treturn response;\n\t}\n\n\tstatic createErrorResponse(request, errorCode, errorReason)\n\t{\n\t\tconst response =\n\t\t{\n\t\t\tresponse    : true,\n\t\t\tid          : request.id,\n\t\t\tok          : false,\n\t\t\terrorCode   : errorCode,\n\t\t\terrorReason : errorReason\n\t\t};\n\n\t\treturn response;\n\t}\n\n\tstatic createNotification(method, data)\n\t{\n\t\tconst notification =\n\t\t{\n\t\t\tnotification : true,\n\t\t\tmethod       : method,\n\t\t\tdata         : data || {}\n\t\t};\n\n\t\treturn notification;\n\t}\n}\n\nmodule.exports = Message;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RemoteStream = exports.LocalStream = exports.Stream = exports.VideoResolutions = void 0;\nconst log = require(\"loglevel\");\nconst transport_1 = require(\"./transport\");\nexports.VideoResolutions = {\n    qvga: { width: { ideal: 320 }, height: { ideal: 180 } },\n    vga: { width: { ideal: 640 }, height: { ideal: 360 } },\n    shd: { width: { ideal: 960 }, height: { ideal: 540 } },\n    hd: { width: { ideal: 1280 }, height: { ideal: 720 } },\n    fhd: { width: { ideal: 1920 }, height: { ideal: 1090 } },\n};\nclass Stream extends MediaStream {\n    static setDispatch(dispatch) {\n        Stream.dispatch = dispatch;\n    }\n    get dispatch() {\n        if (!Stream.dispatch) {\n            throw new Error('Dispatch not set.');\n        }\n        return Stream.dispatch;\n    }\n}\nexports.Stream = Stream;\nclass LocalStream extends Stream {\n    constructor(stream, options) {\n        super(stream);\n        // hack: patch for Safari\n        Object.setPrototypeOf(this, LocalStream.prototype);\n        this.options = options;\n    }\n    static getUserMedia(options = {\n        codec: 'VP8',\n        resolution: 'hd',\n        audio: false,\n        video: false,\n    }) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const stream = yield navigator.mediaDevices.getUserMedia({\n                    audio: options.audio,\n                    video: options.video instanceof Object\n                        ? Object.assign(Object.assign({}, exports.VideoResolutions[options.resolution]), options.video) : options.video\n                        ? exports.VideoResolutions[options.resolution]\n                        : false,\n                });\n                return new LocalStream(stream, options);\n            }\n            catch (e) {\n                return null;\n            }\n        });\n    }\n    static getDisplayMedia(options = {\n        codec: 'VP8',\n        resolution: 'hd',\n        audio: false,\n        video: true,\n    }) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // @ts-ignore\n            const stream = yield navigator.mediaDevices.getDisplayMedia({\n                video: true,\n            });\n            return new LocalStream(stream, options);\n        });\n    }\n    getVideoConstraints() {\n        return this.options.video instanceof Object\n            ? Object.assign(Object.assign({}, exports.VideoResolutions[this.options.resolution]), this.options.video) : { video: this.options.video };\n    }\n    switchDevice(kind, deviceId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.options = Object.assign(Object.assign({}, this.options), { [kind]: this.options[kind] instanceof Object\n                    ? Object.assign(Object.assign({}, this.options[kind]), { deviceId }) : { deviceId } });\n            const stream = yield navigator.mediaDevices.getUserMedia({\n                [kind]: kind === 'video' ? Object.assign(Object.assign({}, this.getVideoConstraints()), { deviceId }) : { deviceId },\n            });\n            const track = stream.getTracks()[0];\n            let prev;\n            if (kind === 'audio') {\n                prev = this.getAudioTracks()[0];\n            }\n            else if (kind === 'video') {\n                prev = this.getVideoTracks()[0];\n            }\n            this.addTrack(track);\n            this.removeTrack(prev);\n            prev.stop();\n            // If published, replace published track with track from new device\n            if (this.transport) {\n                this.transport.getSenders().forEach((sender) => __awaiter(this, void 0, void 0, function* () {\n                    var _a, _b;\n                    if (((_a = sender === null || sender === void 0 ? void 0 : sender.track) === null || _a === void 0 ? void 0 : _a.kind) === track.kind) {\n                        (_b = sender.track) === null || _b === void 0 ? void 0 : _b.stop();\n                        sender.replaceTrack(track);\n                    }\n                }));\n            }\n        });\n    }\n    mute(kind) {\n        if (kind === 'audio') {\n            this.getAudioTracks()[0].enabled = false;\n        }\n        else if (kind === 'video') {\n            this.getVideoTracks()[0].enabled = false;\n        }\n    }\n    unmute(kind) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (kind === 'audio') {\n                this.getAudioTracks()[0].enabled = true;\n            }\n            else if (kind === 'video') {\n                this.getVideoTracks()[0].enabled = true;\n            }\n        });\n    }\n    publish(rid) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { bandwidth, codec } = this.options;\n            let sendOffer = true;\n            this.transport = new transport_1.default(codec);\n            this.getTracks().map((track) => this.transport.addTrack(track, this));\n            const offer = yield this.transport.createOffer({\n                offerToReceiveVideo: false,\n                offerToReceiveAudio: false,\n            });\n            log.debug('Created offer => %o', offer);\n            this.transport.setLocalDescription(offer);\n            this.transport.onicecandidate = () => __awaiter(this, void 0, void 0, function* () {\n                if (sendOffer) {\n                    sendOffer = false;\n                    const jsep = this.transport.localDescription;\n                    log.debug(`Sending offer ${jsep}`);\n                    const result = yield this.dispatch.request('publish', {\n                        rid,\n                        jsep,\n                        options: {\n                            codec,\n                            bandwidth: Number(bandwidth),\n                        },\n                    });\n                    this.mid = result.mid;\n                    log.debug('Got answer => %o', result === null || result === void 0 ? void 0 : result.jsep);\n                    yield this.transport.setRemoteDescription(result === null || result === void 0 ? void 0 : result.jsep);\n                    this.rid = rid;\n                }\n            });\n            this.transport.onnegotiationneeded = () => __awaiter(this, void 0, void 0, function* () {\n                log.info('negotiation needed');\n            });\n        });\n    }\n    unpublish() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.rid || !this.mid) {\n                throw new Error('Stream is not published.');\n            }\n            log.info('unpublish rid => %s, mid => %s', this.rid, this.mid);\n            if (this.transport) {\n                this.transport.close();\n                delete this.transport;\n            }\n            return yield this.dispatch\n                .request('unpublish', {\n                rid: this.rid,\n                mid: this.mid,\n            })\n                .then(() => {\n                delete this.rid;\n                delete this.mid;\n            });\n        });\n    }\n}\nexports.LocalStream = LocalStream;\nclass RemoteStream extends Stream {\n    static getRemoteMedia(rid, mid, tracks) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const allTracks = Array.from(tracks.values()).flat();\n            const audio = allTracks.map((t) => t.type.toLowerCase() === 'audio').includes(true);\n            const video = allTracks.map((t) => t.type.toLowerCase() === 'video').includes(true);\n            let sendOffer = true;\n            log.debug('Creating receiver => %s', mid);\n            const transport = new transport_1.default();\n            if (audio) {\n                transport.addTransceiver('audio');\n            }\n            if (video) {\n                transport.addTransceiver('video');\n            }\n            const desc = yield transport.createOffer();\n            log.debug('Created offer => %o', desc);\n            transport.setLocalDescription(desc);\n            transport.onnegotiationneeded = () => {\n                log.debug('negotiation needed');\n            };\n            transport.onicecandidate = (e) => __awaiter(this, void 0, void 0, function* () {\n                if (sendOffer) {\n                    log.debug('Send offer');\n                    sendOffer = false;\n                    const jsep = transport.localDescription;\n                    const result = yield this.dispatch.request('subscribe', {\n                        rid,\n                        jsep,\n                        mid,\n                    });\n                    log.info(`subscribe success => result(mid: ${result.mid})`);\n                    log.debug('Got answer => %o', result === null || result === void 0 ? void 0 : result.jsep);\n                    yield transport.setRemoteDescription(result === null || result === void 0 ? void 0 : result.jsep);\n                }\n            });\n            const stream = yield new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\n                try {\n                    transport.ontrack = ({ track, streams }) => {\n                        log.debug('on track called');\n                        // once media for a remote track arrives, show it in the remote video element\n                        track.onunmute = () => {\n                            if (streams.length > 0) {\n                                resolve(streams[0]);\n                            }\n                            else {\n                                reject(new Error('Not enough streams'));\n                            }\n                        };\n                    };\n                }\n                catch (error) {\n                    log.error('subscribe request error  => ' + error);\n                    reject(error);\n                }\n            }));\n            const remote = new RemoteStream(stream);\n            remote.transport = transport;\n            remote.mid = mid;\n            remote.rid = rid;\n            return remote;\n        });\n    }\n    constructor(stream) {\n        super(stream);\n        // hack: patch for Safari\n        Object.setPrototypeOf(this, RemoteStream.prototype);\n    }\n    close() {\n        if (!this.transport) {\n            throw new Error('Stream is not open.');\n        }\n        if (this.transport) {\n            this.transport.close();\n            delete this.transport;\n        }\n    }\n    unsubscribe() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.transport) {\n                throw new Error('Stream is not subscribed.');\n            }\n            log.info('unsubscribe mid => %s', this.mid);\n            this.close();\n            return yield this.dispatch.request('unsubscribe', { mid: this.mid });\n        });\n    }\n}\nexports.RemoteStream = RemoteStream;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst sdp_transform_1 = require(\"sdp-transform\");\nconst log = require(\"loglevel\");\nvar PayloadType;\n(function (PayloadType) {\n    PayloadType[PayloadType[\"PCMU\"] = 0] = \"PCMU\";\n    PayloadType[PayloadType[\"PCMA\"] = 8] = \"PCMA\";\n    PayloadType[PayloadType[\"G722\"] = 9] = \"G722\";\n    PayloadType[PayloadType[\"Opus\"] = 111] = \"Opus\";\n    PayloadType[PayloadType[\"VP8\"] = 96] = \"VP8\";\n    PayloadType[PayloadType[\"VP9\"] = 98] = \"VP9\";\n    PayloadType[PayloadType[\"H264\"] = 102] = \"H264\";\n})(PayloadType || (PayloadType = {}));\nfunction rtp(name) {\n    switch (name) {\n        case 'H264':\n            return [\n                {\n                    payload: PayloadType.H264,\n                    codec: 'H264',\n                    rate: 90000,\n                },\n            ];\n        case 'VP8':\n            return [\n                {\n                    payload: PayloadType.VP8,\n                    codec: 'VP8',\n                    rate: 90000,\n                },\n            ];\n        case 'VP9':\n            return [\n                {\n                    payload: PayloadType.VP9,\n                    codec: 'VP9',\n                    rate: 90000,\n                },\n            ];\n        default:\n            return [];\n    }\n}\nlet WebRTCTransport = /** @class */ (() => {\n    class WebRTCTransport {\n        constructor(codec) {\n            if (!WebRTCTransport.config) {\n                throw new Error('RTConfiguration not set.');\n            }\n            this.pc = new RTCPeerConnection(WebRTCTransport.config);\n            this.rtp = codec ? rtp(codec) : null;\n        }\n        static setRTCConfiguration(config) {\n            WebRTCTransport.config = config;\n        }\n        close() {\n            this.pc.ontrack = null;\n            this.pc.onicecandidate = null;\n            this.pc.onnegotiationneeded = null;\n            this.pc.getSenders().forEach((sender) => this.pc.removeTrack(sender));\n            this.pc.close();\n        }\n        addTrack(track, stream) {\n            return this.pc.addTrack(track, stream);\n        }\n        addTransceiver(kind) {\n            this.pc.addTransceiver(kind, { direction: 'recvonly' });\n        }\n        removeTrack(sender) {\n            this.pc.removeTrack(sender);\n        }\n        getSenders() {\n            return this.pc.getSenders();\n        }\n        setLocalDescription(offer) {\n            this.pc.setLocalDescription(offer);\n        }\n        setRemoteDescription(desc) {\n            return this.pc.setRemoteDescription(desc);\n        }\n        createOffer(options) {\n            return __awaiter(this, void 0, void 0, function* () {\n                const offer = yield this.pc.createOffer(options);\n                if (!this.rtp)\n                    return offer;\n                const session = sdp_transform_1.parse(offer.sdp);\n                const videoIdx = session.media.findIndex(({ type, ssrcGroups }) => type === 'video' && !!ssrcGroups);\n                if (videoIdx === -1)\n                    return offer;\n                const { payload } = this.rtp[0];\n                session.media[videoIdx].payloads = `${payload}`; // + \" 97\";\n                session.media[videoIdx].rtp = this.rtp;\n                const fmtp = [\n                // { \"payload\": 97, \"config\": \"apt=\" + payload }\n                ];\n                session.media[videoIdx].fmtp = fmtp;\n                const rtcpFB = [\n                    { payload, type: 'transport-cc', subtype: undefined },\n                    { payload, type: 'ccm', subtype: 'fir' },\n                    { payload, type: 'nack', subtype: undefined },\n                    { payload, type: 'nack', subtype: 'pli' },\n                ];\n                session.media[videoIdx].rtcpFb = rtcpFB;\n                const ssrcGroup = session.media[videoIdx].ssrcGroups[0];\n                const ssrcs = ssrcGroup.ssrcs;\n                const ssrc = parseInt(ssrcs.split(' ')[0], 10);\n                log.debug('ssrcs => %s, video %s', ssrcs, ssrc);\n                session.media[videoIdx].ssrcGroups = [];\n                session.media[videoIdx].ssrcs = session.media[videoIdx].ssrcs.filter((item) => item.id === ssrc);\n                offer.sdp = sdp_transform_1.write(session);\n                return offer;\n            });\n        }\n        get localDescription() {\n            return this.pc.localDescription;\n        }\n        set onicecandidate(cb) {\n            this.pc.onicecandidate = cb;\n        }\n        set onnegotiationneeded(cb) {\n            this.pc.onnegotiationneeded = cb;\n        }\n        set ontrack(cb) {\n            this.pc.ontrack = cb;\n        }\n    }\n    WebRTCTransport.config = {\n        iceServers: [{ urls: 'stun:stun.stunprotocol.org:3478' }],\n    };\n    return WebRTCTransport;\n})();\nexports.default = WebRTCTransport;\n","var grammar = module.exports = {\n  v: [{\n    name: 'version',\n    reg: /^(\\d*)$/\n  }],\n  o: [{\n    // o=- 20518 0 IN IP4 203.0.113.1\n    // NB: sessionId will be a String in most cases because it is huge\n    name: 'origin',\n    reg: /^(\\S*) (\\d*) (\\d*) (\\S*) IP(\\d) (\\S*)/,\n    names: ['username', 'sessionId', 'sessionVersion', 'netType', 'ipVer', 'address'],\n    format: '%s %s %d %s IP%d %s'\n  }],\n  // default parsing of these only (though some of these feel outdated)\n  s: [{ name: 'name' }],\n  i: [{ name: 'description' }],\n  u: [{ name: 'uri' }],\n  e: [{ name: 'email' }],\n  p: [{ name: 'phone' }],\n  z: [{ name: 'timezones' }], // TODO: this one can actually be parsed properly...\n  r: [{ name: 'repeats' }],   // TODO: this one can also be parsed properly\n  // k: [{}], // outdated thing ignored\n  t: [{\n    // t=0 0\n    name: 'timing',\n    reg: /^(\\d*) (\\d*)/,\n    names: ['start', 'stop'],\n    format: '%d %d'\n  }],\n  c: [{\n    // c=IN IP4 10.47.197.26\n    name: 'connection',\n    reg: /^IN IP(\\d) (\\S*)/,\n    names: ['version', 'ip'],\n    format: 'IN IP%d %s'\n  }],\n  b: [{\n    // b=AS:4000\n    push: 'bandwidth',\n    reg: /^(TIAS|AS|CT|RR|RS):(\\d*)/,\n    names: ['type', 'limit'],\n    format: '%s:%s'\n  }],\n  m: [{\n    // m=video 51744 RTP/AVP 126 97 98 34 31\n    // NB: special - pushes to session\n    // TODO: rtp/fmtp should be filtered by the payloads found here?\n    reg: /^(\\w*) (\\d*) ([\\w/]*)(?: (.*))?/,\n    names: ['type', 'port', 'protocol', 'payloads'],\n    format: '%s %d %s %s'\n  }],\n  a: [\n    {\n      // a=rtpmap:110 opus/48000/2\n      push: 'rtp',\n      reg: /^rtpmap:(\\d*) ([\\w\\-.]*)(?:\\s*\\/(\\d*)(?:\\s*\\/(\\S*))?)?/,\n      names: ['payload', 'codec', 'rate', 'encoding'],\n      format: function (o) {\n        return (o.encoding)\n          ? 'rtpmap:%d %s/%s/%s'\n          : o.rate\n            ? 'rtpmap:%d %s/%s'\n            : 'rtpmap:%d %s';\n      }\n    },\n    {\n      // a=fmtp:108 profile-level-id=24;object=23;bitrate=64000\n      // a=fmtp:111 minptime=10; useinbandfec=1\n      push: 'fmtp',\n      reg: /^fmtp:(\\d*) ([\\S| ]*)/,\n      names: ['payload', 'config'],\n      format: 'fmtp:%d %s'\n    },\n    {\n      // a=control:streamid=0\n      name: 'control',\n      reg: /^control:(.*)/,\n      format: 'control:%s'\n    },\n    {\n      // a=rtcp:65179 IN IP4 193.84.77.194\n      name: 'rtcp',\n      reg: /^rtcp:(\\d*)(?: (\\S*) IP(\\d) (\\S*))?/,\n      names: ['port', 'netType', 'ipVer', 'address'],\n      format: function (o) {\n        return (o.address != null)\n          ? 'rtcp:%d %s IP%d %s'\n          : 'rtcp:%d';\n      }\n    },\n    {\n      // a=rtcp-fb:98 trr-int 100\n      push: 'rtcpFbTrrInt',\n      reg: /^rtcp-fb:(\\*|\\d*) trr-int (\\d*)/,\n      names: ['payload', 'value'],\n      format: 'rtcp-fb:%d trr-int %d'\n    },\n    {\n      // a=rtcp-fb:98 nack rpsi\n      push: 'rtcpFb',\n      reg: /^rtcp-fb:(\\*|\\d*) ([\\w-_]*)(?: ([\\w-_]*))?/,\n      names: ['payload', 'type', 'subtype'],\n      format: function (o) {\n        return (o.subtype != null)\n          ? 'rtcp-fb:%s %s %s'\n          : 'rtcp-fb:%s %s';\n      }\n    },\n    {\n      // a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n      // a=extmap:1/recvonly URI-gps-string\n      // a=extmap:3 urn:ietf:params:rtp-hdrext:encrypt urn:ietf:params:rtp-hdrext:smpte-tc 25@600/24\n      push: 'ext',\n      reg: /^extmap:(\\d+)(?:\\/(\\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\\S*)(?: (\\S*))?/,\n      names: ['value', 'direction', 'encrypt-uri', 'uri', 'config'],\n      format: function (o) {\n        return (\n          'extmap:%d' +\n          (o.direction ? '/%s' : '%v') +\n          (o['encrypt-uri'] ? ' %s' : '%v') +\n          ' %s' +\n          (o.config ? ' %s' : '')\n        );\n      }\n    },\n    {\n      // a=extmap-allow-mixed\n      name: 'extmapAllowMixed',\n      reg: /^(extmap-allow-mixed)/\n    },\n    {\n      // a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32\n      push: 'crypto',\n      reg: /^crypto:(\\d*) ([\\w_]*) (\\S*)(?: (\\S*))?/,\n      names: ['id', 'suite', 'config', 'sessionConfig'],\n      format: function (o) {\n        return (o.sessionConfig != null)\n          ? 'crypto:%d %s %s %s'\n          : 'crypto:%d %s %s';\n      }\n    },\n    {\n      // a=setup:actpass\n      name: 'setup',\n      reg: /^setup:(\\w*)/,\n      format: 'setup:%s'\n    },\n    {\n      // a=connection:new\n      name: 'connectionType',\n      reg: /^connection:(new|existing)/,\n      format: 'connection:%s'\n    },\n    {\n      // a=mid:1\n      name: 'mid',\n      reg: /^mid:([^\\s]*)/,\n      format: 'mid:%s'\n    },\n    {\n      // a=msid:0c8b064d-d807-43b4-b434-f92a889d8587 98178685-d409-46e0-8e16-7ef0db0db64a\n      name: 'msid',\n      reg: /^msid:(.*)/,\n      format: 'msid:%s'\n    },\n    {\n      // a=ptime:20\n      name: 'ptime',\n      reg: /^ptime:(\\d*(?:\\.\\d*)*)/,\n      format: 'ptime:%d'\n    },\n    {\n      // a=maxptime:60\n      name: 'maxptime',\n      reg: /^maxptime:(\\d*(?:\\.\\d*)*)/,\n      format: 'maxptime:%d'\n    },\n    {\n      // a=sendrecv\n      name: 'direction',\n      reg: /^(sendrecv|recvonly|sendonly|inactive)/\n    },\n    {\n      // a=ice-lite\n      name: 'icelite',\n      reg: /^(ice-lite)/\n    },\n    {\n      // a=ice-ufrag:F7gI\n      name: 'iceUfrag',\n      reg: /^ice-ufrag:(\\S*)/,\n      format: 'ice-ufrag:%s'\n    },\n    {\n      // a=ice-pwd:x9cml/YzichV2+XlhiMu8g\n      name: 'icePwd',\n      reg: /^ice-pwd:(\\S*)/,\n      format: 'ice-pwd:%s'\n    },\n    {\n      // a=fingerprint:SHA-1 00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33\n      name: 'fingerprint',\n      reg: /^fingerprint:(\\S*) (\\S*)/,\n      names: ['type', 'hash'],\n      format: 'fingerprint:%s %s'\n    },\n    {\n      // a=candidate:0 1 UDP 2113667327 203.0.113.1 54400 typ host\n      // a=candidate:1162875081 1 udp 2113937151 192.168.34.75 60017 typ host generation 0 network-id 3 network-cost 10\n      // a=candidate:3289912957 2 udp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 generation 0 network-id 3 network-cost 10\n      // a=candidate:229815620 1 tcp 1518280447 192.168.150.19 60017 typ host tcptype active generation 0 network-id 3 network-cost 10\n      // a=candidate:3289912957 2 tcp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 tcptype passive generation 0 network-id 3 network-cost 10\n      push:'candidates',\n      reg: /^candidate:(\\S*) (\\d*) (\\S*) (\\d*) (\\S*) (\\d*) typ (\\S*)(?: raddr (\\S*) rport (\\d*))?(?: tcptype (\\S*))?(?: generation (\\d*))?(?: network-id (\\d*))?(?: network-cost (\\d*))?/,\n      names: ['foundation', 'component', 'transport', 'priority', 'ip', 'port', 'type', 'raddr', 'rport', 'tcptype', 'generation', 'network-id', 'network-cost'],\n      format: function (o) {\n        var str = 'candidate:%s %d %s %d %s %d typ %s';\n\n        str += (o.raddr != null) ? ' raddr %s rport %d' : '%v%v';\n\n        // NB: candidate has three optional chunks, so %void middles one if it's missing\n        str += (o.tcptype != null) ? ' tcptype %s' : '%v';\n\n        if (o.generation != null) {\n          str += ' generation %d';\n        }\n\n        str += (o['network-id'] != null) ? ' network-id %d' : '%v';\n        str += (o['network-cost'] != null) ? ' network-cost %d' : '%v';\n        return str;\n      }\n    },\n    {\n      // a=end-of-candidates (keep after the candidates line for readability)\n      name: 'endOfCandidates',\n      reg: /^(end-of-candidates)/\n    },\n    {\n      // a=remote-candidates:1 203.0.113.1 54400 2 203.0.113.1 54401 ...\n      name: 'remoteCandidates',\n      reg: /^remote-candidates:(.*)/,\n      format: 'remote-candidates:%s'\n    },\n    {\n      // a=ice-options:google-ice\n      name: 'iceOptions',\n      reg: /^ice-options:(\\S*)/,\n      format: 'ice-options:%s'\n    },\n    {\n      // a=ssrc:2566107569 cname:t9YU8M1UxTF8Y1A1\n      push: 'ssrcs',\n      reg: /^ssrc:(\\d*) ([\\w_-]*)(?::(.*))?/,\n      names: ['id', 'attribute', 'value'],\n      format: function (o) {\n        var str = 'ssrc:%d';\n        if (o.attribute != null) {\n          str += ' %s';\n          if (o.value != null) {\n            str += ':%s';\n          }\n        }\n        return str;\n      }\n    },\n    {\n      // a=ssrc-group:FEC 1 2\n      // a=ssrc-group:FEC-FR 3004364195 1080772241\n      push: 'ssrcGroups',\n      // token-char = %x21 / %x23-27 / %x2A-2B / %x2D-2E / %x30-39 / %x41-5A / %x5E-7E\n      reg: /^ssrc-group:([\\x21\\x23\\x24\\x25\\x26\\x27\\x2A\\x2B\\x2D\\x2E\\w]*) (.*)/,\n      names: ['semantics', 'ssrcs'],\n      format: 'ssrc-group:%s %s'\n    },\n    {\n      // a=msid-semantic: WMS Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV\n      name: 'msidSemantic',\n      reg: /^msid-semantic:\\s?(\\w*) (\\S*)/,\n      names: ['semantic', 'token'],\n      format: 'msid-semantic: %s %s' // space after ':' is not accidental\n    },\n    {\n      // a=group:BUNDLE audio video\n      push: 'groups',\n      reg: /^group:(\\w*) (.*)/,\n      names: ['type', 'mids'],\n      format: 'group:%s %s'\n    },\n    {\n      // a=rtcp-mux\n      name: 'rtcpMux',\n      reg: /^(rtcp-mux)/\n    },\n    {\n      // a=rtcp-rsize\n      name: 'rtcpRsize',\n      reg: /^(rtcp-rsize)/\n    },\n    {\n      // a=sctpmap:5000 webrtc-datachannel 1024\n      name: 'sctpmap',\n      reg: /^sctpmap:([\\w_/]*) (\\S*)(?: (\\S*))?/,\n      names: ['sctpmapNumber', 'app', 'maxMessageSize'],\n      format: function (o) {\n        return (o.maxMessageSize != null)\n          ? 'sctpmap:%s %s %s'\n          : 'sctpmap:%s %s';\n      }\n    },\n    {\n      // a=x-google-flag:conference\n      name: 'xGoogleFlag',\n      reg: /^x-google-flag:([^\\s]*)/,\n      format: 'x-google-flag:%s'\n    },\n    {\n      // a=rid:1 send max-width=1280;max-height=720;max-fps=30;depend=0\n      push: 'rids',\n      reg: /^rid:([\\d\\w]+) (\\w+)(?: ([\\S| ]*))?/,\n      names: ['id', 'direction', 'params'],\n      format: function (o) {\n        return (o.params) ? 'rid:%s %s %s' : 'rid:%s %s';\n      }\n    },\n    {\n      // a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] recv [x=330,y=250]\n      // a=imageattr:* send [x=800,y=640] recv *\n      // a=imageattr:100 recv [x=320,y=240]\n      push: 'imageattrs',\n      reg: new RegExp(\n        // a=imageattr:97\n        '^imageattr:(\\\\d+|\\\\*)' +\n        // send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320]\n        '[\\\\s\\\\t]+(send|recv)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*)' +\n        // recv [x=330,y=250]\n        '(?:[\\\\s\\\\t]+(recv|send)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*))?'\n      ),\n      names: ['pt', 'dir1', 'attrs1', 'dir2', 'attrs2'],\n      format: function (o) {\n        return 'imageattr:%s %s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    {\n      // a=simulcast:send 1,2,3;~4,~5 recv 6;~7,~8\n      // a=simulcast:recv 1;4,5 send 6;7\n      name: 'simulcast',\n      reg: new RegExp(\n        // a=simulcast:\n        '^simulcast:' +\n        // send 1,2,3;~4,~5\n        '(send|recv) ([a-zA-Z0-9\\\\-_~;,]+)' +\n        // space + recv 6;~7,~8\n        '(?:\\\\s?(send|recv) ([a-zA-Z0-9\\\\-_~;,]+))?' +\n        // end\n        '$'\n      ),\n      names: ['dir1', 'list1', 'dir2', 'list2'],\n      format: function (o) {\n        return 'simulcast:%s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    {\n      // old simulcast draft 03 (implemented by Firefox)\n      //   https://tools.ietf.org/html/draft-ietf-mmusic-sdp-simulcast-03\n      // a=simulcast: recv pt=97;98 send pt=97\n      // a=simulcast: send rid=5;6;7 paused=6,7\n      name: 'simulcast_03',\n      reg: /^simulcast:[\\s\\t]+([\\S+\\s\\t]+)$/,\n      names: ['value'],\n      format: 'simulcast: %s'\n    },\n    {\n      // a=framerate:25\n      // a=framerate:29.97\n      name: 'framerate',\n      reg: /^framerate:(\\d+(?:$|\\.\\d+))/,\n      format: 'framerate:%s'\n    },\n    {\n      // RFC4570\n      // a=source-filter: incl IN IP4 239.5.2.31 10.1.15.5\n      name: 'sourceFilter',\n      reg: /^source-filter: *(excl|incl) (\\S*) (IP4|IP6|\\*) (\\S*) (.*)/,\n      names: ['filterMode', 'netType', 'addressTypes', 'destAddress', 'srcList'],\n      format: 'source-filter: %s %s %s %s %s'\n    },\n    {\n      // a=bundle-only\n      name: 'bundleOnly',\n      reg: /^(bundle-only)/\n    },\n    {\n      // a=label:1\n      name: 'label',\n      reg: /^label:(.+)/,\n      format: 'label:%s'\n    },\n    {\n      // RFC version 26 for SCTP over DTLS\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-5\n      name: 'sctpPort',\n      reg: /^sctp-port:(\\d+)$/,\n      format: 'sctp-port:%s'\n    },\n    {\n      // RFC version 26 for SCTP over DTLS\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-6\n      name: 'maxMessageSize',\n      reg: /^max-message-size:(\\d+)$/,\n      format: 'max-message-size:%s'\n    },\n    {\n      // RFC7273\n      // a=ts-refclk:ptp=IEEE1588-2008:39-A7-94-FF-FE-07-CB-D0:37\n      push:'tsRefClocks',\n      reg: /^ts-refclk:([^\\s=]*)(?:=(\\S*))?/,\n      names: ['clksrc', 'clksrcExt'],\n      format: function (o) {\n        return 'ts-refclk:%s' + (o.clksrcExt != null ? '=%s' : '');\n      }\n    },\n    {\n      // RFC7273\n      // a=mediaclk:direct=963214424\n      name:'mediaClk',\n      reg: /^mediaclk:(?:id=(\\S*))? *([^\\s=]*)(?:=(\\S*))?(?: *rate=(\\d+)\\/(\\d+))?/,\n      names: ['id', 'mediaClockName', 'mediaClockValue', 'rateNumerator', 'rateDenominator'],\n      format: function (o) {\n        var str = 'mediaclk:';\n        str += (o.id != null ? 'id=%s %s' : '%v%s');\n        str += (o.mediaClockValue != null ? '=%s' : '');\n        str += (o.rateNumerator != null ? ' rate=%s' : '');\n        str += (o.rateDenominator != null ? '/%s' : '');\n        return str;\n      }\n    },\n    {\n      // a=keywds:keywords\n      name: 'keywords',\n      reg: /^keywds:(.+)$/,\n      format: 'keywds:%s'\n    },\n    {\n      // a=content:main\n      name: 'content',\n      reg: /^content:(.+)/,\n      format: 'content:%s'\n    },\n    // BFCP https://tools.ietf.org/html/rfc4583\n    {\n      // a=floorctrl:c-s\n      name: 'bfcpFloorCtrl',\n      reg: /^floorctrl:(c-only|s-only|c-s)/,\n      format: 'floorctrl:%s'\n    },\n    {\n      // a=confid:1\n      name: 'bfcpConfId',\n      reg: /^confid:(\\d+)/,\n      format: 'confid:%s'\n    },\n    {\n      // a=userid:1\n      name: 'bfcpUserId',\n      reg: /^userid:(\\d+)/,\n      format: 'userid:%s'\n    },\n    {\n      // a=floorid:1\n      name: 'bfcpFloorId',\n      reg: /^floorid:(.+) (?:m-stream|mstrm):(.+)/,\n      names: ['id', 'mStream'],\n      format: 'floorid:%s mstrm:%s'\n    },\n    {\n      // any a= that we don't understand is kept verbatim on media.invalid\n      push: 'invalid',\n      names: ['value']\n    }\n  ]\n};\n\n// set sensible defaults to avoid polluting the grammar with boring details\nObject.keys(grammar).forEach(function (key) {\n  var objs = grammar[key];\n  objs.forEach(function (obj) {\n    if (!obj.reg) {\n      obj.reg = /(.*)/;\n    }\n    if (!obj.format) {\n      obj.format = '%s';\n    }\n  });\n});\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SchemaSerializer = exports.FossilDeltaSerializer = exports.registerSerializer = void 0;\nrequire(\"./legacy\");\nvar Client_1 = require(\"./Client\");\nObject.defineProperty(exports, \"Client\", { enumerable: true, get: function () { return Client_1.Client; } });\nvar Protocol_1 = require(\"./Protocol\");\nObject.defineProperty(exports, \"Protocol\", { enumerable: true, get: function () { return Protocol_1.Protocol; } });\nObject.defineProperty(exports, \"ErrorCode\", { enumerable: true, get: function () { return Protocol_1.ErrorCode; } });\nvar Room_1 = require(\"./Room\");\nObject.defineProperty(exports, \"Room\", { enumerable: true, get: function () { return Room_1.Room; } });\nvar Auth_1 = require(\"./Auth\");\nObject.defineProperty(exports, \"Auth\", { enumerable: true, get: function () { return Auth_1.Auth; } });\nObject.defineProperty(exports, \"Platform\", { enumerable: true, get: function () { return Auth_1.Platform; } });\n/*\n * Serializers\n */\nvar FossilDeltaSerializer_1 = require(\"./serializer/FossilDeltaSerializer\");\nObject.defineProperty(exports, \"FossilDeltaSerializer\", { enumerable: true, get: function () { return FossilDeltaSerializer_1.FossilDeltaSerializer; } });\nvar SchemaSerializer_1 = require(\"./serializer/SchemaSerializer\");\nObject.defineProperty(exports, \"SchemaSerializer\", { enumerable: true, get: function () { return SchemaSerializer_1.SchemaSerializer; } });\nvar Serializer_1 = require(\"./serializer/Serializer\");\nObject.defineProperty(exports, \"registerSerializer\", { enumerable: true, get: function () { return Serializer_1.registerSerializer; } });\nSerializer_1.registerSerializer('fossil-delta', FossilDeltaSerializer_1.FossilDeltaSerializer);\nSerializer_1.registerSerializer('schema', SchemaSerializer_1.SchemaSerializer);\n","/* global NAF */\n\nimport { Client as ColyseusClient } from \"colyseus.js\";\nimport { Client as IonClient, LocalStream } from \"ion-sdk-js\";\n\nconst IonState = {\n    CLOSED: 0,\n    OPEN: 1,\n    JOINED: 2,\n    FAILED: -1\n}\n\nexport default class ColyseusIonAdapter {\n    constructor() {\n        this.app = \"default\";\n        this.roomName = \"hubs\";\n        this.room = null;\n        this.roomData = null;\n        this.userData = null;\n\n        this.players = {};\n        this.streams = null;\n        this.pendingStreamRequests = null;\n\n        this.timeOffsets = [];\n        this.serverTimeRequests = 0;\n        this.avgTimeOffset = 0;\n\n        this.blockedClients = new Map();\n        this.frozenUpdates = new Map();\n\n        this.options = {\n            createRoom: true,\n            useIon: true,\n            startLocalStream: false,\n            mediaOptions: {\n                audio: true,\n                video: false,\n                selectedAudioDevice: \"\",\n                selectedVideoDevice: \"\",\n                resolution: \"vga\",\n                bandwidth: 1024,\n                codec: \"VP9\"\n            }\n        };\n    }\n\n    setServerUrl(serverUrls) {\n        this.colyseusUrl = serverUrls[0];\n        this.ionUrl = serverUrls[1];\n    }\n\n    setApp(appName) {\n        this.app = appName;\n    }\n\n    setRoom(roomId) {\n        this.roomId = roomId;\n    }\n\n    setOptions(options) {\n        this.options = Object.assign(this.options, options);\n    }\n\n    setWebRtcOptions(options) {\n        this.options.mediaOptions = Object.assign(this.options.mediaOptions, options);\n    }\n\n    setServerConnectListeners(successListener, failureListener) {\n        this.connectSuccess = successListener;\n        this.connectFailure = failureListener;\n    }\n\n    setRoomOccupantListener(occupantListener) {\n        this.occupantListener = occupantListener;\n    }\n\n    setDataChannelListeners(openListener, closedListener, messageListener) {\n        this.openListener = openListener;\n        this.closedListener = closedListener;\n        this.messageListener = messageListener;\n    }\n\n    connect() {\n        if (!this.colyseusUrl || this.colyseusUrl === \"/\") {\n            if (location.protocol === \"https:\") {\n                this.colyseusUrl = \"wss://\" + location.host + ':2567';\n                this.ionUrl = \"wss://\" + location.host + ':8443';\n            } else {\n                this.colyseusUrl = \"ws://\" + location.host + ':2567';\n                this.ionUrl = \"ws://\" + location.host + ':8443';\n            }\n        }\n\n        NAF.log.write(\"Attempting to connect to colyseus\");\n        const colyseusConnection = new Promise((resolve, reject) => {\n            this.colyseus = new ColyseusClient(this.colyseusUrl);\n            this.joinRoom()\n                .then(resolve)\n                .catch(reject);\n        });\n        if (this.options.useIon) {\n            colyseusConnection.then(() => {\n                const config = {\n                    url: this.ionUrl,\n                    loglevel: \"trace\"\n                }\n                this.ion = new IonClient(config);\n                this.ion.on(\"transport-open\", this.onIonOpen.bind(this));\n                this.ion.on(\"transport-closed\", this.onIonClosed.bind(this));\n                this.streams = {};\n                this.pendingStreamRequests = {};\n            });\n        }\n        return Promise.all([colyseusConnection, this.updateTimeOffset()]);\n    }\n\n    joinRoom() {\n        NAF.log.write(\"Joining room\", this.roomName, this.roomId);\n        const options = {\n            roomId: this.roomId\n        };\n        if (this.options.createRoom) {\n            return this.colyseus.joinOrCreate(this.roomName, options)\n                .then(this.onJoin.bind(this))\n                .catch(this.onJoinError.bind(this));\n        }\n        else {\n            return this.colyseus.join(this.roomName, options)\n                .then(this.onJoin.bind(this))\n                .catch(this.onJoinError.bind(this));\n        }\n    }\n\n    onJoin(room) {\n        this.room = room;\n        room.onMessage(\"roomData\", this.onRoomData.bind(this));\n        room.onMessage(\"userData\", this.onUserData.bind(this));\n        room.onMessage(\"naf\", this.onNaf.bind(this));\n        room.onMessage(\"chat\", this.onChat.bind(this));\n        room.onStateChange.once(this.onInitialState.bind(this));\n        room.onStateChange(this.onStateChange.bind(this));\n        if (room.state.players) {\n            this.players[this.sessionId] = {};\n            room.state.players.onAdd = this.onAddPlayer.bind(this);\n            room.state.players.onRemove = this.onRemovePlayer.bind(this);\n        }\n        this.connectSuccess(this.sessionId);\n        if (this.ionState >= IonState.OPEN) {\n            this.joinIon();\n        }\n    }\n\n    onJoinError(err) {\n        this.connectFailure();\n        const detail = { reason: \"join_denied\" };\n        document.body.dispatchEvent(new CustomEvent(\"connect_error\", { detail }));\n    }\n\n    get sessionId() {\n        return this.room.sessionId;\n    }\n\n    get player() {\n        this.players[this.sessionId];\n    }\n\n    get scene() {\n        return this.roomData.scene;\n    }\n\n    get sceneId() {\n        return this.roomData.scene.scene_id;\n    }\n\n    onRoomData(data) {\n        this.roomData = data;\n        const detail = data;\n        document.body.dispatchEvent(new CustomEvent(\"room_data\", { detail }));\n    }\n\n    onUserData(data) {\n        this.userData = data;\n        const detail = data;\n        document.body.dispatchEvent(new CustomEvent(\"user_data\", { detail }));\n    }\n\n    getAvatar(avatarId) {\n        const avatars = this.roomData.avatars.entries;\n        for (let i=0; i<avatars.length; i++) {\n            if (avatars[i].id === avatarId) {\n                return avatars[i];\n            }\n        }\n    }\n\n    getAvatarSrc(avatarId) {\n        const avatar = this.getAvatar(avatarId);\n        return avatar && avatar.gltfs && avatar.gltfs.avatar;\n    }\n\n    getScene(sceneId) {\n        const scenes = this.roomData.scenes.entries;\n        for (let i=0; i<scenes.length; i++) {\n            if (scenes[i].id === sceneId) {\n                return scenes[i];\n            }\n        }\n    }\n\n    checkSameScene(presence) {\n        return (this.roomData &&\n            (this.roomData.scene.scene_id === presence.sceneId ||\n                (this.roomData.scene.scene_id === this.roomData.scenes.entries[0].id && presence.sceneId === \"lobby\")));\n    }\n\n    updateScene(sceneId) {\n        if (sceneId === this.roomData.scene.scene_id) return;\n        const scene = this.getScene(sceneId);\n        if (scene) {\n            Object.keys(scene).forEach(key => this.roomData.scene[key] = scene[key]);\n            this.roomData.scene.model_url = scene.url;\n            this.roomData.scene.scene_id = scene.id;\n            this.roomData.scene.objects_url = scene.objects_url;\n            document.body.dispatchEvent(new CustomEvent(\"change_scene\"))\n        }\n    }\n\n    canEnterRoom(hub) {\n        if (!hub) return false;\n\n        const roomEntrySlotCount = Object.values(this.players).reduce((acc, { presence }) => {\n            const usingSlot = presence.presence === \"room\" || presence.entering;\n            return acc + (usingSlot ? 1 : 0);\n        }, 0);\n\n        // This now exists in room settings but a default is left here to support old reticulum servers\n        const DEFAULT_ROOM_SIZE = 24;\n        return roomEntrySlotCount < (hub.room_size !== undefined ? hub.room_size : DEFAULT_ROOM_SIZE);\n    }\n\n    onNaf(data) {\n        this.onData(data.sessionId, data.type, data.data);\n    }\n\n    onChat(data) {\n        const detail = { sessionId: data.sessionId, message: data.message, from: data.from };\n        document.body.dispatchEvent(new CustomEvent(\"chat\", { detail }))\n    }\n\n    onData(sessionId, type, data, from) {\n        if (this.frozen) {\n            this.storeMessage(data);\n        }\n        else {\n            this.messageListener(sessionId, type, data, from);\n        }\n    }\n\n    sendChatMsg(message) {\n        this.room.send(\"chat\", message);\n    }\n\n    onInitialState(state) {\n        //this.messageListener(null, 'state', state);\n        this.state = state;\n    }\n\n    onStateChange(state) {\n        //this.messageListener(null, 'state', state);\n    }\n\n    onAddPlayer(player, sessionId) {\n        this.players[sessionId] = player;\n        player.onChange = (changes) => {\n            changes.forEach(change => {\n                switch (change.field) {\n                    case \"profile\":\n                        this.onChangeProfile(change.value, change.previousValue, sessionId);\n                        break;\n                    case 'presence':\n                        this.onChangePresence(change.value, change.previousValue, sessionId);\n                        break;\n                }\n            });\n        };\n        if (sessionId === this.sessionId || this.checkSameScene(player.presence)) {\n            this.openListener(sessionId);\n        }\n        if (this.occupantListener) {\n            this.occupantListener(this.players);\n        }\n        if (sessionId === this.sessionId) {\n            player.profile.displayName = window.APP.store.state.profile.displayName;\n            this.update({ profile: { displayName: player.profile.displayName } });\n        }\n        const detail = { sessionId, player };\n        document.body.dispatchEvent(new CustomEvent(\"player_added\", { detail }));\n    }\n\n    onRemovePlayer(player, sessionId) {\n        this.players[sessionId].onChange = void 0;\n        delete this.players[sessionId];\n        this.closedListener(sessionId);\n        if (this.occupantListener) {\n            this.occupantListener(this.players);\n        }\n        const detail = { sessionId, player };\n        document.body.dispatchEvent(new CustomEvent(\"player_removed\", { detail }));\n    }\n\n    onChangeProfile(profile, prevProfile, sessionId) {\n        const detail = { sessionId,  profile, previous: prevProfile };\n        document.body.dispatchEvent(new CustomEvent(\"profile_updated\", { detail }));\n    }\n\n    onChangePresence(presence, prevPresence, sessionId) {\n        if (sessionId === this.sessionId) {\n            for (let sid in this.players) {\n                if (sid === sessionId) continue;\n                if (this.checkSameScene(this.players[sid].presence)) {\n                    this.openListener(sid);\n                }\n                else {\n                    this.closedListener(sid);\n                }\n            }\n        }\n        else {\n            if (this.checkSameScene(presence)) {\n                this.openListener(sessionId);\n            }\n            else {\n                this.closedListener(sessionId);\n            }\n        }\n        const detail = { sessionId, presence, previous: prevPresence };\n        document.body.dispatchEvent(new CustomEvent(\"presence_updated\", { detail }));\n    }\n\n    signIn(token) {\n        this.room.send('sign_in', token);\n    }\n\n    update(data) {\n        this.room.send('update', data);\n    }\n\n    sendEntering() {\n        this.update({ presence: { entering: true } });\n    }\n\n    sendEnteringCancelled() {\n        this.update({ presence: { entering: false } });\n    }\n\n    sendEntered() {\n        const presence = {\n            presence: \"room\",\n            sceneId: this.roomData.scene.scene_id,\n            entering: false\n        };\n        this.update({ presence: presence });\n    }\n\n    sendObjectSpawned(type) {\n\n    }\n\n    pin(networkId, gltfNode, fileId, fileAccessToken, promotionToken) {\n        this.room.send('pin', { networkId, gltfNode, fileId });\n    }\n\n    unpin(networkId, fileId) {\n        this.room.send('unpin', { networkId, fileId });\n    }\n\n    onIonOpen() {\n        this.ionState = IonState.OPEN;\n        if (this.options.startLocalStream) {\n            this.startLocalStream();\n        }\n        //if (this.userData) {\n            this.joinIon();\n        //}\n    }\n\n    onIonClosed() {\n        this.ionState = IonState.CLOSED;\n    }\n\n    async joinIon() {\n        this.ion.on(\"peer-join\", this.onPeerJoin.bind(this));\n        this.ion.on(\"peer-leave\", this.onPeerLeave.bind(this));\n        this.ion.on(\"stream-add\", this.onStreamAdd.bind(this));\n        this.ion.on(\"stream-remove\", this.onStreamRemove.bind(this));\n        this.ion.on(\"broadcast\", this.onBroadcast.bind(this));\n        // todo: should use a JWT returned by Colyseus\n        await this.ion.join(this.room.id, {\n            // todo: fix\n            // name: this.userData && this.userData.name || \"Anonymous\",\n            // sessionId: this.room.sessionId\n            name: this.sessionId\n        });\n        this.ionState = IonState.JOINED;\n        if (this.localStream) {\n            this.ion.publish(this.localStream);\n        }\n    }\n\n    onPeerJoin(uid, info) {\n        NAF.log.write(\"Peer join \", uid, info);\n    }\n\n    onPeerLeave(uid) {\n        NAF.log.write(\"Peer leave \", uid);\n    }\n\n    async onStreamAdd(mid, info) {\n        if (this.ion) {\n            await this.subscribe(mid, info);\n        }\n    }\n\n    onStreamRemove(stream) {\n\n    }\n\n    onBroadcast(rid, mid, info) {\n        NAF.log.write(\"Ion broadcast \", rid, mid, info);\n    }\n\n    async subscribe(mid, info) {\n        const sessionId = info.name;\n        const stream = await this.ion.subscribe(mid);\n        stream.info = info;\n        this.setMediaStream(sessionId, stream);\n    }\n\n    async unsubscribe(stream) {\n        const sessionId = stream.info.name;\n        await stream.unsubscribe();\n        delete this.streams[sessionId];\n    }\n\n    shouldStartConnectionTo(client) {\n        return false;\n    }\n\n    getConnectStatus(sessionId) {\n        const connected = this.streams[sessionId];\n        if (connected) {\n            return NAF.adapters.IS_CONNECTED;\n        } else {\n            return NAF.adapters.NOT_CONNECTED;\n        }\n    }\n\n    sendData(to, type, data) {\n        this.sendDataGuaranteed(to, type, data);\n    }\n\n    sendDataGuaranteed(to, type, data) {\n        if (this.room) {\n            this.room.send(\"naf\", { to, type, data });\n        } else {\n            NAF.log.warn('Room not joined yet');\n        }\n    }\n\n    broadcastData(type, data) {\n        this.broadcastDataGuaranteed(type, data);\n    }\n\n    broadcastDataGuaranteed(type, data) {\n        if (this.room) {\n            this.room.send(\"naf\", { type, data });\n        } else {\n            NAF.log.warn('Room not joined yet');\n        }\n    }\n\n    getMediaStream(sessionId, type = \"audio\") {\n        if (this.streams[sessionId]) {\n            NAF.log.write(`Already had ${type} for ${sessionId}`);\n            return Promise.resolve(this.streams[sessionId][type]);\n        } else {\n            NAF.log.write(`Waiting on ${type} for ${sessionId}`);\n            if (!this.pendingStreamRequests[sessionId]) {\n                this.pendingStreamRequests[sessionId] = {};\n\n                const audioPromise = new Promise((resolve, reject) => {\n                    this.pendingStreamRequests[sessionId].audio = { resolve, reject };\n                });\n                const videoPromise = new Promise((resolve, reject) => {\n                    this.pendingStreamRequests[sessionId].video = { resolve, reject };\n                });\n\n                this.pendingStreamRequests[sessionId].audio.promise = audioPromise;\n                this.pendingStreamRequests[sessionId].video.promise = videoPromise;\n\n                audioPromise.catch(e => console.warn(`${sessionId} getMediaStream Audio Error`, e));\n                videoPromise.catch(e => console.warn(`${sessionId} getMediaStream Video Error`, e));\n            }\n            return this.pendingStreamRequests[sessionId][type].promise;\n        }\n    }\n\n    setMediaStream(sessionId, stream) {\n        if (stream) {\n            const audioStream = new MediaStream();\n            try {\n                stream.getAudioTracks().forEach(track => audioStream.addTrack(track));\n            }\n            catch(e) {\n                NAF.log.write(`${sessionId} setMediaStream Audio Error`, e);\n            }\n            const videoStream = new MediaStream();\n            try {\n                stream.getVideoTracks().forEach(track => videoStream.addTrack(track));\n            }\n            catch (e) {\n                NAF.log.write(`${sessionId} setMediaStream Video Error`, e);\n            }\n            this.streams[sessionId] = { audio: audioStream, video: videoStream };\n            if (this.pendingStreamRequests[sessionId]) {\n                this.pendingStreamRequests[sessionId].audio.resolve(audioStream);\n                this.pendingStreamRequests[sessionId].video.resolve(videoStream);\n                delete this.pendingStreamRequests[sessionId];\n            }\n        }\n        else {\n            delete this.streams[sessionId];\n        }\n        const detail = { stream, sessionId };\n        document.body.dispatchEvent(new CustomEvent('set_media_stream', { detail }));\n    }\n\n    async setLocalMediaStream(stream) {\n        if (this.localStream) {\n            let tracks = this.localStream.getTracks();\n            for (let i = 0, len = tracks.length; i < len; i++) {\n                await tracks[i].stop();\n            }\n            await this.localStream.unpublish();\n        }\n        if (stream) {\n            if (!(stream instanceof LocalStream)) {\n                stream = new LocalStream(stream, this.options.mediaOptions);\n            }\n        }\n        this.localStream = stream;\n        this.setMediaStream(this.sessionId, this.localStream);\n        if (this.localStream && this.ionState >= IonState.JOINED) {\n            await this.ion.publish(this.localStream);\n        }\n    }\n\n    async startLocalStream() {\n        await this.setLocalMediaStream(null);\n        await this.setLocalMediaStream(await LocalStream.getUserMedia(this.options.mediaOptions));\n    }\n\n    enableMicrophone(enabled) {\n        if (this.localStream) {\n            if (enabled) {\n                this.localStream.unmute(\"audio\");\n            }\n            else {\n                this.localStream.mute(\"audio\");\n            }\n        }\n    }\n\n    toggleFreeze() {\n        if (this.frozen) {\n            this.unfreeze();\n        } else {\n            this.freeze();\n        }\n    }\n\n    freeze() {\n        this.frozen = true;\n    }\n\n    unfreeze() {\n        this.frozen = false;\n        this.flushPendingUpdates();\n    }\n\n    flushPendingUpdates() {\n        for (const [networkId, message] of this.frozenUpdates) {\n            let data = this.getPendingData(networkId, message);\n            if (!data) continue;\n\n            // Override the data type on \"um\" messages types, since we extract entity updates from \"um\" messages into\n            // individual frozenUpdates in storeSingleMessage.\n            const dataType = message.dataType === \"um\" ? \"u\" : message.dataType;\n\n            this.messageListener(null, dataType, data, message.source);\n        }\n        this.frozenUpdates.clear();\n    }\n\n    getPendingData(networkId, message) {\n        if (!message) return null;\n\n        let data = message.dataType === \"um\" ? this.dataForUpdateMultiMessage(networkId, message) : message.data;\n\n        // Ignore messages relating to users who have disconnected since freezing, their entities\n        // will have aleady been removed by NAF.\n        // Note that delete messages have no \"owner\" so we have to check for that as well.\n        if (data.owner && !this.players[data.owner]) return null;\n\n        // Ignore messages from users that we may have blocked while frozen.\n        if (data.owner && this.blockedClients.has(data.owner)) return null;\n\n        return data\n    }\n\n    storeMessage(message) {\n        if (message.dataType === \"um\") { // UpdateMulti\n            for (let i = 0, l = message.data.d.length; i < l; i++) {\n                this.storeSingleMessage(message, i);\n            }\n        } else {\n            this.storeSingleMessage(message);\n        }\n    }\n\n    storeSingleMessage(message, index) {\n        const data = index !== undefined ? message.data.d[index] : message.data;\n        const dataType = message.dataType;\n        const source = message.source;\n\n        const networkId = data.networkId;\n\n        if (!this.frozenUpdates.has(networkId)) {\n            this.frozenUpdates.set(networkId, message);\n        } else {\n            const storedMessage = this.frozenUpdates.get(networkId);\n            const storedData = storedMessage.dataType === \"um\" ? this.dataForUpdateMultiMessage(networkId, storedMessage) : storedMessage.data;\n\n            // Avoid updating components if the entity data received did not come from the current owner.\n            const isOutdatedMessage = data.lastOwnerTime < storedData.lastOwnerTime;\n            const isContemporaneousMessage = data.lastOwnerTime === storedData.lastOwnerTime;\n            if (isOutdatedMessage || (isContemporaneousMessage && storedData.owner > data.owner)) {\n                return;\n            }\n\n            if (dataType === \"r\") {\n                const createdWhileFrozen = storedData && storedData.isFirstSync;\n                if (createdWhileFrozen) {\n                    // If the entity was created and deleted while frozen, don't bother conveying anything to the consumer.\n                    this.frozenUpdates.delete(networkId);\n                } else {\n                    // Delete messages override any other messages for this entity\n                    this.frozenUpdates.set(networkId, message);\n                }\n            } else {\n                // merge in component updates\n                if (storedData.components && data.components) {\n                    Object.assign(storedData.components, data.components);\n                }\n            }\n        }\n    }\n\n    dataForUpdateMultiMessage(networkId, message) {\n        // \"d\" is an array of entity datas, where each item in the array represents a unique entity and contains\n        // metadata for the entity, and an array of components that have been updated on the entity.\n        // This method finds the data corresponding to the given networkId.\n        for (let i = 0, l = message.data.d.length; i < l; i++) {\n            const data = message.data.d[i];\n\n            if (data.networkId === networkId) {\n                return data;\n            }\n        }\n\n        return null;\n    }\n\n    block(sessionId) {\n        this.room.send({ kind: \"block\", whom: sessionId });\n        this.blockedClients.set(sessionId, true);\n        const detail = { clientId: sessionId };\n        document.body.dispatchEvent(new CustomEvent(\"blocked\", { detail }));\n    }\n\n    unblock(sessionId) {\n        this.room.send({ kind: \"unblock\", whom: sessionId });\n        this.blockedClients.delete(sessionId);\n        const detail = { clientId: sessionId };\n        document.body.dispatchEvent(new CustomEvent(\"unblocked\", { detail }));\n    }\n\n    disconnect() {\n        this.ion.leave();\n        this.streams = {};\n        this.pendingStreamRequests = {};\n        if (this.room.state.players) {\n            this.room.state.players.onAdd = void 0;\n            this.room.state.players.onRemove = void 0;\n            this.room.state.players.onChange = void 0;\n        }\n        this.room.removeAllListeners();\n        this.room.leave(false);\n        this.room = null;\n    }\n\n    isDisconnected() {\n        return this.room === null;\n    }\n\n    setReconnectionListeners(reconnectingListener, reconnectedListener, reconnectionErrorListener) {\n        // onReconnecting is called with the number of milliseconds until the next reconnection attempt\n        this.onReconnecting = reconnectingListener;\n        // onReconnected is called when the connection has been reestablished\n        this.onReconnected = reconnectedListener;\n        // onReconnectionError is called with an error when maxReconnectionAttempts has been reached\n        this.onReconnectionError = reconnectionErrorListener;\n    }\n\n    async updateTimeOffset() {\n        if (this.isDisconnected()) return;\n\n        const clientSentTime = Date.now();\n\n        const res = await fetch(document.location.href, {\n            method: \"HEAD\",\n            cache: \"no-cache\"\n        });\n\n        const precision = 1000;\n        const serverReceivedTime = new Date(res.headers.get(\"Date\")).getTime() + precision / 2;\n        const clientReceivedTime = Date.now();\n        const serverTime = serverReceivedTime + (clientReceivedTime - clientSentTime) / 2;\n        const timeOffset = serverTime - clientReceivedTime;\n\n        this.serverTimeRequests++;\n\n        if (this.serverTimeRequests <= 10) {\n            this.timeOffsets.push(timeOffset);\n        } else {\n            this.timeOffsets[this.serverTimeRequests % 10] = timeOffset;\n        }\n\n        this.avgTimeOffset = this.timeOffsets.reduce((acc, offset) => (acc += offset), 0) / this.timeOffsets.length;\n\n        if (this.serverTimeRequests > 10) {\n            NAF.log.write(`new server time offset: ${this.avgTimeOffset}ms`);\n            setTimeout(() => this.updateTimeOffset(), 5 * 60 * 1000); // Sync clock every 5 minutes.\n        } else {\n            this.updateTimeOffset();\n        }\n    }\n\n    getServerTime() {\n        return Date.now() + this.avgTimeOffset;\n    }\n}\n\nNAF.adapters.register(\"colyseus-ion\", ColyseusIonAdapter);\n","//\n// Polyfills for legacy environments\n//\n/*\n * Support Android 4.4.x\n */\nif (!ArrayBuffer.isView) {\n    ArrayBuffer.isView = function (a) {\n        return a !== null && typeof (a) === 'object' && a.buffer instanceof ArrayBuffer;\n    };\n}\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Client = exports.MatchMakeError = void 0;\nvar http_1 = require(\"@colyseus/http\");\nvar ServerError_1 = require(\"./errors/ServerError\");\nvar Room_1 = require(\"./Room\");\nvar Auth_1 = require(\"./Auth\");\nvar Push_1 = require(\"./Push\");\nvar MatchMakeError = /** @class */ (function (_super) {\n    __extends(MatchMakeError, _super);\n    function MatchMakeError(message, code) {\n        var _this = _super.call(this, message) || this;\n        _this.code = code;\n        Object.setPrototypeOf(_this, MatchMakeError.prototype);\n        return _this;\n    }\n    return MatchMakeError;\n}(Error));\nexports.MatchMakeError = MatchMakeError;\nvar Client = /** @class */ (function () {\n    function Client(endpoint) {\n        if (endpoint === void 0) { endpoint = location.protocol.replace(\"http\", \"ws\") + \"//\" + location.hostname + (location.port && \":\" + location.port); }\n        this.endpoint = endpoint;\n        this.auth = new Auth_1.Auth(this.endpoint);\n        this.push = new Push_1.Push(this.endpoint);\n    }\n    Client.prototype.joinOrCreate = function (roomName, options, rootSchema) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.createMatchMakeRequest('joinOrCreate', roomName, options, rootSchema)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    Client.prototype.create = function (roomName, options, rootSchema) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.createMatchMakeRequest('create', roomName, options, rootSchema)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    Client.prototype.join = function (roomName, options, rootSchema) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.createMatchMakeRequest('join', roomName, options, rootSchema)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    Client.prototype.joinById = function (roomId, options, rootSchema) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.createMatchMakeRequest('joinById', roomId, options, rootSchema)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    Client.prototype.reconnect = function (roomId, sessionId, rootSchema) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.createMatchMakeRequest('joinById', roomId, { sessionId: sessionId }, rootSchema)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    Client.prototype.getAvailableRooms = function (roomName) {\n        if (roomName === void 0) { roomName = \"\"; }\n        return __awaiter(this, void 0, void 0, function () {\n            var url;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        url = this.endpoint.replace(\"ws\", \"http\") + \"/matchmake/\" + roomName;\n                        return [4 /*yield*/, http_1.get(url, { headers: { 'Accept': 'application/json' } })];\n                    case 1: return [2 /*return*/, (_a.sent()).data];\n                }\n            });\n        });\n    };\n    Client.prototype.consumeSeatReservation = function (response, rootSchema) {\n        return __awaiter(this, void 0, void 0, function () {\n            var room;\n            return __generator(this, function (_a) {\n                room = this.createRoom(response.room.name, rootSchema);\n                room.id = response.room.roomId;\n                room.sessionId = response.sessionId;\n                room.connect(this.buildEndpoint(response.room, { sessionId: room.sessionId }));\n                return [2 /*return*/, new Promise(function (resolve, reject) {\n                        var onError = function (code, message) { return reject(new ServerError_1.ServerError(code, message)); };\n                        room.onError.once(onError);\n                        room.onJoin.once(function () {\n                            room.onError.remove(onError);\n                            resolve(room);\n                        });\n                    })];\n            });\n        });\n    };\n    Client.prototype.createMatchMakeRequest = function (method, roomName, options, rootSchema) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var url, response;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        url = this.endpoint.replace(\"ws\", \"http\") + \"/matchmake/\" + method + \"/\" + roomName;\n                        // automatically forward auth token, if present\n                        if (this.auth.hasToken) {\n                            options.token = this.auth.token;\n                        }\n                        return [4 /*yield*/, http_1.post(url, {\n                                headers: {\n                                    'Accept': 'application/json',\n                                    'Content-Type': 'application/json'\n                                },\n                                body: JSON.stringify(options)\n                            })];\n                    case 1:\n                        response = (_a.sent()).data;\n                        if (response.error) {\n                            throw new MatchMakeError(response.error, response.code);\n                        }\n                        return [2 /*return*/, this.consumeSeatReservation(response, rootSchema)];\n                }\n            });\n        });\n    };\n    Client.prototype.createRoom = function (roomName, rootSchema) {\n        return new Room_1.Room(roomName, rootSchema);\n    };\n    Client.prototype.buildEndpoint = function (room, options) {\n        if (options === void 0) { options = {}; }\n        var params = [];\n        for (var name_1 in options) {\n            if (!options.hasOwnProperty(name_1)) {\n                continue;\n            }\n            params.push(name_1 + \"=\" + options[name_1]);\n        }\n        return this.endpoint + \"/\" + room.processId + \"/\" + room.roomId + \"?\" + params.join('&');\n    };\n    return Client;\n}());\nexports.Client = Client;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ServerError = void 0;\nvar ServerError = /** @class */ (function (_super) {\n    __extends(ServerError, _super);\n    function ServerError(code, message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = \"ServerError\";\n        _this.code = code;\n        return _this;\n    }\n    return ServerError;\n}(Error));\nexports.ServerError = ServerError;\n","\"use strict\";\n/**\n * Copyright (c) 2014 Ion Drive Software Ltd.\n * https://github.com/darrachequesne/notepack/\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Patch for Colyseus:\n * -------------------\n *\n * added `offset` on Decoder constructor, for messages arriving with a code\n * before actual msgpack data\n */\nfunction Decoder(buffer, offset) {\n    this._offset = offset;\n    if (buffer instanceof ArrayBuffer) {\n        this._buffer = buffer;\n        this._view = new DataView(this._buffer);\n    }\n    else if (ArrayBuffer.isView(buffer)) {\n        this._buffer = buffer.buffer;\n        this._view = new DataView(this._buffer, buffer.byteOffset, buffer.byteLength);\n    }\n    else {\n        throw new Error('Invalid argument');\n    }\n}\nfunction utf8Read(view, offset, length) {\n    var string = '', chr = 0;\n    for (var i = offset, end = offset + length; i < end; i++) {\n        var byte = view.getUint8(i);\n        if ((byte & 0x80) === 0x00) {\n            string += String.fromCharCode(byte);\n            continue;\n        }\n        if ((byte & 0xe0) === 0xc0) {\n            string += String.fromCharCode(((byte & 0x1f) << 6) |\n                (view.getUint8(++i) & 0x3f));\n            continue;\n        }\n        if ((byte & 0xf0) === 0xe0) {\n            string += String.fromCharCode(((byte & 0x0f) << 12) |\n                ((view.getUint8(++i) & 0x3f) << 6) |\n                ((view.getUint8(++i) & 0x3f) << 0));\n            continue;\n        }\n        if ((byte & 0xf8) === 0xf0) {\n            chr = ((byte & 0x07) << 18) |\n                ((view.getUint8(++i) & 0x3f) << 12) |\n                ((view.getUint8(++i) & 0x3f) << 6) |\n                ((view.getUint8(++i) & 0x3f) << 0);\n            if (chr >= 0x010000) { // surrogate pair\n                chr -= 0x010000;\n                string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n            }\n            else {\n                string += String.fromCharCode(chr);\n            }\n            continue;\n        }\n        throw new Error('Invalid byte ' + byte.toString(16));\n    }\n    return string;\n}\nDecoder.prototype._array = function (length) {\n    var value = new Array(length);\n    for (var i = 0; i < length; i++) {\n        value[i] = this._parse();\n    }\n    return value;\n};\nDecoder.prototype._map = function (length) {\n    var key = '', value = {};\n    for (var i = 0; i < length; i++) {\n        key = this._parse();\n        value[key] = this._parse();\n    }\n    return value;\n};\nDecoder.prototype._str = function (length) {\n    var value = utf8Read(this._view, this._offset, length);\n    this._offset += length;\n    return value;\n};\nDecoder.prototype._bin = function (length) {\n    var value = this._buffer.slice(this._offset, this._offset + length);\n    this._offset += length;\n    return value;\n};\nDecoder.prototype._parse = function () {\n    var prefix = this._view.getUint8(this._offset++);\n    var value, length = 0, type = 0, hi = 0, lo = 0;\n    if (prefix < 0xc0) {\n        // positive fixint\n        if (prefix < 0x80) {\n            return prefix;\n        }\n        // fixmap\n        if (prefix < 0x90) {\n            return this._map(prefix & 0x0f);\n        }\n        // fixarray\n        if (prefix < 0xa0) {\n            return this._array(prefix & 0x0f);\n        }\n        // fixstr\n        return this._str(prefix & 0x1f);\n    }\n    // negative fixint\n    if (prefix > 0xdf) {\n        return (0xff - prefix + 1) * -1;\n    }\n    switch (prefix) {\n        // nil\n        case 0xc0:\n            return null;\n        // false\n        case 0xc2:\n            return false;\n        // true\n        case 0xc3:\n            return true;\n        // bin\n        case 0xc4:\n            length = this._view.getUint8(this._offset);\n            this._offset += 1;\n            return this._bin(length);\n        case 0xc5:\n            length = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return this._bin(length);\n        case 0xc6:\n            length = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return this._bin(length);\n        // ext\n        case 0xc7:\n            length = this._view.getUint8(this._offset);\n            type = this._view.getInt8(this._offset + 1);\n            this._offset += 2;\n            return [type, this._bin(length)];\n        case 0xc8:\n            length = this._view.getUint16(this._offset);\n            type = this._view.getInt8(this._offset + 2);\n            this._offset += 3;\n            return [type, this._bin(length)];\n        case 0xc9:\n            length = this._view.getUint32(this._offset);\n            type = this._view.getInt8(this._offset + 4);\n            this._offset += 5;\n            return [type, this._bin(length)];\n        // float\n        case 0xca:\n            value = this._view.getFloat32(this._offset);\n            this._offset += 4;\n            return value;\n        case 0xcb:\n            value = this._view.getFloat64(this._offset);\n            this._offset += 8;\n            return value;\n        // uint\n        case 0xcc:\n            value = this._view.getUint8(this._offset);\n            this._offset += 1;\n            return value;\n        case 0xcd:\n            value = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return value;\n        case 0xce:\n            value = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return value;\n        case 0xcf:\n            hi = this._view.getUint32(this._offset) * Math.pow(2, 32);\n            lo = this._view.getUint32(this._offset + 4);\n            this._offset += 8;\n            return hi + lo;\n        // int\n        case 0xd0:\n            value = this._view.getInt8(this._offset);\n            this._offset += 1;\n            return value;\n        case 0xd1:\n            value = this._view.getInt16(this._offset);\n            this._offset += 2;\n            return value;\n        case 0xd2:\n            value = this._view.getInt32(this._offset);\n            this._offset += 4;\n            return value;\n        case 0xd3:\n            hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n            lo = this._view.getUint32(this._offset + 4);\n            this._offset += 8;\n            return hi + lo;\n        // fixext\n        case 0xd4:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            if (type === 0x00) {\n                this._offset += 1;\n                return void 0;\n            }\n            return [type, this._bin(1)];\n        case 0xd5:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            return [type, this._bin(2)];\n        case 0xd6:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            return [type, this._bin(4)];\n        case 0xd7:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            if (type === 0x00) {\n                hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n                lo = this._view.getUint32(this._offset + 4);\n                this._offset += 8;\n                return new Date(hi + lo);\n            }\n            return [type, this._bin(8)];\n        case 0xd8:\n            type = this._view.getInt8(this._offset);\n            this._offset += 1;\n            return [type, this._bin(16)];\n        // str\n        case 0xd9:\n            length = this._view.getUint8(this._offset);\n            this._offset += 1;\n            return this._str(length);\n        case 0xda:\n            length = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return this._str(length);\n        case 0xdb:\n            length = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return this._str(length);\n        // array\n        case 0xdc:\n            length = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return this._array(length);\n        case 0xdd:\n            length = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return this._array(length);\n        // map\n        case 0xde:\n            length = this._view.getUint16(this._offset);\n            this._offset += 2;\n            return this._map(length);\n        case 0xdf:\n            length = this._view.getUint32(this._offset);\n            this._offset += 4;\n            return this._map(length);\n    }\n    throw new Error('Could not parse');\n};\nfunction decode(buffer, offset) {\n    if (offset === void 0) { offset = 0; }\n    var decoder = new Decoder(buffer, offset);\n    var value = decoder._parse();\n    if (decoder._offset !== buffer.byteLength) {\n        throw new Error((buffer.byteLength - decoder._offset) + ' trailing bytes');\n    }\n    return value;\n}\nexports.default = decode;\n","\"use strict\";\n/**\n * Copyright (c) 2014 Ion Drive Software Ltd.\n * https://github.com/darrachequesne/notepack/\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction utf8Write(view, offset, str) {\n    var c = 0;\n    for (var i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            view.setUint8(offset++, c);\n        }\n        else if (c < 0x800) {\n            view.setUint8(offset++, 0xc0 | (c >> 6));\n            view.setUint8(offset++, 0x80 | (c & 0x3f));\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            view.setUint8(offset++, 0xe0 | (c >> 12));\n            view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\n            view.setUint8(offset++, 0x80 | (c & 0x3f));\n        }\n        else {\n            i++;\n            c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\n            view.setUint8(offset++, 0xf0 | (c >> 18));\n            view.setUint8(offset++, 0x80 | (c >> 12) & 0x3f);\n            view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\n            view.setUint8(offset++, 0x80 | (c & 0x3f));\n        }\n    }\n}\nfunction utf8Length(str) {\n    var c = 0, length = 0;\n    for (var i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\nfunction _encode(bytes, defers, value) {\n    var type = typeof value, i = 0, l = 0, hi = 0, lo = 0, length = 0, size = 0;\n    if (type === 'string') {\n        length = utf8Length(value);\n        // fixstr\n        if (length < 0x20) {\n            bytes.push(length | 0xa0);\n            size = 1;\n        }\n        // str 8\n        else if (length < 0x100) {\n            bytes.push(0xd9, length);\n            size = 2;\n        }\n        // str 16\n        else if (length < 0x10000) {\n            bytes.push(0xda, length >> 8, length);\n            size = 3;\n        }\n        // str 32\n        else if (length < 0x100000000) {\n            bytes.push(0xdb, length >> 24, length >> 16, length >> 8, length);\n            size = 5;\n        }\n        else {\n            throw new Error('String too long');\n        }\n        defers.push({ _str: value, _length: length, _offset: bytes.length });\n        return size + length;\n    }\n    if (type === 'number') {\n        // TODO: encode to float 32?\n        // float 64\n        if (Math.floor(value) !== value || !isFinite(value)) {\n            bytes.push(0xcb);\n            defers.push({ _float: value, _length: 8, _offset: bytes.length });\n            return 9;\n        }\n        if (value >= 0) {\n            // positive fixnum\n            if (value < 0x80) {\n                bytes.push(value);\n                return 1;\n            }\n            // uint 8\n            if (value < 0x100) {\n                bytes.push(0xcc, value);\n                return 2;\n            }\n            // uint 16\n            if (value < 0x10000) {\n                bytes.push(0xcd, value >> 8, value);\n                return 3;\n            }\n            // uint 32\n            if (value < 0x100000000) {\n                bytes.push(0xce, value >> 24, value >> 16, value >> 8, value);\n                return 5;\n            }\n            // uint 64\n            hi = (value / Math.pow(2, 32)) >> 0;\n            lo = value >>> 0;\n            bytes.push(0xcf, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n            return 9;\n        }\n        else {\n            // negative fixnum\n            if (value >= -0x20) {\n                bytes.push(value);\n                return 1;\n            }\n            // int 8\n            if (value >= -0x80) {\n                bytes.push(0xd0, value);\n                return 2;\n            }\n            // int 16\n            if (value >= -0x8000) {\n                bytes.push(0xd1, value >> 8, value);\n                return 3;\n            }\n            // int 32\n            if (value >= -0x80000000) {\n                bytes.push(0xd2, value >> 24, value >> 16, value >> 8, value);\n                return 5;\n            }\n            // int 64\n            hi = Math.floor(value / Math.pow(2, 32));\n            lo = value >>> 0;\n            bytes.push(0xd3, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n            return 9;\n        }\n    }\n    if (type === 'object') {\n        // nil\n        if (value === null) {\n            bytes.push(0xc0);\n            return 1;\n        }\n        if (Array.isArray(value)) {\n            length = value.length;\n            // fixarray\n            if (length < 0x10) {\n                bytes.push(length | 0x90);\n                size = 1;\n            }\n            // array 16\n            else if (length < 0x10000) {\n                bytes.push(0xdc, length >> 8, length);\n                size = 3;\n            }\n            // array 32\n            else if (length < 0x100000000) {\n                bytes.push(0xdd, length >> 24, length >> 16, length >> 8, length);\n                size = 5;\n            }\n            else {\n                throw new Error('Array too large');\n            }\n            for (i = 0; i < length; i++) {\n                size += _encode(bytes, defers, value[i]);\n            }\n            return size;\n        }\n        // fixext 8 / Date\n        if (value instanceof Date) {\n            var time = value.getTime();\n            hi = Math.floor(time / Math.pow(2, 32));\n            lo = time >>> 0;\n            bytes.push(0xd7, 0, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n            return 10;\n        }\n        if (value instanceof ArrayBuffer) {\n            length = value.byteLength;\n            // bin 8\n            if (length < 0x100) {\n                bytes.push(0xc4, length);\n                size = 2;\n            }\n            else \n            // bin 16\n            if (length < 0x10000) {\n                bytes.push(0xc5, length >> 8, length);\n                size = 3;\n            }\n            else \n            // bin 32\n            if (length < 0x100000000) {\n                bytes.push(0xc6, length >> 24, length >> 16, length >> 8, length);\n                size = 5;\n            }\n            else {\n                throw new Error('Buffer too large');\n            }\n            defers.push({ _bin: value, _length: length, _offset: bytes.length });\n            return size + length;\n        }\n        if (typeof value.toJSON === 'function') {\n            return _encode(bytes, defers, value.toJSON());\n        }\n        var keys = [], key = '';\n        var allKeys = Object.keys(value);\n        for (i = 0, l = allKeys.length; i < l; i++) {\n            key = allKeys[i];\n            if (typeof value[key] !== 'function') {\n                keys.push(key);\n            }\n        }\n        length = keys.length;\n        // fixmap\n        if (length < 0x10) {\n            bytes.push(length | 0x80);\n            size = 1;\n        }\n        // map 16\n        else if (length < 0x10000) {\n            bytes.push(0xde, length >> 8, length);\n            size = 3;\n        }\n        // map 32\n        else if (length < 0x100000000) {\n            bytes.push(0xdf, length >> 24, length >> 16, length >> 8, length);\n            size = 5;\n        }\n        else {\n            throw new Error('Object too large');\n        }\n        for (i = 0; i < length; i++) {\n            key = keys[i];\n            size += _encode(bytes, defers, key);\n            size += _encode(bytes, defers, value[key]);\n        }\n        return size;\n    }\n    // false/true\n    if (type === 'boolean') {\n        bytes.push(value ? 0xc3 : 0xc2);\n        return 1;\n    }\n    // fixext 1 / undefined\n    if (type === 'undefined') {\n        bytes.push(0xd4, 0, 0);\n        return 3;\n    }\n    throw new Error('Could not encode');\n}\nfunction encode(value) {\n    var bytes = [];\n    var defers = [];\n    var size = _encode(bytes, defers, value);\n    var buf = new ArrayBuffer(size);\n    var view = new DataView(buf);\n    var deferIndex = 0;\n    var deferWritten = 0;\n    var nextOffset = -1;\n    if (defers.length > 0) {\n        nextOffset = defers[0]._offset;\n    }\n    var defer, deferLength = 0, offset = 0;\n    for (var i = 0, l = bytes.length; i < l; i++) {\n        view.setUint8(deferWritten + i, bytes[i]);\n        if (i + 1 !== nextOffset) {\n            continue;\n        }\n        defer = defers[deferIndex];\n        deferLength = defer._length;\n        offset = deferWritten + nextOffset;\n        if (defer._bin) {\n            var bin = new Uint8Array(defer._bin);\n            for (var j = 0; j < deferLength; j++) {\n                view.setUint8(offset + j, bin[j]);\n            }\n        }\n        else if (defer._str) {\n            utf8Write(view, offset, defer._str);\n        }\n        else if (defer._float !== undefined) {\n            view.setFloat64(offset, defer._float);\n        }\n        deferIndex++;\n        deferWritten += deferLength;\n        if (defers[deferIndex]) {\n            nextOffset = defers[deferIndex]._offset;\n        }\n    }\n    return buf;\n}\nexports.default = encode;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter = /** @class */ (function () {\n    function EventEmitter() {\n        this.handlers = [];\n    }\n    EventEmitter.prototype.register = function (cb, once) {\n        if (once === void 0) { once = false; }\n        this.handlers.push(cb);\n        return this;\n    };\n    EventEmitter.prototype.invoke = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        this.handlers.forEach(function (handler) { return handler.apply(void 0, args); });\n    };\n    EventEmitter.prototype.invokeAsync = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return Promise.all(this.handlers.map(function (handler) { return handler.apply(void 0, args); }));\n    };\n    EventEmitter.prototype.remove = function (cb) {\n        var index = this.handlers.indexOf(cb);\n        this.handlers[index] = this.handlers[this.handlers.length - 1];\n        this.handlers.pop();\n    };\n    EventEmitter.prototype.clear = function () {\n        this.handlers = [];\n    };\n    return EventEmitter;\n}());\nexports.EventEmitter = EventEmitter;\nfunction createSignal() {\n    var emitter = new EventEmitter();\n    function register(cb) {\n        return emitter.register(cb, this === null);\n    }\n    ;\n    register.once = function (cb) {\n        var callback = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            cb.apply(void 0, args);\n            emitter.remove(callback);\n        };\n        emitter.register(callback);\n    };\n    register.remove = function (cb) { return emitter.remove(cb); };\n    register.invoke = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return emitter.invoke.apply(emitter, args);\n    };\n    register.invokeAsync = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return emitter.invokeAsync.apply(emitter, args);\n    };\n    register.clear = function () { return emitter.clear(); };\n    return register;\n}\nexports.createSignal = createSignal;\n","let createNanoEvents = () => ({\n  events: {},\n  emit (event, ...args) {\n    for (let i of this.events[event] || []) {\n      i(...args)\n    }\n  },\n  on (event, cb) {\n    ;(this.events[event] = this.events[event] || []).push(cb)\n    return () => (this.events[event] = this.events[event].filter(i => i !== cb))\n  }\n})\n\nexport { createNanoEvents }\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Connection = void 0;\nvar websocket_1 = __importDefault(require(\"@gamestdio/websocket\"));\nvar Connection = /** @class */ (function (_super) {\n    __extends(Connection, _super);\n    function Connection(url, autoConnect) {\n        if (autoConnect === void 0) { autoConnect = true; }\n        var _this = _super.call(this, url, undefined, { connect: autoConnect }) || this;\n        _this._enqueuedCalls = [];\n        return _this;\n    }\n    Connection.prototype.onOpenCallback = function (event) {\n        _super.prototype.onOpenCallback.call(this);\n        this.binaryType = 'arraybuffer';\n        if (this._enqueuedCalls.length > 0) {\n            for (var _i = 0, _a = this._enqueuedCalls; _i < _a.length; _i++) {\n                var _b = _a[_i], method = _b[0], args = _b[1];\n                this[method].apply(this, args);\n            }\n            // clear enqueued calls.\n            this._enqueuedCalls = [];\n        }\n    };\n    Connection.prototype.send = function (data) {\n        if (this.ws.readyState === websocket_1.default.OPEN) {\n            if (data instanceof ArrayBuffer) {\n                return _super.prototype.send.call(this, data);\n            }\n            else if (Array.isArray(data)) {\n                return _super.prototype.send.call(this, (new Uint8Array(data)).buffer);\n            }\n        }\n        else {\n            // WebSocket not connected.\n            // Enqueue data to be sent when readyState == OPEN\n            this._enqueuedCalls.push(['send', [data]]);\n        }\n    };\n    return Connection;\n}(websocket_1.default));\nexports.Connection = Connection;\n","'use strict';Object.defineProperty(exports,\"__esModule\",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}var createBackoff=require('./backoff').createBackoff;var WebSocketImpl=typeof WebSocket!==\"undefined\"?WebSocket:require('ws');var WebSocketClient=function(){/**\n   * @param url DOMString The URL to which to connect; this should be the URL to which the WebSocket server will respond.\n   * @param protocols DOMString|DOMString[] Either a single protocol string or an array of protocol strings. These strings are used to indicate sub-protocols, so that a single server can implement multiple WebSocket sub-protocols (for example, you might want one server to be able to handle different types of interactions depending on the specified protocol). If you don't specify a protocol string, an empty string is assumed.\n   */function WebSocketClient(url,protocols){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};_classCallCheck(this,WebSocketClient);this.url=url;this.protocols=protocols;this.reconnectEnabled=true;this.listeners={};this.backoff=createBackoff(options.backoff||'exponential',options);this.backoff.onReady=this.onBackoffReady.bind(this);if(typeof options.connect===\"undefined\"||options.connect){this.open();}}_createClass(WebSocketClient,[{key:'open',value:function open(){var reconnect=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.isReconnect=reconnect;// keep binaryType used on previous WebSocket connection\nvar binaryType=this.ws&&this.ws.binaryType;this.ws=new WebSocketImpl(this.url,this.protocols);this.ws.onclose=this.onCloseCallback.bind(this);this.ws.onerror=this.onErrorCallback.bind(this);this.ws.onmessage=this.onMessageCallback.bind(this);this.ws.onopen=this.onOpenCallback.bind(this);if(binaryType){this.ws.binaryType=binaryType;}}/**\n   * @ignore\n   */},{key:'onBackoffReady',value:function onBackoffReady(number,delay){// console.log(\"onBackoffReady\", number + ' ' + delay + 'ms');\nthis.open(true);}/**\n   * @ignore\n   */},{key:'onCloseCallback',value:function onCloseCallback(e){if(!this.isReconnect&&this.listeners['onclose']){this.listeners['onclose'].apply(null,arguments);}if(this.reconnectEnabled&&e.code<3000){this.backoff.backoff();}}/**\n   * @ignore\n   */},{key:'onErrorCallback',value:function onErrorCallback(){if(this.listeners['onerror']){this.listeners['onerror'].apply(null,arguments);}}/**\n   * @ignore\n   */},{key:'onMessageCallback',value:function onMessageCallback(){if(this.listeners['onmessage']){this.listeners['onmessage'].apply(null,arguments);}}/**\n   * @ignore\n   */},{key:'onOpenCallback',value:function onOpenCallback(){if(this.listeners['onopen']){this.listeners['onopen'].apply(null,arguments);}if(this.isReconnect&&this.listeners['onreconnect']){this.listeners['onreconnect'].apply(null,arguments);}this.isReconnect=false;}/**\n   * The number of bytes of data that have been queued using calls to send()\n   * but not yet transmitted to the network. This value does not reset to zero\n   * when the connection is closed; if you keep calling send(), this will\n   * continue to climb.\n   *\n   * @type unsigned long\n   * @readonly\n   */},{key:'close',/**\n   * Closes the WebSocket connection or connection attempt, if any. If the\n   * connection is already CLOSED, this method does nothing.\n   *\n   * @param code A numeric value indicating the status code explaining why the connection is being closed. If this parameter is not specified, a default value of 1000 (indicating a normal \"transaction complete\" closure) is assumed. See the list of status codes on the CloseEvent page for permitted values.\n   * @param reason A human-readable string explaining why the connection is closing. This string must be no longer than 123 bytes of UTF-8 text (not characters).\n   *\n   * @return void\n   */value:function close(code,reason){if(typeof code=='undefined'){code=1000;}this.reconnectEnabled=false;this.ws.close(code,reason);}/**\n   * Transmits data to the server over the WebSocket connection.\n   * @param data DOMString|ArrayBuffer|Blob\n   * @return void\n   */},{key:'send',value:function send(data){this.ws.send(data);}/**\n   * An event listener to be called when the WebSocket connection's readyState changes to CLOSED. The listener receives a CloseEvent named \"close\".\n   * @param listener EventListener\n   */},{key:'bufferedAmount',get:function get(){return this.ws.bufferedAmount;}/**\n   * The current state of the connection; this is one of the Ready state constants.\n   * @type unsigned short\n   * @readonly\n   */},{key:'readyState',get:function get(){return this.ws.readyState;}/**\n   * A string indicating the type of binary data being transmitted by the\n   * connection. This should be either \"blob\" if DOM Blob objects are being\n   * used or \"arraybuffer\" if ArrayBuffer objects are being used.\n   * @type DOMString\n   */},{key:'binaryType',get:function get(){return this.ws.binaryType;},set:function set(binaryType){this.ws.binaryType=binaryType;}/**\n   * The extensions selected by the server. This is currently only the empty\n   * string or a list of extensions as negotiated by the connection.\n   * @type DOMString\n   */},{key:'extensions',get:function get(){return this.ws.extensions;},set:function set(extensions){this.ws.extensions=extensions;}/**\n   * A string indicating the name of the sub-protocol the server selected;\n   * this will be one of the strings specified in the protocols parameter when\n   * creating the WebSocket object.\n   * @type DOMString\n   */},{key:'protocol',get:function get(){return this.ws.protocol;},set:function set(protocol){this.ws.protocol=protocol;}},{key:'onclose',set:function set(listener){this.listeners['onclose']=listener;},get:function get(){return this.listeners['onclose'];}/**\n   * An event listener to be called when an error occurs. This is a simple event named \"error\".\n   * @param listener EventListener\n   */},{key:'onerror',set:function set(listener){this.listeners['onerror']=listener;},get:function get(){return this.listeners['onerror'];}/**\n   * An event listener to be called when a message is received from the server. The listener receives a MessageEvent named \"message\".\n   * @param listener EventListener\n   */},{key:'onmessage',set:function set(listener){this.listeners['onmessage']=listener;},get:function get(){return this.listeners['onmessage'];}/**\n   * An event listener to be called when the WebSocket connection's readyState changes to OPEN; this indicates that the connection is ready to send and receive data. The event is a simple one with the name \"open\".\n   * @param listener EventListener\n   */},{key:'onopen',set:function set(listener){this.listeners['onopen']=listener;},get:function get(){return this.listeners['onopen'];}/**\n   * @param listener EventListener\n   */},{key:'onreconnect',set:function set(listener){this.listeners['onreconnect']=listener;},get:function get(){return this.listeners['onreconnect'];}}]);return WebSocketClient;}();/**\n * The connection is not yet open.\n */WebSocketClient.CONNECTING=WebSocketImpl.CONNECTING;/**\n * The connection is open and ready to communicate.\n */WebSocketClient.OPEN=WebSocketImpl.OPEN;/**\n * The connection is in the process of closing.\n */WebSocketClient.CLOSING=WebSocketImpl.CLOSING;/**\n * The connection is closed or couldn't be opened.\n */WebSocketClient.CLOSED=WebSocketImpl.CLOSED;exports.default=WebSocketClient;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports.createBackoff=createBackoff;var backoff={exponential:function exponential(attempt,delay){return Math.floor(Math.random()*Math.pow(2,attempt)*delay);},fibonacci:function fibonacci(attempt,delay){var current=1;if(attempt>current){var prev=1,current=2;for(var index=2;index<attempt;index++){var next=prev+current;prev=current;current=next;}}return Math.floor(Math.random()*current*delay);}};function createBackoff(type,options){return new Backoff(backoff[type],options);}function Backoff(func,options){this.func=func;this.attempts=0;this.delay=typeof options.initialDelay!==\"undefined\"?options.initialDelay:100;}Backoff.prototype.backoff=function(){setTimeout(this.onReady,this.func(++this.attempts,this.delay));};","\"use strict\";\n/// <reference path=\"../typings/cocos-creator.d.ts\" />\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getItem = exports.removeItem = exports.setItem = void 0;\n/**\n * We do not assign 'storage' to window.localStorage immediatelly for React\n * Native compatibility. window.localStorage is not present when this module is\n * loaded.\n */\nvar storage;\nfunction getStorage() {\n    if (!storage) {\n        storage = (typeof (cc) !== 'undefined' && cc.sys && cc.sys.localStorage)\n            ? cc.sys.localStorage // compatibility with cocos creator\n            : typeof (window) !== \"undefined\" && window.localStorage //RN does have window object at this point, but localStorage is not defined\n                ? window.localStorage // regular browser environment\n                : {\n                    cache: {},\n                    setItem: function (key, value) { this.cache[key] = value; },\n                    getItem: function (key) { this.cache[key]; },\n                    removeItem: function (key) { delete this.cache[key]; },\n                };\n    }\n    return storage;\n}\nfunction setItem(key, value) {\n    getStorage().setItem(key, value);\n}\nexports.setItem = setItem;\nfunction removeItem(key) {\n    getStorage().removeItem(key);\n}\nexports.removeItem = removeItem;\nfunction getItem(key, callback) {\n    var value = getStorage().getItem(key);\n    if (typeof (Promise) === 'undefined' || // old browsers\n        !(value instanceof Promise)) {\n        // browser has synchronous return\n        callback(value);\n    }\n    else {\n        // react-native is asynchronous\n        value.then(function (id) { return callback(id); });\n    }\n}\nexports.getItem = getItem;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Push = void 0;\nvar Push = /** @class */ (function () {\n    function Push(endpoint) {\n        this.endpoint = endpoint.replace(\"ws\", \"http\");\n    }\n    Push.prototype.register = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.check();\n                        return [4 /*yield*/, this.registerServiceWorker()];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.requestNotificationPermission()];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ;\n    Push.prototype.registerServiceWorker = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, navigator.serviceWorker.register(this.endpoint + \"/push\")];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    Push.prototype.requestNotificationPermission = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var permission;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, window[\"Notification\"].requestPermission()];\n                    case 1:\n                        permission = _a.sent();\n                        // value of permission can be 'granted', 'default', 'denied'\n                        // granted: user has accepted the request\n                        // default: user has dismissed the notification permission popup by clicking on x\n                        // denied: user has denied the request.\n                        if (permission !== \"granted\") {\n                            throw new Error(\"Permission not granted for Notification\");\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Push.prototype.check = function () {\n        if (!(\"serviceWorker\" in navigator)) {\n            throw new Error(\"No Service Worker support!\");\n        }\n        if (!(\"PushManager\" in window)) {\n            throw new Error(\"No Push API Support!\");\n        }\n    };\n    return Push;\n}());\nexports.Push = Push;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FossilDeltaSerializer = void 0;\nvar state_listener_1 = require(\"@gamestdio/state-listener\");\nvar fossilDelta = __importStar(require(\"fossil-delta\"));\nvar msgpack = __importStar(require(\"../msgpack\"));\nvar FossilDeltaSerializer = /** @class */ (function () {\n    function FossilDeltaSerializer() {\n        this.api = new state_listener_1.StateContainer({});\n    }\n    FossilDeltaSerializer.prototype.getState = function () {\n        return this.api.state;\n    };\n    FossilDeltaSerializer.prototype.setState = function (encodedState) {\n        this.previousState = new Uint8Array(encodedState);\n        this.api.set(msgpack.decode(this.previousState));\n    };\n    FossilDeltaSerializer.prototype.patch = function (binaryPatch) {\n        // apply patch\n        this.previousState = new Uint8Array(fossilDelta.apply(this.previousState, binaryPatch));\n        // trigger update callbacks\n        this.api.set(msgpack.decode(this.previousState));\n    };\n    FossilDeltaSerializer.prototype.teardown = function () {\n        this.api.removeAllListeners();\n    };\n    return FossilDeltaSerializer;\n}());\nexports.FossilDeltaSerializer = FossilDeltaSerializer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar StateContainer_1 = require(\"./StateContainer\");\nexports.StateContainer = StateContainer_1.StateContainer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar compare_1 = require(\"./compare\");\nvar StateContainer = /** @class */ (function () {\n    function StateContainer(state) {\n        this.listeners = [];\n        this.matcherPlaceholders = {\n            \":id\": /^([a-zA-Z0-9\\-_]+)$/,\n            \":number\": /^([0-9]+)$/,\n            \":string\": /^(\\w+)$/,\n            \":axis\": /^([xyz])$/,\n            \":*\": /(.*)/,\n        };\n        this.state = state;\n        this.reset();\n    }\n    StateContainer.prototype.set = function (newState) {\n        var patches = compare_1.compare(this.state, newState);\n        this.state = newState;\n        this.checkPatches(patches, this.listeners, this.defaultListener);\n        return patches;\n    };\n    StateContainer.prototype.registerPlaceholder = function (placeholder, matcher) {\n        this.matcherPlaceholders[placeholder] = matcher;\n    };\n    StateContainer.prototype.listen = function (segments, callback, immediate) {\n        var _this = this;\n        var rules;\n        if (typeof (segments) === \"function\") {\n            rules = [];\n            callback = segments;\n        }\n        else {\n            rules = segments.split(\"/\");\n        }\n        if (callback.length > 1) {\n            console.warn(\".listen() accepts only one parameter.\");\n        }\n        var listener = {\n            callback: callback,\n            rawRules: rules,\n            rules: rules.map(function (segment) {\n                if (typeof (segment) === \"string\") {\n                    // replace placeholder matchers\n                    return (segment.indexOf(\":\") === 0)\n                        ? _this.matcherPlaceholders[segment] || _this.matcherPlaceholders[\":*\"]\n                        : new RegExp(\"^\" + segment + \"$\");\n                }\n                else {\n                    return segment;\n                }\n            })\n        };\n        if (rules.length === 0) {\n            this.defaultListener = listener;\n        }\n        else {\n            this.listeners.push(listener);\n        }\n        // immediatelly try to trigger this listener.\n        if (immediate) {\n            this.checkPatches(compare_1.compare({}, this.state), [listener]);\n        }\n        return listener;\n    };\n    StateContainer.prototype.removeListener = function (listener) {\n        for (var i = this.listeners.length - 1; i >= 0; i--) {\n            if (this.listeners[i] === listener) {\n                this.listeners.splice(i, 1);\n            }\n        }\n    };\n    StateContainer.prototype.removeAllListeners = function () {\n        this.reset();\n    };\n    StateContainer.prototype.checkPatches = function (patches, listeners, defaultListener) {\n        for (var j = 0, len = listeners.length; j < len; j++) {\n            var listener = listeners[j];\n            for (var i = patches.length - 1; i >= 0; i--) {\n                var pathVariables = listener && this.getPathVariables(patches[i], listener);\n                if (pathVariables) {\n                    listener.callback({\n                        path: pathVariables,\n                        rawPath: patches[i].path,\n                        operation: patches[i].operation,\n                        value: patches[i].value\n                    });\n                    patches[i].matched = true;\n                }\n            }\n        }\n        // trigger default listener callback with each unmatched patch\n        if (defaultListener) {\n            for (var i = patches.length - 1; i >= 0; i--) {\n                if (!patches[i].matched) {\n                    defaultListener.callback(patches[i]);\n                }\n            }\n        }\n    };\n    StateContainer.prototype.getPathVariables = function (patch, listener) {\n        // skip if rules count differ from patch\n        if (patch.path.length !== listener.rules.length) {\n            return false;\n        }\n        var path = {};\n        for (var i = 0, len = listener.rules.length; i < len; i++) {\n            var matches = patch.path[i].match(listener.rules[i]);\n            if (!matches || matches.length === 0 || matches.length > 2) {\n                return false;\n            }\n            else if (listener.rawRules[i].substr(0, 1) === \":\") {\n                path[listener.rawRules[i].substr(1)] = matches[1];\n            }\n        }\n        return path;\n    };\n    StateContainer.prototype.reset = function () {\n        this.listeners = [];\n    };\n    return StateContainer;\n}());\nexports.StateContainer = StateContainer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction compare(tree1, tree2) {\n    var patches = [];\n    generate(tree1, tree2, patches, []);\n    return patches;\n}\nexports.compare = compare;\nfunction concat(arr, value) {\n    var newArr = arr.slice();\n    newArr.push(value);\n    return newArr;\n}\nfunction objectKeys(obj) {\n    if (Array.isArray(obj)) {\n        var keys_1 = new Array(obj.length);\n        for (var k = 0; k < keys_1.length; k++) {\n            keys_1[k] = \"\" + k;\n        }\n        return keys_1;\n    }\n    if (Object.keys) {\n        return Object.keys(obj);\n    }\n    var keys = [];\n    for (var i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            keys.push(i);\n        }\n    }\n    return keys;\n}\n;\n// Dirty check if obj is different from mirror, generate patches and update mirror\nfunction generate(mirror, obj, patches, path) {\n    var newKeys = objectKeys(obj);\n    var oldKeys = objectKeys(mirror);\n    var deleted = false;\n    for (var t = oldKeys.length - 1; t >= 0; t--) {\n        var key = oldKeys[t];\n        var oldVal = mirror[key];\n        if (obj.hasOwnProperty(key) && !(obj[key] === undefined && oldVal !== undefined && Array.isArray(obj) === false)) {\n            var newVal = obj[key];\n            if (typeof oldVal == \"object\" && oldVal != null && typeof newVal == \"object\" && newVal != null) {\n                generate(oldVal, newVal, patches, concat(path, key));\n            }\n            else {\n                if (oldVal !== newVal) {\n                    patches.push({\n                        operation: \"replace\",\n                        path: concat(path, key),\n                        value: newVal,\n                        previousValue: oldVal\n                    });\n                }\n            }\n        }\n        else {\n            patches.push({ operation: \"remove\", path: concat(path, key) });\n            deleted = true; // property has been deleted\n        }\n    }\n    if (!deleted && newKeys.length == oldKeys.length) {\n        return;\n    }\n    for (var t = newKeys.length - 1; t >= 0; t--) {\n        var key = newKeys[t];\n        if (!mirror.hasOwnProperty(key) && obj[key] !== undefined) {\n            var newVal = obj[key];\n            var addPath = concat(path, key);\n            // compare deeper additions\n            if (typeof newVal == \"object\" && newVal != null) {\n                generate({}, newVal, patches, addPath);\n            }\n            patches.push({ operation: \"add\", path: addPath, value: newVal });\n        }\n    }\n}\n","// Fossil SCM delta compression algorithm\n// ======================================\n//\n// Format:\n// http://www.fossil-scm.org/index.html/doc/tip/www/delta_format.wiki\n//\n// Algorithm:\n// http://www.fossil-scm.org/index.html/doc/tip/www/delta_encoder_algorithm.wiki\n//\n// Original implementation:\n// http://www.fossil-scm.org/index.html/artifact/d1b0598adcd650b3551f63b17dfc864e73775c3d\n//\n// LICENSE\n// -------\n//\n// Copyright 2014 Dmitry Chestnykh (JavaScript port)\n// Copyright 2007 D. Richard Hipp  (original C version)\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or\n// without modification, are permitted provided that the\n// following conditions are met:\n//\n//   1. Redistributions of source code must retain the above\n//      copyright notice, this list of conditions and the\n//      following disclaimer.\n//\n//   2. Redistributions in binary form must reproduce the above\n//      copyright notice, this list of conditions and the\n//      following disclaimer in the documentation and/or other\n//      materials provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY THE AUTHORS ``AS IS'' AND ANY EXPRESS\n// OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n// ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHORS OR CONTRIBUTORS BE\n// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR\n// BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n// WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n// OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n// EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation\n// are those of the authors and contributors and should not be interpreted\n// as representing official policies, either expressed or implied, of anybody\n// else.\n//\n(function(root, factory) {\n  if (typeof module !== 'undefined' && module.exports) module.exports = factory();\n  else root.fossilDelta = factory();\n})(this, function() {\n'use strict';\n\nvar fossilDelta = {};\n\n// Hash window width in bytes. Must be a power of two.\nvar NHASH = 16;\n\nfunction RollingHash() {\n  this.a = 0; // hash     (16-bit unsigned)\n  this.b = 0; // values   (16-bit unsigned)\n  this.i = 0; // start of the hash window (16-bit unsigned)\n  this.z = new Array(NHASH); // the values that have been hashed.\n}\n\n// Initialize the rolling hash using the first NHASH bytes of\n// z at the given position.\nRollingHash.prototype.init = function(z, pos) {\n  var a = 0, b = 0, i, x;\n  for(i = 0; i < NHASH; i++){\n    x = z[pos+i];\n    a = (a + x) & 0xffff;\n    b = (b + (NHASH-i)*x) & 0xffff;\n    this.z[i] = x;\n  }\n  this.a = a & 0xffff;\n  this.b = b & 0xffff;\n  this.i = 0;\n};\n\n// Advance the rolling hash by a single byte \"c\".\nRollingHash.prototype.next = function(c) {\n  var old = this.z[this.i];\n  this.z[this.i] = c;\n  this.i = (this.i+1)&(NHASH-1);\n  this.a = (this.a - old + c) & 0xffff;\n  this.b = (this.b - NHASH*old + this.a) & 0xffff;\n};\n\n// Return a 32-bit hash value.\nRollingHash.prototype.value = function() {\n  return ((this.a & 0xffff) | (this.b & 0xffff)<<16)>>>0;\n};\n\nvar zDigits = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz~\".\n                split('').map(function (x) { return x.charCodeAt(0); });\n\nvar zValue = [\n  -1, -1, -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1, -1, -1, -1, -1,\n  -1, -1, -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1, -1, -1, -1, -1,\n  -1, -1, -1, -1, -1, -1, -1, -1,   -1, -1, -1, -1, -1, -1, -1, -1,\n   0,  1,  2,  3,  4,  5,  6,  7,    8,  9, -1, -1, -1, -1, -1, -1,\n  -1, 10, 11, 12, 13, 14, 15, 16,   17, 18, 19, 20, 21, 22, 23, 24,\n  25, 26, 27, 28, 29, 30, 31, 32,   33, 34, 35, -1, -1, -1, -1, 36,\n  -1, 37, 38, 39, 40, 41, 42, 43,   44, 45, 46, 47, 48, 49, 50, 51,\n  52, 53, 54, 55, 56, 57, 58, 59,   60, 61, 62, -1, -1, -1, 63, -1\n];\n\n// Reader reads bytes, chars, ints from array.\nfunction Reader(array) {\n  this.a = array; // source array\n  this.pos = 0;   // current position in array\n}\n\nReader.prototype.haveBytes = function() {\n  return this.pos < this.a.length;\n};\n\nReader.prototype.getByte = function() {\n  var b = this.a[this.pos];\n  this.pos++;\n  if (this.pos > this.a.length) throw new RangeError('out of bounds');\n  return b;\n};\n\nReader.prototype.getChar = function() {\n  return String.fromCharCode(this.getByte());\n};\n\n// Read base64-encoded unsigned integer.\nReader.prototype.getInt = function(){\n  var v = 0, c;\n  while(this.haveBytes() && (c = zValue[0x7f & this.getByte()]) >= 0) {\n     v = (v<<6) + c;\n  }\n  this.pos--;\n  return v >>> 0;\n};\n\n\n// Write writes an array.\nfunction Writer() {\n  this.a = [];\n}\n\nWriter.prototype.toArray = function() {\n  return this.a;\n};\n\nWriter.prototype.putByte = function(b) {\n  this.a.push(b & 0xff);\n};\n\n// Write an ASCII character (s is a one-char string).\nWriter.prototype.putChar = function(s) {\n  this.putByte(s.charCodeAt(0));\n};\n\n// Write a base64 unsigned integer.\nWriter.prototype.putInt = function(v){\n  var i, j, zBuf = [];\n  if (v === 0) {\n    this.putChar('0');\n    return;\n  }\n  for (i = 0; v > 0; i++, v >>>= 6)\n    zBuf.push(zDigits[v&0x3f]);\n  for (j = i-1; j >= 0; j--)\n    this.putByte(zBuf[j]);\n};\n\n// Copy from array at start to end.\nWriter.prototype.putArray = function(a, start, end) {\n  for (var i = start; i < end; i++) this.a.push(a[i]);\n};\n\n// Return the number digits in the base64 representation of a positive integer.\nfunction digitCount(v){\n  var i, x;\n  for (i = 1, x = 64; v >= x; i++, x <<= 6){ /* nothing */ }\n  return i;\n}\n\n// Return a 32-bit checksum of the array.\nfunction checksum(arr) {\n  var sum0 = 0, sum1 = 0, sum2 = 0, sum3 = 0,\n      z = 0, N = arr.length;\n  //TODO measure if this unrolling is helpful.\n  while (N >= 16) {\n    sum0 = sum0 + arr[z+0] | 0;\n    sum1 = sum1 + arr[z+1] | 0;\n    sum2 = sum2 + arr[z+2] | 0;\n    sum3 = sum3 + arr[z+3] | 0;\n\n    sum0 = sum0 + arr[z+4] | 0;\n    sum1 = sum1 + arr[z+5] | 0;\n    sum2 = sum2 + arr[z+6] | 0;\n    sum3 = sum3 + arr[z+7] | 0;\n\n    sum0 = sum0 + arr[z+8] | 0;\n    sum1 = sum1 + arr[z+9] | 0;\n    sum2 = sum2 + arr[z+10] | 0;\n    sum3 = sum3 + arr[z+11] | 0;\n\n    sum0 = sum0 + arr[z+12] | 0;\n    sum1 = sum1 + arr[z+13] | 0;\n    sum2 = sum2 + arr[z+14] | 0;\n    sum3 = sum3 + arr[z+15] | 0;\n\n    z += 16;\n    N -= 16;\n  }\n  while (N >= 4) {\n    sum0 = sum0 + arr[z+0] | 0;\n    sum1 = sum1 + arr[z+1] | 0;\n    sum2 = sum2 + arr[z+2] | 0;\n    sum3 = sum3 + arr[z+3] | 0;\n    z += 4;\n    N -= 4;\n  }\n  sum3 = (((sum3 + (sum2 << 8) | 0) + (sum1 << 16) | 0) + (sum0 << 24) | 0);\n  /* jshint -W086 */\n  switch (N) {\n    case 3: sum3 = sum3 + (arr[z+2] <<  8) | 0; /* falls through */\n    case 2: sum3 = sum3 + (arr[z+1] << 16) | 0; /* falls through */\n    case 1: sum3 = sum3 + (arr[z+0] << 24) | 0; /* falls through */\n  }\n  return sum3 >>> 0;\n}\n\n// Create a new delta from src to out.\nfossilDelta.create = function(src, out) {\n  var zDelta = new Writer();\n  var lenOut = out.length;\n  var lenSrc = src.length;\n  var i, lastRead = -1;\n\n  zDelta.putInt(lenOut);\n  zDelta.putChar('\\n');\n\n  // If the source is very small, it means that we have no\n  // chance of ever doing a copy command.  Just output a single\n  // literal segment for the entire target and exit.\n  if (lenSrc <= NHASH) {\n    zDelta.putInt(lenOut);\n    zDelta.putChar(':');\n    zDelta.putArray(out, 0, lenOut);\n    zDelta.putInt(checksum(out));\n    zDelta.putChar(';');\n    return zDelta.toArray();\n  }\n\n  // Compute the hash table used to locate matching sections in the source.\n  var nHash = Math.ceil(lenSrc / NHASH);\n  var collide =  new Array(nHash);\n  var landmark = new Array(nHash);\n  for (i = 0; i < collide.length; i++) collide[i] = -1;\n  for (i = 0; i < landmark.length; i++) landmark[i] = -1;\n  var hv, h = new RollingHash();\n  for (i = 0; i < lenSrc-NHASH; i += NHASH) {\n    h.init(src, i);\n    hv = h.value() % nHash;\n    collide[i/NHASH] = landmark[hv];\n    landmark[hv] = i/NHASH;\n  }\n\n  var base = 0;\n  var iSrc, iBlock, bestCnt, bestOfst, bestLitsz;\n  while (base+NHASH<lenOut) {\n    bestOfst=0;\n    bestLitsz=0;\n    h.init(out, base);\n    i = 0; // Trying to match a landmark against zOut[base+i]\n    bestCnt = 0;\n    while(1) {\n      var limit = 250;\n      hv = h.value() % nHash;\n      iBlock = landmark[hv];\n      while (iBlock >= 0 && (limit--)>0 ) {\n        //\n        // The hash window has identified a potential match against\n        // landmark block iBlock.  But we need to investigate further.\n        //\n        // Look for a region in zOut that matches zSrc. Anchor the search\n        // at zSrc[iSrc] and zOut[base+i].  Do not include anything prior to\n        // zOut[base] or after zOut[outLen] nor anything after zSrc[srcLen].\n        //\n        // Set cnt equal to the length of the match and set ofst so that\n        // zSrc[ofst] is the first element of the match.  litsz is the number\n        // of characters between zOut[base] and the beginning of the match.\n        // sz will be the overhead (in bytes) needed to encode the copy\n        // command.  Only generate copy command if the overhead of the\n        // copy command is less than the amount of literal text to be copied.\n        //\n        var cnt, ofst, litsz;\n        var j, k, x, y;\n        var sz;\n\n        // Beginning at iSrc, match forwards as far as we can.\n        // j counts the number of characters that match.\n        iSrc = iBlock*NHASH;\n        for (j = 0, x = iSrc, y = base+i; x < lenSrc && y < lenOut; j++, x++, y++) {\n          if (src[x] !== out[y]) break;\n        }\n        j--;\n\n        // Beginning at iSrc-1, match backwards as far as we can.\n        // k counts the number of characters that match.\n        for (k = 1; k < iSrc && k <= i; k++) {\n          if (src[iSrc-k] !== out[base+i-k]) break;\n        }\n        k--;\n\n        // Compute the offset and size of the matching region.\n        ofst = iSrc-k;\n        cnt = j+k+1;\n        litsz = i-k;  // Number of bytes of literal text before the copy\n        // sz will hold the number of bytes needed to encode the \"insert\"\n        // command and the copy command, not counting the \"insert\" text.\n        sz = digitCount(i-k)+digitCount(cnt)+digitCount(ofst)+3;\n        if (cnt >= sz && cnt > bestCnt) {\n          // Remember this match only if it is the best so far and it\n          // does not increase the file size.\n          bestCnt = cnt;\n          bestOfst = iSrc-k;\n          bestLitsz = litsz;\n        }\n\n        // Check the next matching block\n        iBlock = collide[iBlock];\n      }\n\n      // We have a copy command that does not cause the delta to be larger\n      // than a literal insert.  So add the copy command to the delta.\n      if (bestCnt > 0) {\n        if (bestLitsz > 0) {\n          // Add an insert command before the copy.\n          zDelta.putInt(bestLitsz);\n          zDelta.putChar(':');\n          zDelta.putArray(out, base, base+bestLitsz);\n          base += bestLitsz;\n        }\n        base += bestCnt;\n        zDelta.putInt(bestCnt);\n        zDelta.putChar('@');\n        zDelta.putInt(bestOfst);\n        zDelta.putChar(',');\n        if (bestOfst + bestCnt -1 > lastRead) {\n          lastRead = bestOfst + bestCnt - 1;\n        }\n        bestCnt = 0;\n        break;\n      }\n\n      // If we reach this point, it means no match is found so far\n      if (base+i+NHASH >= lenOut){\n        // We have reached the end and have not found any\n        // matches.  Do an \"insert\" for everything that does not match\n        zDelta.putInt(lenOut-base);\n        zDelta.putChar(':');\n        zDelta.putArray(out, base, base+lenOut-base);\n        base = lenOut;\n        break;\n      }\n\n      // Advance the hash by one character. Keep looking for a match.\n      h.next(out[base+i+NHASH]);\n      i++;\n    }\n  }\n  // Output a final \"insert\" record to get all the text at the end of\n  // the file that does not match anything in the source.\n  if(base < lenOut) {\n    zDelta.putInt(lenOut-base);\n    zDelta.putChar(':');\n    zDelta.putArray(out, base, base+lenOut-base);\n  }\n  // Output the final checksum record.\n  zDelta.putInt(checksum(out));\n  zDelta.putChar(';');\n  return zDelta.toArray();\n};\n\n// Return the size (in bytes) of the output from applying a delta.\nfossilDelta.outputSize = function(delta){\n  var zDelta = new Reader(delta);\n  var size = zDelta.getInt();\n  if (zDelta.getChar() !== '\\n')\n    throw new Error('size integer not terminated by \\'\\\\n\\'');\n  return size;\n};\n\n// Apply a delta.\nfossilDelta.apply = function(src, delta, opts) {\n  var limit, total = 0;\n  var zDelta = new Reader(delta);\n  var lenSrc = src.length;\n  var lenDelta = delta.length;\n\n  limit = zDelta.getInt();\n  if (zDelta.getChar() !== '\\n')\n    throw new Error('size integer not terminated by \\'\\\\n\\'');\n  var zOut = new Writer();\n  while(zDelta.haveBytes()) {\n    var cnt, ofst;\n    cnt = zDelta.getInt();\n\n    switch (zDelta.getChar()) {\n      case '@':\n        ofst = zDelta.getInt();\n        if (zDelta.haveBytes() && zDelta.getChar() !== ',')\n          throw new Error('copy command not terminated by \\',\\'');\n        total += cnt;\n        if (total > limit)\n          throw new Error('copy exceeds output file size');\n        if (ofst+cnt > lenSrc)\n          throw new Error('copy extends past end of input');\n        zOut.putArray(src, ofst, ofst+cnt);\n        break;\n\n      case ':':\n        total += cnt;\n        if (total > limit)\n          throw new Error('insert command gives an output larger than predicted');\n        if (cnt > lenDelta)\n          throw new Error('insert count exceeds size of delta');\n        zOut.putArray(zDelta.a, zDelta.pos, zDelta.pos+cnt);\n        zDelta.pos += cnt;\n        break;\n\n      case ';':\n        var out = zOut.toArray();\n        if ((!opts || opts.verifyChecksum !== false) && cnt !== checksum(out))\n          throw new Error('bad checksum');\n        if (total !== limit)\n          throw new Error('generated size does not match predicted size');\n        return out;\n\n      default:\n        throw new Error('unknown delta operator');\n    }\n  }\n  throw new Error('unterminated delta');\n};\n\nreturn fossilDelta;\n\n});\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SchemaSerializer = void 0;\nvar schema_1 = require(\"@colyseus/schema\");\nvar SchemaSerializer = /** @class */ (function () {\n    function SchemaSerializer() {\n    }\n    SchemaSerializer.prototype.setState = function (rawState) {\n        this.state.decode(rawState);\n    };\n    SchemaSerializer.prototype.getState = function () {\n        return this.state;\n    };\n    SchemaSerializer.prototype.patch = function (patches) {\n        this.state.decode(patches);\n    };\n    SchemaSerializer.prototype.teardown = function () {\n        // this.state.onRemove\n    };\n    SchemaSerializer.prototype.handshake = function (bytes, it) {\n        if (this.state) {\n            // validate client/server definitinos\n            var reflection = new schema_1.Reflection();\n            reflection.decode(bytes, it);\n        }\n        else {\n            // initialize reflected state from server\n            this.state = schema_1.Reflection.decode(bytes);\n        }\n    };\n    return SchemaSerializer;\n}());\nexports.SchemaSerializer = SchemaSerializer;\n","\"use strict\";\n/**\n * Extracted from https://www.npmjs.com/package/strong-events\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EventEmitter = void 0;\nvar EventEmitter = /** @class */ (function () {\n    function EventEmitter() {\n        this.handlers = [];\n    }\n    EventEmitter.prototype.register = function (cb, once) {\n        if (once === void 0) { once = false; }\n        this.handlers.push(cb);\n        return this;\n    };\n    EventEmitter.prototype.invoke = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        this.handlers.forEach(function (handler) { return handler.apply(void 0, args); });\n    };\n    EventEmitter.prototype.invokeAsync = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return Promise.all(this.handlers.map(function (handler) { return handler.apply(void 0, args); }));\n    };\n    EventEmitter.prototype.remove = function (cb) {\n        var index = this.handlers.indexOf(cb);\n        this.handlers[index] = this.handlers[this.handlers.length - 1];\n        this.handlers.pop();\n    };\n    EventEmitter.prototype.clear = function () {\n        this.handlers = [];\n    };\n    return EventEmitter;\n}());\nexports.EventEmitter = EventEmitter;\n//# sourceMappingURL=EventEmitter.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.dumpChanges = void 0;\nvar _1 = require(\"./\");\nvar MapSchema_1 = require(\"./types/MapSchema\");\nvar ArraySchema_1 = require(\"./types/ArraySchema\");\nfunction dumpChanges(schema) {\n    var dump = {};\n    var $changes = schema.$changes;\n    var fieldsByIndex = schema['_fieldsByIndex'] || {};\n    for (var _i = 0, _a = Array.from($changes.changes); _i < _a.length; _i++) {\n        var fieldIndex = _a[_i];\n        var field = fieldsByIndex[fieldIndex] || fieldIndex;\n        if (schema[field] instanceof MapSchema_1.MapSchema ||\n            schema[field] instanceof ArraySchema_1.ArraySchema ||\n            schema[field] instanceof _1.Schema) {\n            dump[field] = dumpChanges(schema[field]);\n        }\n        else {\n            dump[field] = schema[field];\n        }\n    }\n    return dump;\n}\nexports.dumpChanges = dumpChanges;\n//# sourceMappingURL=utils.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Reflection = exports.ReflectionType = exports.ReflectionField = void 0;\nvar annotations_1 = require(\"./annotations\");\nvar Schema_1 = require(\"./Schema\");\nvar ArraySchema_1 = require(\"./types/ArraySchema\");\nvar MapSchema_1 = require(\"./types/MapSchema\");\nvar reflectionContext = new annotations_1.Context();\n/**\n * Reflection\n */\nvar ReflectionField = /** @class */ (function (_super) {\n    __extends(ReflectionField, _super);\n    function ReflectionField() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        annotations_1.type(\"string\", reflectionContext)\n    ], ReflectionField.prototype, \"name\", void 0);\n    __decorate([\n        annotations_1.type(\"string\", reflectionContext)\n    ], ReflectionField.prototype, \"type\", void 0);\n    __decorate([\n        annotations_1.type(\"uint8\", reflectionContext)\n    ], ReflectionField.prototype, \"referencedType\", void 0);\n    return ReflectionField;\n}(Schema_1.Schema));\nexports.ReflectionField = ReflectionField;\nvar ReflectionType = /** @class */ (function (_super) {\n    __extends(ReflectionType, _super);\n    function ReflectionType() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.fields = new ArraySchema_1.ArraySchema();\n        return _this;\n    }\n    __decorate([\n        annotations_1.type(\"uint8\", reflectionContext)\n    ], ReflectionType.prototype, \"id\", void 0);\n    __decorate([\n        annotations_1.type([ReflectionField], reflectionContext)\n    ], ReflectionType.prototype, \"fields\", void 0);\n    return ReflectionType;\n}(Schema_1.Schema));\nexports.ReflectionType = ReflectionType;\nvar Reflection = /** @class */ (function (_super) {\n    __extends(Reflection, _super);\n    function Reflection() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.types = new ArraySchema_1.ArraySchema();\n        return _this;\n    }\n    Reflection.encode = function (instance) {\n        var rootSchemaType = instance.constructor;\n        var reflection = new Reflection();\n        reflection.rootType = rootSchemaType._typeid;\n        var buildType = function (currentType, schema) {\n            for (var fieldName in schema) {\n                var field = new ReflectionField();\n                field.name = fieldName;\n                var fieldType = void 0;\n                if (typeof (schema[fieldName]) === \"string\") {\n                    fieldType = schema[fieldName];\n                }\n                else {\n                    var isSchema = typeof (schema[fieldName]) === \"function\";\n                    var isArray = Array.isArray(schema[fieldName]);\n                    var isMap = !isArray && schema[fieldName].map;\n                    var childTypeSchema = void 0;\n                    if (isSchema) {\n                        fieldType = \"ref\";\n                        childTypeSchema = schema[fieldName];\n                    }\n                    else if (isArray) {\n                        fieldType = \"array\";\n                        if (typeof (schema[fieldName][0]) === \"string\") {\n                            fieldType += \":\" + schema[fieldName][0]; // array:string\n                        }\n                        else {\n                            childTypeSchema = schema[fieldName][0];\n                        }\n                    }\n                    else if (isMap) {\n                        fieldType = \"map\";\n                        if (typeof (schema[fieldName].map) === \"string\") {\n                            fieldType += \":\" + schema[fieldName].map; // array:string\n                        }\n                        else {\n                            childTypeSchema = schema[fieldName].map;\n                        }\n                    }\n                    field.referencedType = (childTypeSchema)\n                        ? childTypeSchema._typeid\n                        : 255;\n                }\n                field.type = fieldType;\n                currentType.fields.push(field);\n            }\n            reflection.types.push(currentType);\n        };\n        var types = rootSchemaType._context.types;\n        for (var typeid in types) {\n            var type_1 = new ReflectionType();\n            type_1.id = Number(typeid);\n            buildType(type_1, types[typeid]._schema);\n        }\n        return reflection.encodeAll();\n    };\n    Reflection.decode = function (bytes) {\n        var context = new annotations_1.Context();\n        var reflection = new Reflection();\n        reflection.decode(bytes);\n        var schemaTypes = reflection.types.reduce(function (types, reflectionType) {\n            types[reflectionType.id] = /** @class */ (function (_super) {\n                __extends(_, _super);\n                function _() {\n                    return _super !== null && _super.apply(this, arguments) || this;\n                }\n                return _;\n            }(Schema_1.Schema));\n            return types;\n        }, {});\n        reflection.types.forEach(function (reflectionType, i) {\n            reflectionType.fields.forEach(function (field) {\n                var schemaType = schemaTypes[reflectionType.id];\n                if (field.referencedType !== undefined) {\n                    var refType = schemaTypes[field.referencedType];\n                    // map or array of primitive type (255)\n                    if (!refType) {\n                        refType = field.type.split(\":\")[1];\n                    }\n                    if (field.type.indexOf(\"array\") === 0) {\n                        annotations_1.type([refType], context)(schemaType.prototype, field.name);\n                    }\n                    else if (field.type.indexOf(\"map\") === 0) {\n                        annotations_1.type({ map: refType }, context)(schemaType.prototype, field.name);\n                    }\n                    else if (field.type === \"ref\") {\n                        annotations_1.type(refType, context)(schemaType.prototype, field.name);\n                    }\n                }\n                else {\n                    annotations_1.type(field.type, context)(schemaType.prototype, field.name);\n                }\n            });\n        });\n        var rootType = schemaTypes[reflection.rootType];\n        var rootInstance = new rootType();\n        /**\n         * auto-initialize referenced types on root type\n         * to allow registering listeners immediatelly on client-side\n         */\n        for (var fieldName in rootType._schema) {\n            var fieldType = rootType._schema[fieldName];\n            if (typeof (fieldType) !== \"string\") {\n                var isSchema = typeof (fieldType) === \"function\";\n                var isArray = Array.isArray(fieldType);\n                var isMap = !isArray && fieldType.map;\n                rootInstance[fieldName] = (isArray)\n                    ? new ArraySchema_1.ArraySchema()\n                    : (isMap)\n                        ? new MapSchema_1.MapSchema()\n                        : (isSchema)\n                            ? new fieldType()\n                            : undefined;\n            }\n        }\n        return rootInstance;\n    };\n    __decorate([\n        annotations_1.type([ReflectionType], reflectionContext)\n    ], Reflection.prototype, \"types\", void 0);\n    __decorate([\n        annotations_1.type(\"uint8\", reflectionContext)\n    ], Reflection.prototype, \"rootType\", void 0);\n    return Reflection;\n}(Schema_1.Schema));\nexports.Reflection = Reflection;\n//# sourceMappingURL=Reflection.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst events_1 = require(\"events\");\nconst protoo_client_1 = require(\"protoo-client\");\nconst uuid_1 = require(\"uuid\");\nconst log = require(\"loglevel\");\nconst stream_1 = require(\"./stream\");\nconst transport_1 = require(\"./transport\");\nclass Client extends events_1.EventEmitter {\n    constructor(config) {\n        super();\n        this.onRequest = (request) => {\n            log.debug('Handle request from server: [method:%s, data:%o]', request.method, request.data);\n        };\n        this.onNotification = (notification) => {\n            const { method, data } = notification;\n            log.info('Handle notification from server: [method:%s, data:%o]', method, data);\n            switch (method) {\n                case 'peer-join': {\n                    const { uid, info } = data;\n                    this.emit('peer-join', uid, info);\n                    break;\n                }\n                case 'peer-leave': {\n                    const { uid } = data;\n                    this.emit('peer-leave', uid);\n                    break;\n                }\n                case 'stream-add': {\n                    const { mid, info, tracks } = data;\n                    if (mid) {\n                        const trackMap = objToStrMap(tracks);\n                        this.knownStreams.set(mid, trackMap);\n                    }\n                    this.emit('stream-add', mid, info);\n                    break;\n                }\n                case 'stream-remove': {\n                    const { mid } = data;\n                    const stream = this.streams[mid];\n                    this.emit('stream-remove', stream);\n                    stream.close();\n                    break;\n                }\n                case 'broadcast': {\n                    const { uid, info } = data;\n                    this.emit('broadcast', uid, info);\n                    break;\n                }\n            }\n        };\n        const uid = config.uid ? config.uid : uuid_1.v4();\n        if (!config || !config.url) {\n            throw new Error('Undefined config or config.url in ion-sdk.');\n        }\n        const url = new URL(config.url);\n        url.searchParams.append('peer', uid);\n        const transport = new protoo_client_1.WebSocketTransport(url.toString(), config.options);\n        log.setLevel(config.loglevel !== undefined ? config.loglevel : log.levels.WARN);\n        this.knownStreams = new Map();\n        this.uid = uid;\n        this.streams = {};\n        this.dispatch = new protoo_client_1.Peer(transport);\n        if (config.rtc)\n            transport_1.default.setRTCConfiguration(config.rtc);\n        stream_1.Stream.setDispatch(this.dispatch);\n        this.dispatch.on('open', () => {\n            log.info('Peer \"open\" event');\n            this.emit('transport-open');\n        });\n        this.dispatch.on('disconnected', () => {\n            log.info('Peer \"disconnected\" event');\n            this.emit('transport-failed');\n        });\n        this.dispatch.on('close', () => {\n            log.info('Peer \"close\" event');\n            this.emit('transport-closed');\n        });\n        this.dispatch.on('request', this.onRequest);\n        this.dispatch.on('notification', this.onNotification);\n    }\n    broadcast(info) {\n        return this.dispatch.request('broadcast', {\n            rid: this.rid,\n            uid: this.uid,\n            info,\n        });\n    }\n    join(rid, info = { name: 'Guest' }) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.rid = rid;\n            try {\n                const data = yield this.dispatch.request('join', {\n                    rid: this.rid,\n                    uid: this.uid,\n                    info,\n                });\n                log.info('join success: result => ' + JSON.stringify(data));\n            }\n            catch (error) {\n                log.error('join reject: error =>' + error);\n            }\n        });\n    }\n    publish(stream) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.rid) {\n                throw new Error('You must join a room before publishing.');\n            }\n            this.local = stream;\n            return yield stream.publish(this.rid);\n        });\n    }\n    subscribe(mid) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.rid) {\n                throw new Error('You must join a room before subscribing.');\n            }\n            const tracks = this.knownStreams.get(mid);\n            if (!tracks) {\n                throw new Error('Subscribe mid is not known.');\n            }\n            const stream = yield stream_1.RemoteStream.getRemoteMedia(this.rid, mid, tracks);\n            this.streams[mid] = stream;\n            return stream;\n        });\n    }\n    leave() {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const data = yield this.dispatch.request('leave', {\n                    rid: this.rid,\n                    uid: this.uid,\n                });\n                if (this.local) {\n                    this.local.unpublish();\n                }\n                Object.values(this.streams).forEach((stream) => stream.unsubscribe());\n                this.knownStreams.clear();\n                log.info('leave success: result => ' + JSON.stringify(data));\n            }\n            catch (error) {\n                log.error('leave reject: error =>' + error);\n            }\n        });\n    }\n    close() {\n        this.dispatch.close();\n    }\n}\nexports.default = Client;\nfunction objToStrMap(obj) {\n    const strMap = new Map();\n    for (const k of Object.keys(obj)) {\n        strMap.set(k, obj[k]);\n    }\n    return strMap;\n}\n","const { version } = require('../package.json');\nconst Peer = require('./Peer');\nconst WebSocketTransport = require('./transports/WebSocketTransport');\n\n/**\n * Expose mediasoup-client version.\n *\n * @type {String}\n */\nexports.version = version;\n\n/**\n * Expose Peer class.\n *\n * @type {Class}\n */\nexports.Peer = Peer;\n\n/**\n * Expose WebSocketTransport class.\n *\n * @type {Class}\n */\nexports.WebSocketTransport = WebSocketTransport;\n","const Logger = require('./Logger');\nconst EnhancedEventEmitter = require('./EnhancedEventEmitter');\nconst Message = require('./Message');\n\nconst logger = new Logger('Peer');\n\nclass Peer extends EnhancedEventEmitter\n{\n\t/**\n\t * @param {protoo.Transport} transport\n\t *\n\t * @emits open\n\t * @emits {currentAttempt: Number} failed\n\t * @emits disconnected\n\t * @emits close\n\t * @emits {request: protoo.Request, accept: Function, reject: Function} request\n\t * @emits {notification: protoo.Notification} notification\n\t */\n\tconstructor(transport)\n\t{\n\t\tsuper(logger);\n\n\t\tlogger.debug('constructor()');\n\n\t\t// Closed flag.\n\t\t// @type {Boolean}\n\t\tthis._closed = false;\n\n\t\t// Transport.\n\t\t// @type {protoo.Transport}\n\t\tthis._transport = transport;\n\n\t\t// Connected flag.\n\t\t// @type {Boolean}\n\t\tthis._connected = false;\n\n\t\t// Custom data object.\n\t\t// @type {Object}\n\t\tthis._data = {};\n\n\t\t// Map of pending sent request objects indexed by request id.\n\t\t// @type {Map<Number, Object>}\n\t\tthis._sents = new Map();\n\n\t\t// Handle transport.\n\t\tthis._handleTransport();\n\t}\n\n\t/**\n\t * Whether the Peer is closed.\n\t *\n\t * @returns {Boolean}\n\t */\n\tget closed()\n\t{\n\t\treturn this._closed;\n\t}\n\n\t/**\n\t * Whether the Peer is connected.\n\t *\n\t * @returns {Boolean}\n\t */\n\tget connected()\n\t{\n\t\treturn this._connected;\n\t}\n\n\t/**\n\t * App custom data.\n\t *\n\t * @returns {Object}\n\t */\n\tget data()\n\t{\n\t\treturn this._data;\n\t}\n\n\t/**\n\t * Invalid setter.\n\t */\n\tset data(data) // eslint-disable-line no-unused-vars\n\t{\n\t\tthrow new Error('cannot override data object');\n\t}\n\n\t/**\n\t * Close this Peer and its Transport.\n\t */\n\tclose()\n\t{\n\t\tif (this._closed)\n\t\t\treturn;\n\n\t\tlogger.debug('close()');\n\n\t\tthis._closed = true;\n\t\tthis._connected = false;\n\n\t\t// Close Transport.\n\t\tthis._transport.close();\n\n\t\t// Close every pending sent.\n\t\tfor (const sent of this._sents.values())\n\t\t{\n\t\t\tsent.close();\n\t\t}\n\n\t\t// Emit 'close' event.\n\t\tthis.safeEmit('close');\n\t}\n\n\t/**\n\t * Send a protoo request to the server-side Room.\n\t *\n\t * @param {String} method\n\t * @param {Object} [data]\n\t *\n\t * @async\n\t * @returns {Object} The response data Object if a success response is received.\n\t */\n\tasync request(method, data = undefined)\n\t{\n\t\tconst request = Message.createRequest(method, data);\n\n\t\tthis._logger.debug('request() [method:%s, id:%s]', method, request.id);\n\n\t\t// This may throw.\n\t\tawait this._transport.send(request);\n\n\t\treturn new Promise((pResolve, pReject) =>\n\t\t{\n\t\t\tconst timeout = 1500 * (15 + (0.1 * this._sents.size));\n\t\t\tconst sent =\n\t\t\t{\n\t\t\t\tid      : request.id,\n\t\t\t\tmethod  : request.method,\n\t\t\t\tresolve : (data2) =>\n\t\t\t\t{\n\t\t\t\t\tif (!this._sents.delete(request.id))\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tclearTimeout(sent.timer);\n\t\t\t\t\tpResolve(data2);\n\t\t\t\t},\n\t\t\t\treject : (error) =>\n\t\t\t\t{\n\t\t\t\t\tif (!this._sents.delete(request.id))\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tclearTimeout(sent.timer);\n\t\t\t\t\tpReject(error);\n\t\t\t\t},\n\t\t\t\ttimer : setTimeout(() =>\n\t\t\t\t{\n\t\t\t\t\tif (!this._sents.delete(request.id))\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tpReject(new Error('request timeout'));\n\t\t\t\t}, timeout),\n\t\t\t\tclose : () =>\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(sent.timer);\n\t\t\t\t\tpReject(new Error('peer closed'));\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Add sent stuff to the map.\n\t\t\tthis._sents.set(request.id, sent);\n\t\t});\n\t}\n\n\t/**\n\t * Send a protoo notification to the server-side Room.\n\t *\n\t * @param {String} method\n\t * @param {Object} [data]\n\t *\n\t * @async\n\t */\n\tasync notify(method, data = undefined)\n\t{\n\t\tconst notification = Message.createNotification(method, data);\n\n\t\tthis._logger.debug('notify() [method:%s]', method);\n\n\t\t// This may throw.\n\t\tawait this._transport.send(notification);\n\t}\n\n\t_handleTransport()\n\t{\n\t\tif (this._transport.closed)\n\t\t{\n\t\t\tthis._closed = true;\n\n\t\t\tsetTimeout(() =>\n\t\t\t{\n\t\t\t\tif (this._closed)\n\t\t\t\t\treturn;\n\n\t\t\t\tthis._connected = false;\n\n\t\t\t\tthis.safeEmit('close');\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._transport.on('open', () =>\n\t\t{\n\t\t\tif (this._closed)\n\t\t\t\treturn;\n\n\t\t\tlogger.debug('emit \"open\"');\n\n\t\t\tthis._connected = true;\n\n\t\t\tthis.safeEmit('open');\n\t\t});\n\n\t\tthis._transport.on('disconnected', () =>\n\t\t{\n\t\t\tif (this._closed)\n\t\t\t\treturn;\n\n\t\t\tlogger.debug('emit \"disconnected\"');\n\n\t\t\tthis._connected = false;\n\n\t\t\tthis.safeEmit('disconnected');\n\t\t});\n\n\t\tthis._transport.on('failed', (currentAttempt) =>\n\t\t{\n\t\t\tif (this._closed)\n\t\t\t\treturn;\n\n\t\t\tlogger.debug('emit \"failed\" [currentAttempt:%s]', currentAttempt);\n\n\t\t\tthis._connected = false;\n\n\t\t\tthis.safeEmit('failed', currentAttempt);\n\t\t});\n\n\t\tthis._transport.on('close', () =>\n\t\t{\n\t\t\tif (this._closed)\n\t\t\t\treturn;\n\n\t\t\tthis._closed = true;\n\n\t\t\tlogger.debug('emit \"close\"');\n\n\t\t\tthis._connected = false;\n\n\t\t\tthis.safeEmit('close');\n\t\t});\n\n\t\tthis._transport.on('message', (message) =>\n\t\t{\n\t\t\tif (message.request)\n\t\t\t\tthis._handleRequest(message);\n\t\t\telse if (message.response)\n\t\t\t\tthis._handleResponse(message);\n\t\t\telse if (message.notification)\n\t\t\t\tthis._handleNotification(message);\n\t\t});\n\t}\n\n\t_handleRequest(request)\n\t{\n\t\ttry\n\t\t{\n\t\t\tthis.emit('request',\n\t\t\t\t// Request.\n\t\t\t\trequest,\n\t\t\t\t// accept() function.\n\t\t\t\t(data) =>\n\t\t\t\t{\n\t\t\t\t\tconst response = Message.createSuccessResponse(request, data);\n\n\t\t\t\t\tthis._transport.send(response)\n\t\t\t\t\t\t.catch(() => {});\n\t\t\t\t},\n\t\t\t\t// reject() function.\n\t\t\t\t(errorCode, errorReason) =>\n\t\t\t\t{\n\t\t\t\t\tif (errorCode instanceof Error)\n\t\t\t\t\t{\n\t\t\t\t\t\terrorCode = 500;\n\t\t\t\t\t\terrorReason = String(errorCode);\n\t\t\t\t\t}\n\t\t\t\t\telse if (typeof errorCode === 'number' && errorReason instanceof Error)\n\t\t\t\t\t{\n\t\t\t\t\t\terrorReason = String(errorReason);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst response =\n\t\t\t\t\t\tMessage.createErrorResponse(request, errorCode, errorReason);\n\n\t\t\t\t\tthis._transport.send(response)\n\t\t\t\t\t\t.catch(() => {});\n\t\t\t\t});\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconst response = Message.createErrorResponse(request, 500, String(error));\n\n\t\t\tthis._transport.send(response)\n\t\t\t\t.catch(() => {});\n\t\t}\n\t}\n\n\t_handleResponse(response)\n\t{\n\t\tconst sent = this._sents.get(response.id);\n\n\t\tif (!sent)\n\t\t{\n\t\t\tlogger.error(\n\t\t\t\t'received response does not match any sent request [id:%s]', response.id);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.ok)\n\t\t{\n\t\t\tsent.resolve(response.data);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst error = new Error(response.errorReason);\n\n\t\t\terror.code = response.errorCode;\n\t\t\tsent.reject(error);\n\t\t}\n\t}\n\n\t_handleNotification(notification)\n\t{\n\t\tthis.safeEmit('notification', notification);\n\t}\n}\n\nmodule.exports = Peer;\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\nfunction log(...args) {\n\t// This hackery is required for IE8/9, where\n\t// the `console.log` function doesn't have 'apply'\n\treturn typeof console === 'object' &&\n\t\tconsole.log &&\n\t\tconsole.log(...args);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* Active `debug` instances.\n\t*/\n\tcreateDebug.instances = [];\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.enabled = createDebug.enabled(namespace);\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = selectColor(namespace);\n\t\tdebug.destroy = destroy;\n\t\tdebug.extend = extend;\n\t\t// Debug.formatArgs = formatArgs;\n\t\t// debug.rawLog = rawLog;\n\n\t\t// env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\tcreateDebug.instances.push(debug);\n\n\t\treturn debug;\n\t}\n\n\tfunction destroy() {\n\t\tconst index = createDebug.instances.indexOf(this);\n\t\tif (index !== -1) {\n\t\t\tcreateDebug.instances.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < createDebug.instances.length; i++) {\n\t\t\tconst instance = createDebug.instances[i];\n\t\t\tinstance.enabled = createDebug.enabled(instance.namespace);\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","/**\n * Generates a random positive integer.\n *\n * @returns {Number}\n */\nexports.generateRandomNumber = function()\n{\n\treturn Math.round(Math.random() * 10000000);\n};\n","const W3CWebSocket = require('websocket').w3cwebsocket;\nconst retry = require('retry');\nconst Logger = require('../Logger');\nconst EnhancedEventEmitter = require('../EnhancedEventEmitter');\nconst Message = require('../Message');\n\nconst WS_SUBPROTOCOL = 'protoo';\nconst DEFAULT_RETRY_OPTIONS =\n{\n\tretries    : 10,\n\tfactor     : 2,\n\tminTimeout : 1 * 1000,\n\tmaxTimeout : 8 * 1000\n};\n\nconst logger = new Logger('WebSocketTransport');\n\nclass WebSocketTransport extends EnhancedEventEmitter\n{\n\t/**\n\t * @param {String} url - WebSocket URL.\n\t * @param {Object} [options] - Options for WebSocket-Node.W3CWebSocket and retry.\n\t */\n\tconstructor(url, options)\n\t{\n\t\tsuper(logger);\n\n\t\tlogger.debug('constructor() [url:%s, options:%o]', url, options);\n\n\t\t// Closed flag.\n\t\t// @type {Boolean}\n\t\tthis._closed = false;\n\n\t\t// WebSocket URL.\n\t\t// @type {String}\n\t\tthis._url = url;\n\n\t\t// Options.\n\t\t// @type {Object}\n\t\tthis._options = options || {};\n\n\t\t// WebSocket instance.\n\t\t// @type {WebSocket}\n\t\tthis._ws = null;\n\n\t\t// Run the WebSocket.\n\t\tthis._runWebSocket();\n\t}\n\n\tget closed()\n\t{\n\t\treturn this._closed;\n\t}\n\n\tclose()\n\t{\n\t\tif (this._closed)\n\t\t\treturn;\n\n\t\tlogger.debug('close()');\n\n\t\t// Don't wait for the WebSocket 'close' event, do it now.\n\t\tthis._closed = true;\n\t\tthis.safeEmit('close');\n\n\t\ttry\n\t\t{\n\t\t\tthis._ws.onopen = null;\n\t\t\tthis._ws.onclose = null;\n\t\t\tthis._ws.onerror = null;\n\t\t\tthis._ws.onmessage = null;\n\t\t\tthis._ws.close();\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tlogger.error('close() | error closing the WebSocket: %o', error);\n\t\t}\n\t}\n\n\tasync send(message)\n\t{\n\t\tif (this._closed)\n\t\t\tthrow new Error('transport closed');\n\n\t\ttry\n\t\t{\n\t\t\tthis._ws.send(JSON.stringify(message));\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tlogger.warn('send() failed:%o', error);\n\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\t_runWebSocket()\n\t{\n\t\tconst operation =\n\t\t\tretry.operation(this._options.retry || DEFAULT_RETRY_OPTIONS);\n\n\t\tlet wasConnected = false;\n\n\t\toperation.attempt((currentAttempt) =>\n\t\t{\n\t\t\tif (this._closed)\n\t\t\t{\n\t\t\t\toperation.stop();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlogger.debug('_runWebSocket() [currentAttempt:%s]', currentAttempt);\n\n\t\t\tthis._ws = new W3CWebSocket(\n\t\t\t\tthis._url,\n\t\t\t\tWS_SUBPROTOCOL,\n\t\t\t\tthis._options.origin,\n\t\t\t\tthis._options.headers,\n\t\t\t\tthis._options.requestOptions,\n\t\t\t\tthis._options.clientConfig);\n\n\t\t\tthis._ws.onopen = () =>\n\t\t\t{\n\t\t\t\tif (this._closed)\n\t\t\t\t\treturn;\n\n\t\t\t\twasConnected = true;\n\n\t\t\t\t// Emit 'open' event.\n\t\t\t\tthis.safeEmit('open');\n\t\t\t};\n\n\t\t\tthis._ws.onclose = (event) =>\n\t\t\t{\n\t\t\t\tif (this._closed)\n\t\t\t\t\treturn;\n\n\t\t\t\tlogger.warn(\n\t\t\t\t\t'WebSocket \"close\" event [wasClean:%s, code:%s, reason:\"%s\"]',\n\t\t\t\t\tevent.wasClean, event.code, event.reason);\n\n\t\t\t\t// Don't retry if code is 4000 (closed by the server).\n\t\t\t\tif (event.code !== 4000)\n\t\t\t\t{\n\t\t\t\t\t// If it was not connected, try again.\n\t\t\t\t\tif (!wasConnected)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.safeEmit('failed', currentAttempt);\n\n\t\t\t\t\t\tif (this._closed)\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tif (operation.retry(true))\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// If it was connected, start from scratch.\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\toperation.stop();\n\n\t\t\t\t\t\tthis.safeEmit('disconnected');\n\n\t\t\t\t\t\tif (this._closed)\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tthis._runWebSocket();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._closed = true;\n\n\t\t\t\t// Emit 'close' event.\n\t\t\t\tthis.safeEmit('close');\n\t\t\t};\n\n\t\t\tthis._ws.onerror = () =>\n\t\t\t{\n\t\t\t\tif (this._closed)\n\t\t\t\t\treturn;\n\n\t\t\t\tlogger.error('WebSocket \"error\" event');\n\t\t\t};\n\n\t\t\tthis._ws.onmessage = (event) =>\n\t\t\t{\n\t\t\t\tif (this._closed)\n\t\t\t\t\treturn;\n\n\t\t\t\tconst message = Message.parse(event.data);\n\n\t\t\t\tif (!message)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (this.listenerCount('message') === 0)\n\t\t\t\t{\n\t\t\t\t\tlogger.error(\n\t\t\t\t\t\t'no listeners for WebSocket \"message\" event, ignoring received message');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Emit 'message' event.\n\t\t\t\tthis.safeEmit('message', message);\n\t\t\t};\n\t\t});\n\t}\n}\n\nmodule.exports = WebSocketTransport;\n","var _globalThis;\ntry {\n\t_globalThis = require('es5-ext/global');\n} catch (error) {\n} finally {\n\tif (!_globalThis && typeof window !== 'undefined') { _globalThis = window; }\n\tif (!_globalThis) { throw new Error('Could not determine global this'); }\n}\n\nvar NativeWebSocket = _globalThis.WebSocket || _globalThis.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new NativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new NativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\nif (NativeWebSocket) {\n\t['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'].forEach(function(prop) {\n\t\tObject.defineProperty(W3CWebSocket, prop, {\n\t\t\tget: function() { return NativeWebSocket[prop]; }\n\t\t});\n\t});\n}\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : NativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n","var naiveFallback = function () {\n\tif (typeof self === \"object\" && self) return self;\n\tif (typeof window === \"object\" && window) return window;\n\tthrow new Error(\"Unable to resolve global `this`\");\n};\n\nmodule.exports = (function () {\n\tif (this) return this;\n\n\t// Unexpected strict mode (may happen if e.g. bundled into ESM module)\n\n\t// Fallback to standard globalThis if available\n\tif (typeof globalThis === \"object\" && globalThis) return globalThis;\n\n\t// Thanks @mathiasbynens -> https://mathiasbynens.be/notes/globalthis\n\t// In all ES5+ engines global object inherits from Object.prototype\n\t// (if you approached one that doesn't please report)\n\ttry {\n\t\tObject.defineProperty(Object.prototype, \"__global__\", {\n\t\t\tget: function () { return this; },\n\t\t\tconfigurable: true\n\t\t});\n\t} catch (error) {\n\t\t// Unfortunate case of updates to Object.prototype being restricted\n\t\t// via preventExtensions, seal or freeze\n\t\treturn naiveFallback();\n\t}\n\ttry {\n\t\t// Safari case (window.__global__ works, but __global__ does not)\n\t\tif (!__global__) return naiveFallback();\n\t\treturn __global__;\n\t} finally {\n\t\tdelete Object.prototype.__global__;\n\t}\n})();\n","module.exports = require('../package.json').version;\n","module.exports = require('./lib/retry');","var RetryOperation = require('./retry_operation');\n\nexports.operation = function(options) {\n  var timeouts = exports.timeouts(options);\n  return new RetryOperation(timeouts, {\n      forever: options && options.forever,\n      unref: options && options.unref,\n      maxRetryTime: options && options.maxRetryTime\n  });\n};\n\nexports.timeouts = function(options) {\n  if (options instanceof Array) {\n    return [].concat(options);\n  }\n\n  var opts = {\n    retries: 10,\n    factor: 2,\n    minTimeout: 1 * 1000,\n    maxTimeout: Infinity,\n    randomize: false\n  };\n  for (var key in options) {\n    opts[key] = options[key];\n  }\n\n  if (opts.minTimeout > opts.maxTimeout) {\n    throw new Error('minTimeout is greater than maxTimeout');\n  }\n\n  var timeouts = [];\n  for (var i = 0; i < opts.retries; i++) {\n    timeouts.push(this.createTimeout(i, opts));\n  }\n\n  if (options && options.forever && !timeouts.length) {\n    timeouts.push(this.createTimeout(i, opts));\n  }\n\n  // sort the array numerically ascending\n  timeouts.sort(function(a,b) {\n    return a - b;\n  });\n\n  return timeouts;\n};\n\nexports.createTimeout = function(attempt, opts) {\n  var random = (opts.randomize)\n    ? (Math.random() + 1)\n    : 1;\n\n  var timeout = Math.round(random * opts.minTimeout * Math.pow(opts.factor, attempt));\n  timeout = Math.min(timeout, opts.maxTimeout);\n\n  return timeout;\n};\n\nexports.wrap = function(obj, options, methods) {\n  if (options instanceof Array) {\n    methods = options;\n    options = null;\n  }\n\n  if (!methods) {\n    methods = [];\n    for (var key in obj) {\n      if (typeof obj[key] === 'function') {\n        methods.push(key);\n      }\n    }\n  }\n\n  for (var i = 0; i < methods.length; i++) {\n    var method   = methods[i];\n    var original = obj[method];\n\n    obj[method] = function retryWrapper(original) {\n      var op       = exports.operation(options);\n      var args     = Array.prototype.slice.call(arguments, 1);\n      var callback = args.pop();\n\n      args.push(function(err) {\n        if (op.retry(err)) {\n          return;\n        }\n        if (err) {\n          arguments[0] = op.mainError();\n        }\n        callback.apply(this, arguments);\n      });\n\n      op.attempt(function() {\n        original.apply(obj, args);\n      });\n    }.bind(obj, original);\n    obj[method].options = options;\n  }\n};\n","function RetryOperation(timeouts, options) {\n  // Compatibility for the old (timeouts, retryForever) signature\n  if (typeof options === 'boolean') {\n    options = { forever: options };\n  }\n\n  this._originalTimeouts = JSON.parse(JSON.stringify(timeouts));\n  this._timeouts = timeouts;\n  this._options = options || {};\n  this._maxRetryTime = options && options.maxRetryTime || Infinity;\n  this._fn = null;\n  this._errors = [];\n  this._attempts = 1;\n  this._operationTimeout = null;\n  this._operationTimeoutCb = null;\n  this._timeout = null;\n  this._operationStart = null;\n\n  if (this._options.forever) {\n    this._cachedTimeouts = this._timeouts.slice(0);\n  }\n}\nmodule.exports = RetryOperation;\n\nRetryOperation.prototype.reset = function() {\n  this._attempts = 1;\n  this._timeouts = this._originalTimeouts;\n}\n\nRetryOperation.prototype.stop = function() {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n\n  this._timeouts       = [];\n  this._cachedTimeouts = null;\n};\n\nRetryOperation.prototype.retry = function(err) {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n\n  if (!err) {\n    return false;\n  }\n  var currentTime = new Date().getTime();\n  if (err && currentTime - this._operationStart >= this._maxRetryTime) {\n    this._errors.unshift(new Error('RetryOperation timeout occurred'));\n    return false;\n  }\n\n  this._errors.push(err);\n\n  var timeout = this._timeouts.shift();\n  if (timeout === undefined) {\n    if (this._cachedTimeouts) {\n      // retry forever, only keep last error\n      this._errors.splice(this._errors.length - 1, this._errors.length);\n      this._timeouts = this._cachedTimeouts.slice(0);\n      timeout = this._timeouts.shift();\n    } else {\n      return false;\n    }\n  }\n\n  var self = this;\n  var timer = setTimeout(function() {\n    self._attempts++;\n\n    if (self._operationTimeoutCb) {\n      self._timeout = setTimeout(function() {\n        self._operationTimeoutCb(self._attempts);\n      }, self._operationTimeout);\n\n      if (self._options.unref) {\n          self._timeout.unref();\n      }\n    }\n\n    self._fn(self._attempts);\n  }, timeout);\n\n  if (this._options.unref) {\n      timer.unref();\n  }\n\n  return true;\n};\n\nRetryOperation.prototype.attempt = function(fn, timeoutOps) {\n  this._fn = fn;\n\n  if (timeoutOps) {\n    if (timeoutOps.timeout) {\n      this._operationTimeout = timeoutOps.timeout;\n    }\n    if (timeoutOps.cb) {\n      this._operationTimeoutCb = timeoutOps.cb;\n    }\n  }\n\n  var self = this;\n  if (this._operationTimeoutCb) {\n    this._timeout = setTimeout(function() {\n      self._operationTimeoutCb();\n    }, self._operationTimeout);\n  }\n\n  this._operationStart = new Date().getTime();\n\n  this._fn(this._attempts);\n};\n\nRetryOperation.prototype.try = function(fn) {\n  console.log('Using RetryOperation.try() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = function(fn) {\n  console.log('Using RetryOperation.start() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = RetryOperation.prototype.try;\n\nRetryOperation.prototype.errors = function() {\n  return this._errors;\n};\n\nRetryOperation.prototype.attempts = function() {\n  return this._attempts;\n};\n\nRetryOperation.prototype.mainError = function() {\n  if (this._errors.length === 0) {\n    return null;\n  }\n\n  var counts = {};\n  var mainError = null;\n  var mainErrorCount = 0;\n\n  for (var i = 0; i < this._errors.length; i++) {\n    var error = this._errors[i];\n    var message = error.message;\n    var count = (counts[message] || 0) + 1;\n\n    counts[message] = count;\n\n    if (count >= mainErrorCount) {\n      mainError = error;\n      mainErrorCount = count;\n    }\n  }\n\n  return mainError;\n};\n","var parser = require('./parser');\nvar writer = require('./writer');\n\nexports.write = writer;\nexports.parse = parser.parse;\nexports.parseParams = parser.parseParams;\nexports.parseFmtpConfig = parser.parseFmtpConfig; // Alias of parseParams().\nexports.parsePayloads = parser.parsePayloads;\nexports.parseRemoteCandidates = parser.parseRemoteCandidates;\nexports.parseImageAttributes = parser.parseImageAttributes;\nexports.parseSimulcastStreamList = parser.parseSimulcastStreamList;\n","var toIntIfInt = function (v) {\n  return String(Number(v)) === v ? Number(v) : v;\n};\n\nvar attachProperties = function (match, location, names, rawName) {\n  if (rawName && !names) {\n    location[rawName] = toIntIfInt(match[1]);\n  }\n  else {\n    for (var i = 0; i < names.length; i += 1) {\n      if (match[i+1] != null) {\n        location[names[i]] = toIntIfInt(match[i+1]);\n      }\n    }\n  }\n};\n\nvar parseReg = function (obj, location, content) {\n  var needsBlank = obj.name && obj.names;\n  if (obj.push && !location[obj.push]) {\n    location[obj.push] = [];\n  }\n  else if (needsBlank && !location[obj.name]) {\n    location[obj.name] = {};\n  }\n  var keyLocation = obj.push ?\n    {} :  // blank object that will be pushed\n    needsBlank ? location[obj.name] : location; // otherwise, named location or root\n\n  attachProperties(content.match(obj.reg), keyLocation, obj.names, obj.name);\n\n  if (obj.push) {\n    location[obj.push].push(keyLocation);\n  }\n};\n\nvar grammar = require('./grammar');\nvar validLine = RegExp.prototype.test.bind(/^([a-z])=(.*)/);\n\nexports.parse = function (sdp) {\n  var session = {}\n    , media = []\n    , location = session; // points at where properties go under (one of the above)\n\n  // parse lines we understand\n  sdp.split(/(\\r\\n|\\r|\\n)/).filter(validLine).forEach(function (l) {\n    var type = l[0];\n    var content = l.slice(2);\n    if (type === 'm') {\n      media.push({rtp: [], fmtp: []});\n      location = media[media.length-1]; // point at latest media line\n    }\n\n    for (var j = 0; j < (grammar[type] || []).length; j += 1) {\n      var obj = grammar[type][j];\n      if (obj.reg.test(content)) {\n        return parseReg(obj, location, content);\n      }\n    }\n  });\n\n  session.media = media; // link it up\n  return session;\n};\n\nvar paramReducer = function (acc, expr) {\n  var s = expr.split(/=(.+)/, 2);\n  if (s.length === 2) {\n    acc[s[0]] = toIntIfInt(s[1]);\n  } else if (s.length === 1 && expr.length > 1) {\n    acc[s[0]] = undefined;\n  }\n  return acc;\n};\n\nexports.parseParams = function (str) {\n  return str.split(/;\\s?/).reduce(paramReducer, {});\n};\n\n// For backward compatibility - alias will be removed in 3.0.0\nexports.parseFmtpConfig = exports.parseParams;\n\nexports.parsePayloads = function (str) {\n  return str.toString().split(' ').map(Number);\n};\n\nexports.parseRemoteCandidates = function (str) {\n  var candidates = [];\n  var parts = str.split(' ').map(toIntIfInt);\n  for (var i = 0; i < parts.length; i += 3) {\n    candidates.push({\n      component: parts[i],\n      ip: parts[i + 1],\n      port: parts[i + 2]\n    });\n  }\n  return candidates;\n};\n\nexports.parseImageAttributes = function (str) {\n  return str.split(' ').map(function (item) {\n    return item.substring(1, item.length-1).split(',').reduce(paramReducer, {});\n  });\n};\n\nexports.parseSimulcastStreamList = function (str) {\n  return str.split(';').map(function (stream) {\n    return stream.split(',').map(function (format) {\n      var scid, paused = false;\n\n      if (format[0] !== '~') {\n        scid = toIntIfInt(format);\n      } else {\n        scid = toIntIfInt(format.substring(1, format.length));\n        paused = true;\n      }\n\n      return {\n        scid: scid,\n        paused: paused\n      };\n    });\n  });\n};\n","var grammar = require('./grammar');\n\n// customized util.format - discards excess arguments and can void middle ones\nvar formatRegExp = /%[sdv%]/g;\nvar format = function (formatStr) {\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  return formatStr.replace(formatRegExp, function (x) {\n    if (i >= len) {\n      return x; // missing argument\n    }\n    var arg = args[i];\n    i += 1;\n    switch (x) {\n    case '%%':\n      return '%';\n    case '%s':\n      return String(arg);\n    case '%d':\n      return Number(arg);\n    case '%v':\n      return '';\n    }\n  });\n  // NB: we discard excess arguments - they are typically undefined from makeLine\n};\n\nvar makeLine = function (type, obj, location) {\n  var str = obj.format instanceof Function ?\n    (obj.format(obj.push ? location : location[obj.name])) :\n    obj.format;\n\n  var args = [type + '=' + str];\n  if (obj.names) {\n    for (var i = 0; i < obj.names.length; i += 1) {\n      var n = obj.names[i];\n      if (obj.name) {\n        args.push(location[obj.name][n]);\n      }\n      else { // for mLine and push attributes\n        args.push(location[obj.names[i]]);\n      }\n    }\n  }\n  else {\n    args.push(location[obj.name]);\n  }\n  return format.apply(null, args);\n};\n\n// RFC specified order\n// TODO: extend this with all the rest\nvar defaultOuterOrder = [\n  'v', 'o', 's', 'i',\n  'u', 'e', 'p', 'c',\n  'b', 't', 'r', 'z', 'a'\n];\nvar defaultInnerOrder = ['i', 'c', 'b', 'a'];\n\n\nmodule.exports = function (session, opts) {\n  opts = opts || {};\n  // ensure certain properties exist\n  if (session.version == null) {\n    session.version = 0; // 'v=0' must be there (only defined version atm)\n  }\n  if (session.name == null) {\n    session.name = ' '; // 's= ' must be there if no meaningful name set\n  }\n  session.media.forEach(function (mLine) {\n    if (mLine.payloads == null) {\n      mLine.payloads = '';\n    }\n  });\n\n  var outerOrder = opts.outerOrder || defaultOuterOrder;\n  var innerOrder = opts.innerOrder || defaultInnerOrder;\n  var sdp = [];\n\n  // loop through outerOrder for matching properties on session\n  outerOrder.forEach(function (type) {\n    grammar[type].forEach(function (obj) {\n      if (obj.name in session && session[obj.name] != null) {\n        sdp.push(makeLine(type, obj, session));\n      }\n      else if (obj.push in session && session[obj.push] != null) {\n        session[obj.push].forEach(function (el) {\n          sdp.push(makeLine(type, obj, el));\n        });\n      }\n    });\n  });\n\n  // then for each media line, follow the innerOrder\n  session.media.forEach(function (mLine) {\n    sdp.push(makeLine('m', grammar.m[0], mLine));\n\n    innerOrder.forEach(function (type) {\n      grammar[type].forEach(function (obj) {\n        if (obj.name in mLine && mLine[obj.name] != null) {\n          sdp.push(makeLine(type, obj, mLine));\n        }\n        else if (obj.push in mLine && mLine[obj.push] != null) {\n          mLine[obj.push].forEach(function (el) {\n            sdp.push(makeLine(type, obj, el));\n          });\n        }\n      });\n    });\n  });\n\n  return sdp.join('\\r\\n') + '\\r\\n';\n};\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction bytesToUuid(buf, offset_) {\n  var offset = offset_ || 0; // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n\n  return (byteToHex[buf[offset + 0]] + byteToHex[buf[offset + 1]] + byteToHex[buf[offset + 2]] + byteToHex[buf[offset + 3]] + '-' + byteToHex[buf[offset + 4]] + byteToHex[buf[offset + 5]] + '-' + byteToHex[buf[offset + 6]] + byteToHex[buf[offset + 7]] + '-' + byteToHex[buf[offset + 8]] + byteToHex[buf[offset + 9]] + '-' + byteToHex[buf[offset + 10]] + byteToHex[buf[offset + 11]] + byteToHex[buf[offset + 12]] + byteToHex[buf[offset + 13]] + byteToHex[buf[offset + 14]] + byteToHex[buf[offset + 15]]).toLowerCase();\n}\n\nexport default bytesToUuid;","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js'; // **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\n\nvar _clockseq; // Previous uuid creation time\n\n\nvar _lastMSecs = 0;\nvar _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details\n\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || new Array(16);\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n\n  if (node == null || clockseq == null) {\n    var seedBytes = options.random || (options.rng || rng)();\n\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];\n    }\n\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n\n\n  var msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)\n\n  var dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression\n\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n\n\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  } // Per 4.2.1.2 Throw error if too many uuids are requested\n\n\n  if (nsecs >= 10000) {\n    throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n\n  msecs += 12219292800000; // `time_low`\n\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff; // `time_mid`\n\n  var tmh = msecs / 0x100000000 * 10000 & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff; // `time_high_and_version`\n\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n\n  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n\n  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`\n\n  b[i++] = clockseq & 0xff; // `node`\n\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf || bytesToUuid(b);\n}\n\nexport default v1;","import bytesToUuid from './bytesToUuid.js';\n\nfunction uuidToBytes(uuid) {\n  // Note: We assume we're being passed a valid uuid string\n  var bytes = [];\n  uuid.replace(/[a-fA-F0-9]{2}/g, function (hex) {\n    bytes.push(parseInt(hex, 16));\n  });\n  return bytes;\n}\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  var bytes = [];\n\n  for (var i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nexport var DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport var URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function (name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = uuidToBytes(namespace);\n    }\n\n    if (!Array.isArray(value)) {\n      throw TypeError('value must be an array of bytes');\n    }\n\n    if (!Array.isArray(namespace) || namespace.length !== 16) {\n      throw TypeError('namespace must be uuid string or an Array of 16 byte values');\n    } // Per 4.3\n\n\n    var bytes = hashfunc(namespace.concat(value));\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (var i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return bytesToUuid(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","/*\n * Browser-compatible JavaScript MD5\n *\n * Modification of JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\nfunction md5(bytes) {\n  if (typeof bytes === 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Uint8Array(msg.length);\n\n    for (var i = 0; i < msg.length; ++i) {\n      bytes[i] = msg.charCodeAt(i);\n    }\n  }\n\n  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));\n}\n/*\n * Convert an array of little-endian words to an array of bytes\n */\n\n\nfunction md5ToHexEncodedArray(input) {\n  var output = [];\n  var length32 = input.length * 32;\n  var hexTab = '0123456789abcdef';\n\n  for (var i = 0; i < length32; i += 8) {\n    var x = input[i >> 5] >>> i % 32 & 0xff;\n    var hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);\n    output.push(hex);\n  }\n\n  return output;\n}\n/**\n * Calculate output length with padding and bit length\n */\n\n\nfunction getOutputLength(inputLength8) {\n  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction wordsToMd5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[getOutputLength(len) - 1] = len;\n  var a = 1732584193;\n  var b = -271733879;\n  var c = -1732584194;\n  var d = 271733878;\n\n  for (var i = 0; i < x.length; i += 16) {\n    var olda = a;\n    var oldb = b;\n    var oldc = c;\n    var oldd = d;\n    a = md5ff(a, b, c, d, x[i], 7, -680876936);\n    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5gg(b, c, d, a, x[i], 20, -373897302);\n    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5hh(d, a, b, c, x[i], 11, -358537222);\n    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5ii(a, b, c, d, x[i], 6, -198630844);\n    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safeAdd(a, olda);\n    b = safeAdd(b, oldb);\n    c = safeAdd(c, oldc);\n    d = safeAdd(d, oldd);\n  }\n\n  return [a, b, c, d];\n}\n/*\n * Convert an array bytes to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction bytesToWords(input) {\n  if (input.length === 0) {\n    return [];\n  }\n\n  var length8 = input.length * 8;\n  var output = new Uint32Array(getOutputLength(length8));\n\n  for (var i = 0; i < length8; i += 8) {\n    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;\n  }\n\n  return output;\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safeAdd(x, y) {\n  var lsw = (x & 0xffff) + (y & 0xffff);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bitRotateLeft(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5cmn(q, a, b, x, s, t) {\n  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n\nfunction md5ff(a, b, c, d, x, s, t) {\n  return md5cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5gg(a, b, c, d, x, s, t) {\n  return md5cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5hh(a, b, c, d, x, s, t) {\n  return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5ii(a, b, c, d, x, s, t) {\n  return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\nexport default md5;","import v35 from './v35.js';\nimport md5 from './md5.js';\nvar v3 = v35('v3', 0x30, md5);\nexport default v3;","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return bytesToUuid(rnds);\n}\n\nexport default v4;","// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  var K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  var H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (var i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  }\n\n  bytes.push(0x80);\n  var l = bytes.length / 4 + 2;\n  var N = Math.ceil(l / 16);\n  var M = new Array(N);\n\n  for (var _i = 0; _i < N; ++_i) {\n    var arr = new Uint32Array(16);\n\n    for (var j = 0; j < 16; ++j) {\n      arr[j] = bytes[_i * 64 + j * 4] << 24 | bytes[_i * 64 + j * 4 + 1] << 16 | bytes[_i * 64 + j * 4 + 2] << 8 | bytes[_i * 64 + j * 4 + 3];\n    }\n\n    M[_i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (var _i2 = 0; _i2 < N; ++_i2) {\n    var W = new Uint32Array(80);\n\n    for (var t = 0; t < 16; ++t) {\n      W[t] = M[_i2][t];\n    }\n\n    for (var _t = 16; _t < 80; ++_t) {\n      W[_t] = ROTL(W[_t - 3] ^ W[_t - 8] ^ W[_t - 14] ^ W[_t - 16], 1);\n    }\n\n    var a = H[0];\n    var b = H[1];\n    var c = H[2];\n    var d = H[3];\n    var e = H[4];\n\n    for (var _t2 = 0; _t2 < 80; ++_t2) {\n      var s = Math.floor(_t2 / 20);\n      var T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[_t2] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nexport default sha1;","import v35 from './v35.js';\nimport sha1 from './sha1.js';\nvar v5 = v35('v5', 0x50, sha1);\nexport default v5;"],"sourceRoot":""}